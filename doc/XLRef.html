<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN">
<html xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns="http://www.w3.org/1999/xhtml" xmlns:x="http://www.texmacs.org/2002/extensions">
  <head>
    <title>The XLR Programming Language</title>
    <meta content="TeXmacs 1.0.7.14" name="generator"></meta>
    <style type="text/css">
      body { text-align: justify } h5 { display: inline; padding-right: 1em }
      h6 { display: inline; padding-right: 1em } table { border-collapse:
      collapse } td { padding: 0.2em; vertical-align: baseline } .subsup {
      display: inline; vertical-align: -0.2em } .subsup td { padding: 0px;
      text-align: left} .fraction { display: inline; vertical-align: -0.8em }
      .fraction td { padding: 0px; text-align: center } .wide { position:
      relative; margin-left: -0.4em } .accent { position: relative;
      margin-left: -0.4em; top: -0.1em } .title-block { width: 100%;
      text-align: center } .title-block p { margin: 0px } .compact-block p {
      margin-top: 0px; margin-bottom: 0px } .left-tab { text-align: left }
      .center-tab { text-align: center } .right-tab { float: right; position:
      relative; top: -1em } 
    </style>
  </head>
  <body>
    <p>
      
    </p>
    <p>
      <table class="title-block">
        <tr>
          <td><p>
            <table class="title-block">
              <tr>
                <td><font size="+3"><b>The XLR Programming
                Language</b></font></td>
              </tr>
            </table>
            <p style="margin-top: 1em; margin-bottom: 1em">
              <div class="compact-block">
                <table class="title-block">
                  <tr>
                    <td><p>
                      <span style="margin-left: 0pt"></span>
                      <table style="display: inline; vertical-align: -0.55em">
                        <tbody><tr>
                          <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-bottom: 0em; padding-top: 0em; width: 100%"><center>
                            <p>
                              <p style="margin-top: 0.5em; margin-bottom: 0.5em">
                                <span style="margin-left: 0pt"></span>
                                <table style="display: inline; vertical-align: -0.55em">
                                  <tbody><tr>
                                    <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-bottom: 0em; padding-top: 0em; width: 100%"><center>
                                      <p>
                                        <class style="font-variant: small-caps">by Christophe de
                                        Dinechin</class>
                                      </p>
                                    </center></td>
                                  </tr></tbody>
                                </table>
                              </p>
                              <p style="margin-top: 0.5em; margin-bottom: 0.5em">
                                <span style="margin-left: 0pt"></span>
                                <table style="display: inline; vertical-align: -0.55em">
                                  <tbody><tr>
                                    <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-bottom: 0em; padding-top: 0em; width: 100%"><center>
                                      <p>
                                        Taodyne SAS, 1300 Route des Cretes,
                                        Sophia Antipolis, France
                                      </p>
                                    </center></td>
                                  </tr></tbody>
                                </table>
                              </p>
                            </p>
                          </center></td>
                        </tr></tbody>
                      </table>
                    </p></td>
                  </tr>
                </table>
              </div>
            </p>
          </p></td>
        </tr>
      </table>
      <span style="margin-left: 0em"></span>
    </p>
    <h2 id="auto-1">1<span style="margin-left: 1em"></span>Introduction</h2>
    <p>
      XLR is a dynamic language based on meta-programming, i.e. programs that
      manipulate programs. It is designed to enable a natural syntax similar
      to imperative languages descending from Algol (e.g. C, Pascal, Ada,
      Modula), while preserving the power and expressiveness of homoiconic
      languages descending from Lisp (i.e. languages where programs are
      data).<strong></strong> But more importantly, XL is designed from the
      ground up to be <em>extensible</em>. XL lets you extend the core
      language to suit your own needs. It should be as easy to add new
      language constructs to XL as it is to add functions or classes in
      existing programming languages.
    </p>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">1</class>. </b>This document describes the
      language XL as it should ultimately be implemented. The available XLR
      implementations are currently incomplete. An attempt will be made to
      indicate in this document features that are not yet available with a
      warning. See also Section <a href="#state-of-implementation">1.5</a>.
    </p>
    <h3 id="auto-2">1.1<span style="margin-left: 1em"></span>Design objectives</h3>
    <p>
      XLR is intended to make it easy to write simple<strong></strong>
      programs, yet impose no upper limit, since you can extend the language
      to suit your own needs. The goal is to make it as easy and robust to
      extend the language with new features or concepts as it is to add new
      functions or classes in more traditional programming languages.
    </p>
    <p>
      This design is in response to the following observation: programmers
      have to deal with exponentially-growing program complexity. The reason
      is that the complexity of programs indirectly follows Moore's law, since
      users want to fully benefit from the capabilities of new hardware
      generations. But our brains do not follow a similar exponential law, so
      we need increasingly sophisticated tools to bridge the gap with higher
      and higher levels of abstraction.
    </p>
    <p>
      Over time, this lead to a never ending succession of <em>programming
      paradigms</em><a id="auto-3"></a>, each one intended to make the next generation
      of hardware accessible to programmers. For example, object-oriented
      programming was primarily fuelled by the demands of graphical user
      interfaces.
    </p>
    <p>
      The unfortunate side effect of this continuous change in programming
      paradigms is that code designed with an old approach quickly becomes
      obsolete as a new programming model emerges. For example, even if C++ is
      nominally compatible with C, the core development model is so
      incompatible that C++ replicates core functionality of C in a completely
      different way (memory allocation, I/Os, containers, sorts, etc).
    </p>
    <p>
      The purpose of XLR is to allow the language to grow naturally over time,
      under programmers' control. XLR
      <a id="auto-4"></a>
      <a id="auto-5"></a>
      actually stands for &ldquo;eXtensible
      <p>
        <font size="-1"><div align="justify">
          <div style="margin-left: 0px">
            <div style="margin-right: 0px">
              <p>
                . In prehistoric versions of XL, the X stood for
                &ldquo;eXperimental&rdquo;
              </p>
            </div>
          </div>
        </div></font>
      </p>
      <span style="margin-left: 0em"></span>
      <a id="footnr-1"></a>
      <sup><a href="#footnote-1">1</a></sup>
      Language and Runtime&rdquo;. The long term vision is a language made
      both more powerful and easier to use thanks to a large number of
      community-developed and field-tested language extensions.
    </p>
    <h3 id="auto-6">1.2<span style="margin-left: 1em"></span>Keeping it simple</h3>
    <p>
      In order to keep programs easy to write and read, the XLR syntax and
      semantics are very simple. As Saint-Exupery once said, perfection is
      achieved, not when there's nothing to add, but when there's nothing left
      to take away.
    </p>
    <p>
      And indeed, the XLR syntax will seem very natural to most programmers,
      except for what it's missing: XLR makes little use of parentheses and
      other punctuation characters. Instead, the syntax is based on
      indentation. There was a conscious design decision to keep only symbols
      that had an active role in the meaning of the program, as opposed to a
      purely syntactic role. XLR programs look a little like pseudo-code,
      except that they can be compiled and run.
    </p>
    <p>
      This simplicity translates into the internal representations of
      programs, which makes meta-programming not just possible, but easy. Any
      XLR program<strong></strong> or data can be represented with just 8 data
      types: integer<a id="auto-7"></a>, real<a id="auto-8"></a>, text<a id="auto-9"></a>, name<a id="auto-10"></a>,
      infix<a id="auto-11"></a>, prefix<a id="auto-12"></a>, postfix<a id="auto-13"></a> and block<a id="auto-14"></a>.
      For example, the internal representation for <tt class="verbatim">3 * sin X</tt>
      is an infix <tt class="verbatim">*</tt> node with two children, the left child of
      <tt class="verbatim">*</tt> being integer <tt class="verbatim">3</tt>, and the right child
      of <tt class="verbatim">*</tt> being a prefix with the name <tt class="verbatim">sin</tt> on
      the left and the name <tt class="verbatim">X</tt> on the right. Therefore, these
      basic types define an <em>abstract syntax tree</em><a id="auto-15"></a> (AST)<a
      id="auto-16"></a>.
    </p>
    <p>
      The data structure representing programs is simple enough to make
      meta-programming practical and easy. Meta-programming is the ability for
      a program to deal with programs. In the case of XLR, meta-programming is
      the key to language extensibility. Instead of wishing you had this or
      that feature in the language, you can simply add it. Better yet, the
      process of extending the language is so simple that you can now consider
      language notations or compilation techniques that are useful only in a
      particular context. In short, with XLR, creating your own
      <em>domain-specific languages</em><a id="auto-17"></a> (DSLs<a id="auto-18"></a>) is just
      part of normal, everyday programming.
    </p>
    <p>
      ASTs are also central to understanding how XLR programs are executed.
      Conceptually, an XLR program is a transformation of ASTs following a
      number of tree rewrite rules. In other words, there is no real
      difference in XLR between meta-programming and normal program execution,
      as both are represented by transformations on ASTs. The entire XLR
      semantics boils down to this: incrementally rewriting abstract syntax
      trees.
    </p>
    <h3 id="auto-19">1.3<span style="margin-left: 1em"></span>Examples</h3>
    <p>
      The key characteristics of XLR outlined above are best illustrated with
      a few short examples, going from simple programming to more advanced
      functional-style programming<a id="auto-20"></a> to simple meta-programming<a id="auto-21"></a>.
    </p>
    <p>
      Figure <a href="#factorial">1</a> illustrates a recursive definition of the
      factorial function:
    </p>
    <table align="center" id="factorial">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
// Declaration of the factorial notation
0! -&gt; 1
N! -&gt; N * (N-1)!</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 1. </b><a id="auto-22"></a>Declaration of the factorial function
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      The code above reads as follows: the notation <tt class="verbatim">0!</tt> is
      transformed into the integer node <tt class="verbatim">1</tt>, and the notation
      <tt class="verbatim">N!</tt>, where N can be anything except <tt class="verbatim">0</tt>, is
      transformed into the expression <tt class="verbatim">N * (N-1)!</tt>. Since that
      expression is itself in the form <tt class="verbatim">N!</tt>, the definition is
      recursive.
    </p>
    <p>
      Figure <a href="#map-reduce-filter">2</a> illustrates operations usually known as
      <em>map</em><a id="auto-23"></a>, <em>reduce</em><a id="auto-24"></a> and
      <em>filter</em><a id="auto-25"></a>. These operations are characteristic of a
      programming paradigm called <em>functional programming</em><a id="auto-26"></a>,
      because they take functions as arguments. The <em>map</em> operation
      applies the same function to a list of elements, and returns a list. The
      <em>reduce</em> operation combines elements in a list using a binary
      function, and returns the accumulated result. The <em>filter</em>
      operation selects elements in a list based on a predicate. In XLR,
      <em>map</em>, <em>reduce</em> and <em>filter</em> operations can all use
      an infix <tt class="verbatim">with</tt> notation with slightly different forms for
      the parameters. Section <a href="#list-operations">4.1.10</a> describes these operations
      in more details.
    </p>
    <table align="center" id="map-reduce-filter">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
// Map: Computing the factorial of the first 10 integers
// The result is 1, 1, 2, 6, 24, 120, 720, 5040, 40320, 362880
(N-&gt;N!) with 0..9

// Reduce: Compute the sum of the first 5 factorials, i.e. 409114
(X,Y -&gt; X+Y) with (N-&gt;N!) with 0..5

// Filter: Displaying the factorials that are multiples of 3
// The result is <tt class="verbatim">6, 24, 120, 720, 5040, 40320, 362880</tt>
(N when N mod 3 = 0) with (N-&gt;N!) with 0..9</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 2. </b><a id="auto-27"></a>Map, reduce and filter
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      Figure <a href="#if-then">3</a> illustrates the XLR <strong></strong>definition of
      the <tt class="verbatim">if</tt>-<tt class="verbatim">then</tt>-<tt class="verbatim">else</tt>
      statement<a id="auto-28"></a>, which will serve as our first introduction to
      meta-programming. Here, we tell the compiler how to transform a
      particular form of the source code (the if-then-else statement). Note
      how this transformation uses the same <tt class="verbatim">-&gt;</tt> notation we
      used to declare a factorial function in Figure <a href="#factorial">1</a>. This <tt
      class="verbatim">-&gt;</tt> operator can be read as &ldquo;transforms into&rdquo;
      and is the most important operation in XL. This shows how, in XLR,
      meta-programming integrates transparently with regular programming.
    </p>
    <table align="center" id="if-then">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
// Declaration of if-then-else
if true then TrueClause else FalseClause   -&gt; TrueClause
if false then TrueClause else FalseClause  -&gt; FalseClause</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 3. </b><a id="auto-29"></a>Declaration of if-then-else
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      The next sections will clarify how these operations work.
    </p>
    <h3 id="auto-30"><a id="concept-programming"></a>1.4<span style="margin-left: 1em"></span>Concept programming</h3>
    <p>
      <a id="auto-31"></a><em>Concept programming</em> is the underlying design
      philosophy behind XLR. The core idea is very simple:
    </p>
    <p>
      <dfn>Programming is the art of transforming ideas (i.e.
      <em>concepts</em> that belong to <em>concept space</em><a id="auto-32"></a>) into
      artefacts such as programs or data structure (i.e. <em>code</em> that
      belongs to <em>code space</em><a id="auto-33"></a>).</dfn>
    </p>
    <p>
      <a id="auto-34"></a><h5>From concept to code: a lossy conversion</h5>Concepts and
      code do not exist in the same context, do not obey the same rules, and
      are generally hard to compare. However, experience shows that it is
      generally a good idea to make the code look and feel as close to the
      concept it represents as possible. Unfortunately, doing so is incredibly
      difficult in practice, in large part because computers and code are
      limiting in their ability to represent arbitrary concepts.
    </p>
    <p>
      We are quite good at building abstractions that bridge the gap, for
      example integer data types and arithmetic that mimic mathematical
      integers and arithmetic. But then we tend to forget these are only
      abstractions, and get caught when they do not behave like the real
      thing, for example when an <tt class="verbatim">int</tt> overflows or wraps
      around, something that real integers never do.
    </p>
    <p>
      The key takeaway is that the conversion of concept to code is
      necessarily <em>lossy</em>. Reducing the loss remains a worthy goal, but
      doing so is difficult. By drawing our attention to the conversion
      process itself, concept programming gives us new and useful tools to
      solve old problems.
    </p>
    <p>
      <a id="auto-35"></a><h5>Pseudo-metrics</h5>Among the tools brought by concept
      programming is a set of <em>pseudo-metrics</em> <a id="auto-36"></a>allowing us
      to better evaluate the code we create. These are called pseudo-metrics
      because they apply to things that in all fairness cannot really be
      measured, like the distance between concepts in our brains and code in
      the computer. At the same time, they are easy to understand and use, and
      allow us to identify and solve problems that are otherwise hard to
      pinpoint.
    </p>
    <p>
      Key pseudo-metrics in concept programming include:
    </p>
    <ol>
      <li>
        <em>Syntactic noise</em><a id="auto-37"></a> is a discrepancy between the
        appearance of the code and the usual or desired notation for the
        associated concept. For example, the usual mathematical operation 1 +
        2 is ideally represented in the code by <tt class="verbatim">1+2</tt>. Notations
        such as <tt class="verbatim">(+ 1 2)</tt> or <tt class="verbatim">add(1,2)</tt>, by
        contrast, introduce a little bit of syntactic noise.
      </li>
      <li>
        <em>Semantic noise</em><a id="auto-38"></a> is a discrepancy between the
        meaning of the code and the usual or desired notation for the
        associated concept. For example, when one needs to consider if
        computing <tt class="verbatim">X+1</tt> possibly overflows, runs out of memory,
        throws an exception or takes an unpredictable amount of time to
        compute, then a little bit of semantic noise appears.
      </li>
      <li>
        <p>
          <em>Bandwidth</em><a id="auto-39"></a> is the fraction of the concept space
          that is covered by a given code. The larger the bandwidth, the more
          general the code is. For example, the mathematical <em>minimum</em>
          concept includes the ability to compare almost anything provided
          there is an order relation (which may be total or partial); it
          applies to functions, to sets, to series, and so on. So it's fair to
          say that the following C function is very narrow band:
        </p>
        <p style="margin-top: 1em; margin-bottom: 1em">
          <div style="margin-left: 35.145870328812px">
            <div style="text-indent: 0em">
              <div class="compact-block">
                <p>
                  <tt class="verbatim"><tt class="verbatim">int min(int x, int y) { return
                  x&lt;y?x:y; }</tt></tt>
                </p>
              </div>
            </div>
          </div>
        </p>
      </li>
      <li>
        The <em>signal-noise ratio</em><a id="auto-40"></a> is the fraction of the code
        that is actually useful to solve the problem from concept space, as
        opposed to code that is there only because of code-space
        considerations. In the same <tt class="verbatim">min</tt> example given above,
        semi-colons or curly braces have little to do with the problem at
        hand: they are noise rather than signal.
      </li>
    </ol>
    <p>
      An amusing observation about this choice of terminology is that just
      like in engineering, noise cannot ever be completely eliminated, though
      many techniques exist to reduce it; and just like in art<a id="auto-41"></a>,
      what is noise<a id="auto-42"></a> to one person may be music<a id="auto-43"></a> to
      another.
    </p>
    <p>
      <a id="auto-44"></a><h5>Influence on XLR</h5>XLR is the first programming
      language designed specifically with concept programming in mind. As a
      result, it is also the first programming language that explicitly
      attempts to optimize the pseudo-metrics listed above.
    </p>
    <h3 id="auto-45"><a id="state-of-implementation"></a>1.5<span style="margin-left: 1em"></span>State of the implementation</h3>
    <p>
      The current implementation of the language is available as an
      open-source program, in particular at <a href="http://xlr.sourceforge.net">http://xlr.sourceforge.net</a>.
      A few details of the implementation are given in Section <a href="#implementation-notes">6</a>.
    </p>
    <p>
      There are currently three wildly different implementations in one
      program:
    </p>
    <ul>
      <li>
        An interpreted mode, corresponding to optimizations level 0, which
        proved so slow that it has not been maintained in a while and is a
        state of serous disrepair.
      </li>
      <li>
        The standard mode, which generates machine code with LLVM and runs
        acceptably fast on simple programs. This implementation is used by <a
        href="http://www.taodyne.com">Tao Presentations</a>, and has consequently been more field
        tested for relatively large real-time interactive applications. It
        has, however, serious limitations with respect to the language.
      </li>
      <li>
        The optimized mode, which generates much better machine code with LLVM
        (practically on a par with optimized C for simple examples) by using
        techniques such as type inference. This optimized mode was supposed to
        take over, and as a result, many language constructs where implemented
        only in that optimized mode (for example, guards). Unfortunately,
        bringing it up to par with the standard mode proved more difficult
        than planned, which means that optimized mode cannot yet support Tao
        Presentations.
      </li>
    </ul>
    <p>
      The net result of this development history is that the same compiler
      supports slightly different features depending on the optimizations
      level. Best effort attempts will be made to indicate which features are
      impacted with Warnings in this document.
    </p>
    <h2 id="auto-46">2<span style="margin-left: 1em"></span><p>
      Syntax
    </p></h2>
    <p>
      XLR source text is encoded using UTF-8. Source code is parsed into a an
      abstract syntax tree<a id="auto-47"></a> format known as <em>XL0</em><a id="auto-48"></a>.
      XL0 trees consist of four literal node types (integer, real, text and
      symbol) and four structured node types (prefix, postfix, infix and
      block). Note that line breaks normally parse as infix operators, and
      that indentation normally parses as blocks.
    </p>
    <p>
      The precedence of operators is given by the <tt class="verbatim">xl.syntax</tt>
      configuration file<a id="auto-49"></a>. It can also be changed dynamically in the
      source code using the <tt class="verbatim">syntax</tt> statements. This is
      detailed in Section <a href="#precedence">2.6</a>. Both methods to define syntax are
      called <em>syntax configuration</em><a id="auto-50"></a>.
    </p>
    <p>
      The rest of this document will occasionally refer to <em>normal
      XLR</em><a id="auto-51"></a> for defaults settings such as the default syntax
      configuration, as shipped with the standard XLR distribution.
    </p>
    <h3 id="auto-52">2.1<span style="margin-left: 1em"></span>Spaces and indentation</h3>
    <p>
      Spaces and tabs are generally not significant, but may be required to
      separate operator or name symbols. For example, there is no difference
      between <tt class="verbatim">A B</tt> (one space) and <tt class="verbatim">A    B</tt> (four
      spaces), but both are different from <tt class="verbatim">AB</tt> (zero space).
    </p>
    <p>
      Spaces and tabs are significant at the beginning of lines. XLR will use
      them to determine the level of indentation from which it derives program
      structures (off-side rule<a id="auto-53"></a>), as illustrated in Figure <a href="#off-side-rule">4</a>.
      Both space<a id="auto-54"></a> or tabs<a id="auto-55"></a> can be used for indentation<a
      id="auto-56"></a>, but cannot be mixed for indentation in a single source file.
      In other words, if the first indented line uses spaces, all other
      indentation must be done using spaces, and similarly for tabs.
    </p>
    <p>
      <table align="center">
        <tbody><tr>
          <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
if A &lt; 3 then
    write &quot;A is too small&quot;
else
    write &quot;A is too big&quot;</pre></td>
        </tr><tr>
          <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
        </tr><tr>
          <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
            <font size="-1"><p>
              <b>Figure 4. </b><a id="auto-57"></a>Off-side rule: Using indentation to
              mark program structure.
            </p></font>
          </p></td>
        </tr></tbody>
      </table>
      
      <a id="off-side-rule"></a>
    </p>
    <h3 id="auto-58">2.2<span style="margin-left: 1em"></span>Comments and spaces</h3>
    <p>
      <em>Comments</em><a id="auto-59"></a> are section of the source text which are
      typically used for documentation purpose and play no role in the
      execution of the program. Comments begin with a comment separator, and
      finish with a comment terminator.
    </p>
    <p>
      Comments in normal XLR are similar to C++ comments: they begin with <tt
      class="verbatim">/*</tt> and finish with <tt class="verbatim">*/</tt>, or they begin with
      <tt class="verbatim">//</tt> and finish at the end of line. This is illustrated in
      Figure <a href="#comments">5</a>.
    </p>
    <table align="center" id="comments">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
// This is a single-line comment
/* This particular comment
   can be placed on multiple lines */</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 5. </b><a id="auto-60"></a>Single-line and multi-line comments
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      While comments play no actual role in the execution of a normal XLR
      program, they are actually recorded as attachments in XL0. It is
      possible for some special code to access or otherwise use these
      comments. For example, a documentation generator can read comments and
      use them to construct documentation automatically.
    </p>
    <h3 id="auto-61"><a id="literals"></a>2.3<span style="margin-left: 1em"></span>Literals</h3>
    <p>
      Four literal node<a id="auto-62"></a> types represent atomic values, i.e. values
      which cannot be decomposed into smaller units from an XLR point of view.
      They are:
    </p>
    <ol>
      <li>
        Integer constants
      </li>
      <li>
        Real constants
      </li>
      <li>
        Text literals
      </li>
      <li>
        Symbols and names
      </li>
    </ol>
    <h4 id="auto-63">2.3.1<span style="margin-left: 1em"></span>Integer constants</h4>
    <p>
      Integer constants
      <a id="auto-64"></a>
      <p>
        <font size="-1"><div align="justify">
          <div style="margin-left: 0px">
            <div style="margin-right: 0px">
              <p>
                . At the moment, XL uses the largest native integer type on
                the machine (generally 64-bit) in its internal
                representations. The scanner detects overflow in integer
                constants.
              </p>
            </div>
          </div>
        </div></font>
      </p>
      <span style="margin-left: 0em"></span>
      <a id="footnr-2"></a>
      <sup><a href="#footnote-2">2</a></sup>
      such as
      <tt class="verbatim">123</tt>
      consist of one or more digits (
      <tt class="verbatim">0123456789</tt>
      ) interpreted as unsigned radix-10 values. Note that
      <tt class="verbatim">-3</tt>
      is not an integer literal but a prefix
      <tt class="verbatim">-</tt>
      preceding the integer literal. The constant is defined by the longest
      possible sequence of digits.
    </p>
    <p>
      Integer constants can be expressed in any radix<a id="auto-65"></a> between 2 and
      36. Such constants begin with a radix-10 integer specifying the radix,
      followed by a hash sign <tt class="verbatim">#</tt><a id="auto-66"></a>, followed by valid
      digits in the given radix. For instance, <tt class="verbatim">2#1001</tt>
      represents the same integer constant as <tt class="verbatim">9</tt>. If the radix
      is larger than 10, letters are used to represent digits following <tt
      class="verbatim">9</tt>. For example, <tt class="verbatim">255</tt> can be represented in
      hexadecimal as <tt class="verbatim">16#FF</tt>.
    </p>
    <p>
      The underscore character<a id="auto-67"></a> <tt class="verbatim">_</tt> can be used to
      separate digits, but do not change the value being represented. For
      example <tt class="verbatim">1_000_000</tt> is a more legible way to write <tt
      class="verbatim">1000000</tt>, and <tt class="verbatim">16#FFFF_FFFF</tt> is the same as <tt
      class="verbatim">16#FFFFFFFF</tt>. Underscore characters can only separate digits,
      i.e. <tt class="verbatim">1__3</tt>, <tt class="verbatim">_3</tt> or <tt class="verbatim">3_</tt> are
      not valid integer constants.
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
12
1_000_000
16#FFFF_FFFF
2#1001_1001_1001_1001</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 6. </b><a id="auto-68"></a>Valid integer constants
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h4 id="auto-69">2.3.2<span style="margin-left: 1em"></span>Real constants</h4>
    <p>
      Real constants such as <tt class="verbatim">3.14</tt> consist of one or more
      digits (<tt class="verbatim">0123456789</tt>), followed by a dot <tt class="verbatim">.</tt><a
      id="auto-70"></a> followed by one or more digits (<tt class="verbatim">0123456789</tt>).
      Note that there must be at least one digit after the dot, i.e. <tt
      class="verbatim">1.</tt> is not a valid real constant, but <tt class="verbatim">1.0</tt> is.
    </p>
    <p>
      Real constants can have a radix<a id="auto-71"></a> and use underscores<a id="auto-72"></a>
      to separate digits like integer constants. For example <tt class="verbatim">2#1.1</tt>
      is the same as <tt class="verbatim">1.5</tt> and <tt class="verbatim">3.141_592_653</tt> is
      an approximation of &pi;.
    </p>
    <p>
      A real constant can have an exponent<a id="auto-73"></a>, which consists of an
      optional hash sign <tt class="verbatim">#</tt>, followed by the character <tt
      class="verbatim">e</tt> or <tt class="verbatim">E</tt>, followed by optional plus <tt class="verbatim">+</tt>
      or minus <tt class="verbatim">-</tt> sign, followed by one or more decimal digits
      <tt class="verbatim">0123456789</tt>. For example, <tt class="verbatim">1.0e-3</tt> is the
      same as <tt class="verbatim">0.001</tt> and <tt class="verbatim">1.0E3</tt> is the same as
      <tt class="verbatim">1000.0</tt>. The exponent value is always given in radix-10,
      and indicates a power of the given radix. For example, <tt class="verbatim">2#1.0e3</tt>
      represents 2<sup>3</sup>, in other words it is the same as <tt class="verbatim">8.0</tt>.
    </p>
    <p>
      The hash sign in the exponent is required for any radix greater than 14,
      since in that case the character <tt class="verbatim">e</tt> or <tt class="verbatim">E</tt>
      is also a valid digit. For instance, <tt class="verbatim">16#1.0E1</tt> is
      approximately the same as <tt class="verbatim">1.05493</tt>, whereas <tt class="verbatim">16#1.0#E1</tt>
      is the same as <tt class="verbatim">16.0</tt>.
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
1.0
3.1415_9265_3589_7932
2#1.0000_0001#e-128</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 7. </b><a id="auto-74"></a>Valid real constants
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h4 id="auto-75">2.3.3<span style="margin-left: 1em"></span>Text literals</h4>
    <p>
      Text<a id="auto-76"></a> is any valid UTF-8<a id="auto-77"></a> sequence of printable or
      space characters surrounded by text delimiters, such as <tt class="verbatim">&quot;Hello
      M&ouml;nd&eacute;&quot;</tt>. Except for line-terminating characters<a
      id="auto-78"></a>, the behaviour when a text sequence contains control
      characters<a id="auto-79"></a> or invalid UTF-8 sequences is unspecified.
      However, implementations are encouraged to preserve the contents of such
      sequences.
    </p>
    <p>
      The base text delimiters<a id="auto-80"></a> are the single quote<a id="auto-81"></a><a
      id="auto-82"></a> <tt class="verbatim">'</tt> and the double quote <tt class="verbatim">&quot;</tt><a
      id="auto-83"></a>. They can be used to enclose any text that doesn't contain a
      line-terminating character. The same delimiter must be used at the
      beginning and at the end of the text. For example, <tt class="verbatim">&quot;Shouldn't
      break&quot;</tt> is a valid text surrounded by double quotes, and <tt
      class="verbatim">'He said &quot;Hi&quot;'</tt> is a valid text surrounded by
      single quotes.
    </p>
    <p>
      In text surrounded by base delimiters, the delimiter can be inserted by
      doubling it. For instance, except for the delimiter, <tt class="verbatim">'Shouldn&rdquo;t
      break'</tt> and <tt class="verbatim">&quot;He said
      &quot;&quot;Hi&quot;&quot;&quot;</tt> are equivalent to the two previous
      examples.
    </p>
    <p>
      Other text delimiters can be specified, which can be used to delimit
      text that may include line breaks. Such text is called <em>long
      text</em><a id="auto-84"></a>. With the default configuration, long text can be
      delimited with <tt class="verbatim">&lt;&lt;</tt> and <tt class="verbatim">&gt;&gt;</tt>.
    </p>
    <p>
      
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
&quot;Hello World&quot;
'O&ugrave; Toto &eacute;labora ce plan &ccedil;i'
&lt;&lt;This text spans
multiple lines&gt;&gt;</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 8. </b><a id="auto-85"></a>Valid text constants
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      When long text contains multiple lines of text, indentation<a id="auto-86"></a>
      is ignored up to the indentation level of the first character in the
      long text. Figure <a href="#long-text-indent">9</a> illustrates how long text indent is
      eliminated from the text being read.
    </p>
    <table align="center" id="long-text-indent">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><table style="display: inline; vertical-align: -1.1em">
          <tbody><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid; border-top: 1px solid"><strong>Source code</strong></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-top: 1px solid"><strong>Resulting text</strong></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"> <pre class="verbatim" xml:space="preserve">
&lt;&lt; Long text can
   contain indentation
 or not,
     it's up to you&gt;&gt;</pre></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"> <pre class="verbatim" xml:space="preserve">
Long text can
contain indentation
or not,
  it's up to you</pre></td>
          </tr></tbody>
        </table><p>
          
        </p></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 9. </b><a id="auto-87"></a>Long text and indentation
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      The text delimiters are not part of the value of text literals<a id="auto-88"></a>.
      Therefore, text delimiters are ignored when comparing texts.
    </p>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">2</class>. </b>The current implementation may
      not treat indentation of long text as indicated above.
    </p>
    <h4 id="auto-89">2.3.4<span style="margin-left: 1em"></span>Name and operator symbols<a id="auto-91"></a></h4>
    <p>
      Names<a id="auto-92"></a> begin with an alphabetic character <tt class="verbatim">A</tt>..<tt
      class="verbatim">Z</tt> or <tt class="verbatim">a</tt>..<tt class="verbatim">z</tt> or any non-ASCII
      UTF-8 character, followed by the longest possible sequence of alphabetic
      characters, digits or underscores. Two consecutive underscore characters
      are not allowed. Thus, <tt class="verbatim">Marylin_Monroe</tt>, <tt class="verbatim">&eacute;lab&ouml;r&agrave;tion</tt>
      or <tt class="verbatim">j1</tt> are valid XLR names, whereas <tt class="verbatim">A-1</tt>,
      <tt class="verbatim">1cm</tt> or <tt class="verbatim">A__2</tt> are not.
    </p>
    <p>
      Operator symbols, or
      <em>operators</em>
      <a id="auto-93"></a>
      , begin with an ASCII punctuation character
      <p>
        <font size="-1"><div align="justify">
          <div style="margin-left: 0px">
            <div style="margin-right: 0px">
              <p>
                . Non-ASCII punctuation characters or digits are considered as
                alphabetic.
              </p>
            </div>
          </div>
        </div></font>
      </p>
      <span style="margin-left: 0em"></span>
      <a id="footnr-3"></a>
      <sup><a href="#footnote-3">3</a></sup>
      which does not act as a special delimiter for text, comments or blocks.
      For example,
      <tt class="verbatim">+</tt>
      or
      <tt class="verbatim">-&gt;</tt>
      are operator symbols. An operator includes more than one punctuation
      character only if it has been declared in the syntax (typically in the
      syntax configuration file). For example, unless the symbol
      <tt class="verbatim">%,</tt>
      (percent character followed by comma character) has been declared in
      the syntax,
      <tt class="verbatim">3%,4%</tt>
      will contain two operator symbols
      <tt class="verbatim">%</tt>
      and
      <strong>,</strong>
      instead of a single
      <tt class="verbatim">%,</tt>
      operator.
    </p>
    <p>
      A special name, the empty name, exists only as a child of empty blocks
      such as <tt class="verbatim">()</tt>.
    </p>
    <p>
      After parsing, operator and name symbols are treated identically. During
      parsing, they are treated identically except in the <em>expression
      versus statement rule</em><a id="auto-94"></a> explained in Section <a href="#expression-vs-statement-section">2.5.4</a>.
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
x
<pre class="verbatim" xml:space="preserve">X12_after_transformation
&alpha;_times_&pi;
+
--&gt;
&lt;&lt;&lt;&gt;&gt;&gt;</pre></pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 10. </b><a id="auto-95"></a>Examples of valid operator and name
            symbols
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h3 id="auto-96">2.4<span style="margin-left: 1em"></span>Structured nodes</h3>
    <p>
      Four structured node types<a id="auto-97"></a> represent combinations of nodes.
      They are:
    </p>
    <ol>
      <li>
        Infix nodes<a id="auto-98"></a>, representing operations such as <tt class="verbatim">A+B</tt>
        or <tt class="verbatim">A and B</tt>, where the operator is between its two
        operands.
      </li>
      <li>
        Prefix nodes<a id="auto-99"></a>, representing operations such as <tt class="verbatim">+3</tt>
        or <tt class="verbatim">sin x</tt>, where the operator is before its operand.
      </li>
      <li>
        Postfix nodes<a id="auto-100"></a>, representing operations such as <tt class="verbatim">3%</tt>
        or <tt class="verbatim">3 cm</tt>, where the operator is after its operand.
      </li>
      <li>
        Blocks<a id="auto-101"></a>, representing grouping such as <tt class="verbatim">(A+B)</tt>
        or <tt class="verbatim">{lathe;rinse;repeat}</tt>, where the operators surround
        their operand.
      </li>
    </ol>
    <p>
      Infix, prefix and postfix nodes have two children nodes<a id="auto-102"></a>.
      Blocks have a single child node.
    </p>
    <h4 id="auto-103">2.4.1<span style="margin-left: 1em"></span>Infix nodes</h4>
    <p>
      An infix node<a id="auto-104"></a> has two children, one on the left, one on the
      right, separated by a name or operator symbol.
    </p>
    <p>
      Infix nodes are used to separate statements with semi-colons <tt class="verbatim">;</tt>
      or line breaks (referred to as <tt class="verbatim">NEWLINE</tt> in the syntax
      configuration).
    </p>
    <h4 id="auto-105">2.4.2<span style="margin-left: 1em"></span>Prefix and postfix nodes</h4>
    <p>
      Prefix<a id="auto-106"></a> and postfix<a id="auto-107"></a> nodes have two children, one on
      the left, one on the right, without any separator between them. The only
      difference between prefix and postfix nodes is in what is considered the
      &ldquo;operation&rdquo; and what is considered the &ldquo;operand'<a id="auto-108"></a>'.
      For a prefix node, the operation is on the left and the operand on the
      right, whereas for a postfix node, the operation is on the right and the
      operand on the left.
    </p>
    <p>
      Prefix nodes are used for functions. The default for a name or operator
      symbol that is not explicitly declared in the <tt class="verbatim">xl.syntax</tt><a
      id="auto-109"></a> file or configured is to be treated as a prefix function, i.e.
      to be given a common function precedence<a id="auto-110"></a> referred to as <tt
      class="verbatim">FUNCTION</tt> in the syntax configuration. For example, <tt
      class="verbatim">sin</tt> in the expression <tt class="verbatim">sin x</tt> is treated as a
      function<a id="auto-111"></a>.
    </p>
    <h4 id="auto-112">2.4.3<span style="margin-left: 1em"></span>Block nodes</h4>
    <p>
      Block<a id="auto-113"></a> nodes have one child bracketed by two delimiters<a id="auto-114"></a>.
    </p>
    <p>
      Normal XLR recognizes the following pairs as block delimiters:
    </p>
    <ul>
      <li>
        Parentheses, as in <tt class="verbatim">(A)</tt>
      </li>
      <li>
        Brackets, as in <tt class="verbatim">[A]</tt>
      </li>
      <li>
        Curly braces, as in <tt class="verbatim">{A}</tt>
      </li>
      <li>
        Indentation, as shown surrounding the <tt class="verbatim">write</tt> statements
        in Figure <a href="#off-side-rule">4</a>. The delimiters for indentation are referred
        to as <tt class="verbatim">INDENT</tt> and <tt class="verbatim">UNINDENT</tt> in the
        syntax configuration.
      </li>
    </ul>
    <h3 id="auto-115">2.5<span style="margin-left: 1em"></span>Parsing rules</h3>
    <p>
      <a id="auto-116"></a>The XLR parser only needs a small number of rules to parse
      any XLR source code into XL0:
    </p>
    <ol>
      <li>
        Precedence<a id="auto-117"></a>
      </li>
      <li>
        Associativity<a id="auto-118"></a>
      </li>
      <li>
        Infix versus prefix versus postfix<a id="auto-119"></a>
      </li>
      <li>
        Expression versus statement<a id="auto-120"></a>
      </li>
    </ol>
    <p>
      These rules are detailed below.
    </p>
    <h4 id="auto-121">2.5.1<span style="margin-left: 1em"></span>Precedence</h4>
    <p>
      <a id="auto-122"></a>Infix, prefix, postfix and block symbols are ranked according
      to their <em>precedence</em>, represented as a non-negative integer. The
      precedence is specified by the syntax configuration, either in the
      syntax configuration file, <tt class="verbatim">xl.syntax</tt><a id="auto-123"></a>, or
      through <tt class="verbatim">syntax</tt> statements<a id="auto-124"></a> in the source code.
      This is detailed in Section <a href="#precedence">2.6</a>.
    </p>
    <p>
      Symbols with higher precedence associate before symbols with lower
      precedence. For instance, if the symbol <tt class="verbatim">*</tt> has infix
      precedence value <tt class="verbatim">300</tt> and symbol <tt class="verbatim">+</tt> has
      infix precedence value <tt class="verbatim">290</tt>, then the expression <tt
      class="verbatim">2+3*5</tt> will parse as an infix <tt class="verbatim">+</tt> whose right
      child is an infix <tt class="verbatim">*</tt>.
    </p>
    <p>
      The same symbol may receive a different precedence as an infix, as a
      prefix and as a postfix operator. For example, if the precedence of <tt
      class="verbatim">-</tt> as an infix is <tt class="verbatim">290</tt> and the precedence of
      <tt class="verbatim">-</tt> as a prefix is <tt class="verbatim">390</tt>, then the
      expression <tt class="verbatim">3 - -5</tt> will parse as an infix <tt class="verbatim">-</tt>
      with a prefix <tt class="verbatim">-</tt> as a right child.
    </p>
    <p>
      The precedence associated to blocks is used to define the precedence of
      the resulting expression. This precedence given to entire expressions is
      used primarily in the <em>expression versus statement</em> rule
      described in Section <a href="#expression-vs-statement-section">2.5.4</a>.
    </p>
    <h4 id="auto-125">2.5.2<span style="margin-left: 1em"></span>Associativity</h4>
    <p>
      <a id="auto-126"></a>Infix operators can associate to their left or to their
      right.
    </p>
    <p>
      The addition operator is traditionally left-associative, meaning that in
      <tt class="verbatim">A+B+C</tt>, <tt class="verbatim">A</tt> and <tt class="verbatim">B</tt> associate
      before <tt class="verbatim">C</tt>. As a result, the outer infix <tt class="verbatim">+</tt>
      node in <tt class="verbatim">A+B+C</tt> has an infix <tt class="verbatim">+</tt> node as its
      left child, with <tt class="verbatim">A</tt> and <tt class="verbatim">B</tt> as children,
      and <tt class="verbatim">C</tt> as its right child.
    </p>
    <p>
      Conversely, the semi-colon in XLR is right-associative, meaning that <tt
      class="verbatim">A;B;C</tt> is an infix node with an infix as the right child and
      <tt class="verbatim">A</tt> as the left child.
    </p>
    <p>
      Operators with left and right associativity cannot have the same
      precedence, as this would lead to ambiguity. To enforce that rule, XLR
      arbitrarily gives an even precedence to left-associative operators, and
      an odd precedence to right-associative operators. For example, the
      precedence of <tt class="verbatim">+</tt> in the default configuration is <tt
      class="verbatim">290</tt> (left-associative), whereas the precedence of <tt class="verbatim">^</tt>
      is <tt class="verbatim">395</tt> (right-associative).
    </p>
    <h4 id="auto-127">2.5.3<span style="margin-left: 1em"></span>Infix versus Prefix versus Postfix</h4>
    <p>
      <a id="auto-128"></a>During parsing<a id="auto-129"></a>, XLR needs to resolve ambiguities<a
      id="auto-130"></a> between infix and prefix symbols. For example, in <tt class="verbatim">-A
      + B</tt>, the minus sign <tt class="verbatim">-</tt> is a prefix, whereas the plus
      sign <tt class="verbatim">+</tt> is an infix. Similarly, in <tt class="verbatim">A and not
      B</tt>, the <tt class="verbatim">and</tt> word is infix, whereas the <tt class="verbatim">not</tt>
      word is prefix. The problem is therefore exactly similar for names and
      operator symbols.
    </p>
    <p>
      XLR resolves this ambiguity as follows
      <p>
        <font size="-1"><div align="justify">
          <div style="margin-left: 0px">
            <div style="margin-right: 0px">
              <p>
                . All the examples given are in normal XL, i.e. based on the
                default <tt class="verbatim">xl.syntax</tt> configuration file.
              </p>
            </div>
          </div>
        </div></font>
      </p>
      <span style="margin-left: 0em"></span>
      <a id="footnr-4"></a>
      <sup><a href="#footnote-4">4</a></sup>
      :
    </p>
    <ul>
      <li>
        The first symbol in a statement or in a block is a prefix: <tt class="verbatim">and</tt>
        in <tt class="verbatim">(and x)</tt> is a prefix.
      </li>
      <li>
        A symbol on the right of an infix symbol is a prefix: <tt class="verbatim">and</tt>
        in <tt class="verbatim">A+and B</tt> is a prefix.
      </li>
      <li>
        Otherwise, if the symbol has an infix precedence but no prefix
        precedence, then it is interpreted as an infix: <tt class="verbatim">and</tt> in
        <tt class="verbatim">A and B</tt> is an infix.
      </li>
      <li>
        If the symbol has both an infix precedence and a prefix precedence,
        and either a space following it, or no space preceding it, then it is
        an infix: the minus sign <tt class="verbatim">-</tt> in <tt class="verbatim">A - B</tt> is
        an infix, but the same character is a prefix in <tt class="verbatim">A -B</tt>.
      </li>
      <li>
        Otherwise, if the symbol has a postfix precedence, then it is a
        postfix: <tt class="verbatim">%</tt> in <tt class="verbatim">3%</tt> is a postfix.
      </li>
      <li>
        Otherwise, the symbol is a prefix: <tt class="verbatim">sin</tt> in <tt class="verbatim">write
        sin x</tt> is a prefix.
      </li>
    </ul>
    <p>
      In the first, second and last case, a symbol may be identified as a
      prefix without being given an explicit precedence. Such symbols are
      called <em>default prefix</em><a id="auto-131"></a>. They receive a particular
      precedence known as <em>function precedence</em><a id="auto-132"></a>, identified
      by <tt class="verbatim">FUNCTION</tt> in the syntax configuration<a id="auto-133"></a>.
    </p>
    <h4 id="auto-134"><a id="expression-vs-statement-section"></a>2.5.4<span style="margin-left: 1em"></span>Expression versus
    statement</h4>
    <p>
      <a id="auto-135"></a>Another ambiguity<a id="auto-136"></a> is related to the way humans
      read text. In <tt class="verbatim">write sin x, sin y</tt>, most humans will read
      this as a <tt class="verbatim">write</tt> instruction taking two arguments. This
      is however not entirely logical: if <tt class="verbatim">write</tt> takes two
      arguments, then why shouldn't <tt class="verbatim">sin</tt> also take two
      arguments? In other words, why should this example parse as <tt class="verbatim">write(sin(x),sin(y))</tt>
      and not as <tt class="verbatim">write(sin(x,sin(y)))</tt>?
    </p>
    <p>
      The reason is that we tend to make a distinction between
      <em>statements</em><a id="auto-137"></a> and <em>expressions</em><a id="auto-138"></a>. This
      is not a distinction that is very relevant to computers, but one that
      exists in most natural languages, which distinguish whole sentences as
      opposed to subject or complement<a id="auto-139"></a>.
    </p>
    <p>
      XLR resolves the ambiguity by implementing a similar distinction. The
      boundary is a particular infix precedence, called <em>statement
      precedence</em><a id="auto-140"></a>, denoted as <tt class="verbatim">STATEMENT</tt> in the
      syntax configuration. Intuitively, infix operators with a lower
      precedence separate statements, whereas infix operators with a higher
      precedence separate expressions. For example, the semi-colon <tt class="verbatim">;</tt>
      or <tt class="verbatim">else</tt> separate statements, whereas <tt class="verbatim">+</tt>
      or <tt class="verbatim">and</tt> separate expressions.
    </p>
    <p>
      More precisely:
    </p>
    <ul>
      <li>
        If a block's precedence is less than statement precedence, its content
        begins as an expression, otherwise it begins as a statement: <tt
        class="verbatim">3</tt> in <tt class="verbatim">(3)</tt> is an expression, <tt class="verbatim">write</tt>
        in <tt class="verbatim">{write}</tt> is a statement.
      </li>
      <li>
        Right after an infix symbol with a precedence lower than statement
        precedence, we are in a statement, otherwise we are in an expression.
        The name <tt class="verbatim">B</tt> in <tt class="verbatim">A+B</tt> is an expression,
        but it is a statement in <tt class="verbatim">A;B</tt>.
      </li>
      <li>
        A similar rule applies after prefix nodes: <tt class="verbatim">{optimize} write
        A,B</tt> gives two arguments to <tt class="verbatim">write</tt>, whereas in <tt
        class="verbatim">(x-&gt;x+1) sin x,y</tt> the <tt class="verbatim">sin</tt> function only
        receives a single argument.
      </li>
      <li>
        A default prefix begins a statement if it's a name, an expression if
        it's a symbol: the name <tt class="verbatim">write</tt> in <tt class="verbatim">write
        X</tt> begins a statement, the symbol <tt class="verbatim">+</tt> in <tt class="verbatim">+3</tt>
        begins an expression.
      </li>
    </ul>
    <p>
      In practice, there is no need to worry too much about these rules, since
      normal XLR ensures that most text parses as one would expect from daily
      use of English or mathematical notations.
    </p>
    <h3 id="auto-141"><a id="precedence"></a>2.6<span style="margin-left: 1em"></span>Syntax configuration</h3>
    <p>
      <a id="auto-142"></a>The default XLR syntax configuration file, named <tt class="verbatim">xl.syntax</tt><a
      id="auto-143"></a>, looks like Figure <a href="#syntax-file">11</a> and specifies the standard
      operators<a id="auto-144"></a><a id="auto-145"></a> and their precedence<a id="auto-146"></a>.
    </p>
    <table align="center" id="syntax-file">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
INFIX
        11      NEWLINE
        21      -&gt; =&gt;
        25      as
        31      else into
        40      loop while until
        50      then require ensure
        61      ;
        75      with
        85      := += -= *= /= ^= |= &amp;=
        100     STATEMENT
        110     is 
        120     written
        130     where
        200     DEFAULT
        211     when
        231     ,
        240     return 
        250     and or xor
        260     in at contains
        271     of to
        280     .. by
        290     = &lt; &gt; &lt;= &gt;= &lt;&gt;
        300     &amp; |
        310     + -
        320     * / mod rem
        381     ^
        500     .
        600     :

PREFIX
        30      data
        40      loop while until
        50      property constraint
        121     case if return yield transform
        350     not in out constant variable const var
        360     ! ~
        370     - + * /
        401     FUNCTION
        410     function procedure to type iterator
        420     ++ --
        430     &amp;

POSTFIX
        400     ! ? % cm inch mm pt px
        420     ++ --

BLOCK
        5       INDENT UNINDENT
        25      '{' '}'
        500     '(' ')' '[' ']'

TEXT
        &quot;&lt;&lt;&quot; &quot;&gt;&gt;&quot;
                
COMMENT
        &quot;//&quot; NEWLINE
        &quot;/*&quot; &quot;*/&quot;

SYNTAX &quot;C&quot;
        extern ;</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 11. </b><a id="auto-147"></a>Default syntax configuration file
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      Syntax information can also be provided in the source code using the <tt
      class="verbatim">syntax</tt> name<a id="auto-148"></a> followed by a block, as illustrated
      in Figure <a href="#source-syntax">12</a>.
    </p>
    <table align="center" id="source-syntax">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
// Declare infix 'weight' operator
syntax (INFIX 350 weight)
Obj weight W -&gt; Obj = W

// Declare postfix 'apples' and 'kg'
syntax
    POSTFIX 390 apples kg
X kg -&gt; X * 1000
N apples -&gt; N * 0.250 kg

// Combine the notations declared above
if 6 apples weight 1.5 kg then
    write &quot;Success!&quot;</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 12. </b><a id="auto-149"></a>Use of the <tt class="verbatim">syntax</tt>
            specification in a source file
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      As a general stylistic rule, it is recommended to use restraint when
      introducing new operators using <tt class="verbatim">syntax</tt> statements<a id="auto-150"></a>,
      as this can easily confuse a reader who is not familiar with the new
      notation. On the other hand, there are cases where good use of new and
      well-chosen operators will render the code much more readable and easy
      to maintain.
    </p>
    <p>
      <a id="auto-151"></a><h5>Format of syntax configuration</h5>Spaces and
      indentation<a id="auto-152"></a> are not significant in a syntax configuration
      file. Lexical elements are identical to those of XLR, as detailed in
      Section <a href="#literals">2.3</a>. The significant elements are integer
      constants, names, symbols and text. Integer constants are interpreted as
      the precedence of names and symbols that follow them. Name and symbols
      can be given either with lexical names and symbols, or with text.
    </p>
    <p>
      A few names are reserved for use as keywords in the syntax configuration
      file:
    </p>
    <ul>
      <li>
        <p>
          <tt class="verbatim">INFIX</tt> begins a section declaring infix symbols and
          precedence. In this section:
        </p>
        <ul>
          <li>
            <tt class="verbatim">NEWLINE</tt> identifies line break characters in the
            source code
          </li>
          <li>
            <tt class="verbatim">STATEMENT</tt> identifies the precedence of
            statements<a id="auto-153"></a>
          </li>
          <li>
            <tt class="verbatim">DEFAULT</tt> identifies the precedence for symbols not
            otherwise given a precedence. This precedence should be unique in
            the syntax configuration, i.e. no other symbol should be given the
            <tt class="verbatim">DEFAULT</tt> precedence.<a id="auto-154"></a>
          </li>
        </ul>
      </li>
      <li>
        <p>
          <tt class="verbatim">PREFIX</tt> begins a section declaring prefix symbols and
          precedence. In this section:
        </p>
        <ul>
          <li>
            <tt class="verbatim">FUNCTION </tt>identifies the precedence for default
            prefix symbols, i.e. symbols identified as prefix that are not
            otherwise given a precedence. This precedence should be unique,
            i.e. no other symbol should be given the <tt class="verbatim">FUNCTION</tt>
            precedence.<a id="auto-155"></a>
          </li>
        </ul>
      </li>
      <li>
        <tt class="verbatim">POSTFIX</tt> begins a section declaring postfix symbols and
        precedence.
      </li>
      <li>
        <p>
          <tt class="verbatim">BLOCK</tt> begins a section declaring block delimiters<a
          id="auto-156"></a> and precedence. In this section:
        </p>
        <ul>
          <li>
            <tt class="verbatim">INDENT</tt> and <tt class="verbatim">UNINDENT</tt> are used to
            mark indentation and unindentation.<a id="auto-157"></a>
          </li>
        </ul>
      </li>
      <li>
        <tt class="verbatim">TEXT</tt> begins a section declaring delimiters for long
        text.<a id="auto-158"></a>
      </li>
      <li>
        <p>
          <tt class="verbatim">COMMENT</tt> begins a section declaring delimiters for
          comments. In this section:
        </p>
        <ul>
          <li>
            <tt class="verbatim">NEWLINE</tt> identifies line breaks
          </li>
        </ul>
      </li>
      <li>
        <tt class="verbatim">SYNTAX</tt> begins a section declaring external syntax
        files<a id="auto-159"></a>. In normal XLR, a file <tt class="verbatim">C.syntax</tt><a id="auto-160"></a>
        is used to define the precedences for any text between <tt class="verbatim">extern</tt>
        and <tt class="verbatim">;</tt> symbols. This is used to import C symbols<a id="auto-161"></a>
        using an approximation of the syntax of the C language, as described
        in Section <a href="#C-library">4.4</a>. The <tt class="verbatim">C.syntax</tt>
        configuration file is shown in Figure <a href="#C-syntax-file">13</a>.
      </li>
    </ul>
    <table align="center" id="C-syntax-file">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
INFIX
        41     ,

PREFIX
        30      extern ...
        400     FUNCTION
        450     short long unsigned signed

POSTFIX
        100     *

BLOCK
        500     '(' ')' '[' ']'

COMMENT
        &quot;//&quot; NEWLINE
        &quot;/*&quot; &quot;*/&quot;</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 13. </b><a id="auto-162"></a>C syntax configuration file
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h2 id="auto-163">3<span style="margin-left: 1em"></span>Language semantics</h2>
    <p>
      <a id="auto-164"></a>The semantics of XLR is based entirely on the rewrite of XL0
      abstract syntax trees. Tree rewrite operations define the execution<a
      id="auto-165"></a> of XLR programs, also called <em>evaluation</em><a id="auto-166"></a>.
    </p>
    <h3 id="auto-167">3.1<span style="margin-left: 1em"></span><p>
      Tree rewrite operators
    </p></h3>
    <p>
      <a id="tree-rewrite-operators"></a><a id="auto-168"></a>There is a very small set of tree rewrite
      operators<a id="auto-169"></a> that are given special meaning in XLR and treated
      specially by the XLR compiler:
    </p>
    <ul>
      <li>
        <p>
          <em>Rewrite declarations</em><a id="auto-170"></a> are used to declare
          operations. They roughly play the role of functions, operator or
          macro declarations in other programming languages. A rewrite
          declaration takes the general form <tt class="verbatim">Pattern-&gt;Implementation</tt><a
          id="auto-171"></a><a id="auto-172"></a> and indicates that any tree matching <tt class="verbatim">Pattern</tt>
          should be rewritten as <tt class="verbatim">Implementation</tt>.
        </p>
        <table align="center">
          <tbody><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
0! -&gt; 1
N! -&gt; N*(N-1)!
3! // Computes 6</pre></td>
          </tr><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
          </tr><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
              <font size="-1"><p>
                <b>Figure 14. </b><a id="auto-173"></a>Example of rewrite declaration
              </p></font>
            </p></td>
          </tr></tbody>
        </table>
      </li>
      <li>
        <p>
          <em>Data declarations</em><a id="auto-174"></a> identify data structures in
          the program. Data structures are nothing more than trees that need
          no further rewrite. A data declaration takes the general form of <tt
          class="verbatim">data Pattern</tt>. Any tree matching <tt class="verbatim">Pattern</tt>
          will not be rewritten further.
        </p>
        <table align="center">
          <tbody><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
data complex(x, y)
complex(3,5) // Will stay as is</pre></td>
          </tr><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
          </tr><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
              <font size="-1"><p>
                <b>Figure 15. </b><a id="auto-175"></a>Example of data declaration
              </p></font>
            </p></td>
          </tr></tbody>
        </table>
      </li>
      <li>
        <p>
          <em>Type declarations<a id="auto-176"></a></em> define the type of variables.
          Type declarations take the general form of an infix colon operator
          <tt class="verbatim">Name:Type</tt>, with the name of the variable on the
          left, and the type of the variable on the right.
        </p>
        <table align="center">
          <tbody><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
data person
    first:text
    last:text
    age:integer
person
    &quot;John&quot;
    &quot;Smith&quot;
    33</pre></td>
          </tr><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
          </tr><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
              <font size="-1"><p>
                <b>Figure 16. </b><a id="auto-177"></a>Example of data declarations
                containing type declarations
              </p></font>
            </p></td>
          </tr></tbody>
        </table>
      </li>
      <li>
        <p>
          <em>Guards</em><a id="auto-178"></a> limit the validity of rewrite or data
          declarations. They use an infix <tt class="verbatim">when</tt> with a boolean
          expression on the right of <tt class="verbatim">when</tt>, i.e. a form like
          <tt class="verbatim">Declaration when Condition</tt>.
        </p>
        <table align="center">
          <tbody><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
syracuse X:integer when X mod 2 = 0 -&gt; X/2
syracuse X:integer                  -&gt; 3*X+1</pre></td>
          </tr><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
          </tr><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
              <font size="-1"><p>
                <b>Figure 17. </b><a id="auto-179"></a>Example of guard to build the
                Syracuse suite
              </p></font>
            </p></td>
          </tr></tbody>
        </table>
      </li>
      <li>
        <p>
          <em>Assignment</em><a id="auto-180"></a> change the value associated to a
          binding<a id="auto-181"></a>. Assignments take the form <tt class="verbatim">Reference
          := Value</tt>, where <tt class="verbatim">Reference</tt> identifies the
          binding to change.
        </p>
        <table align="center">
          <tbody><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em"><tt class="verbatim">Zero := 0</tt></td>
          </tr><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
          </tr><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
              <font size="-1"><p>
                <b>Figure 18. </b><a id="auto-182"></a>Example of assignment
              </p></font>
            </p></td>
          </tr></tbody>
        </table>
      </li>
      <li>
        <p>
          <em>Sequence operators</em><a id="auto-183"></a><a id="auto-184"></a> indicate the order
          in which computations must be performed<a id="auto-185"></a>. XLR has two
          infix sequence operators, the semi-colon <tt class="verbatim">;</tt> and the
          new-line <tt class="verbatim">NEWLINE</tt>.
        </p>
        <table align="center">
          <tbody><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
write &quot;Hello&quot;; writeln &quot; World&quot;
emit_loud_beep</pre></td>
          </tr><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
          </tr><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
              <font size="-1"><p>
                <b>Figure 19. </b><a id="auto-186"></a>Example of sequence
              </p></font>
            </p></td>
          </tr></tbody>
        </table>
      </li>
      <li>
        <p>
          <em>Index operators</em><a id="auto-187"></a> perform particular kinds of tree
          rewrites similar in usage to &ldquo;structures&rdquo; or
          &ldquo;arrays&rdquo; in other programming languages. The notations
          <tt class="verbatim">Reference.Field</tt> and <tt class="verbatim">Reference[Index]</tt>
          are used to refer to individual elements in a data structure. These
          are only convenience notations for specific kinds of tree rewrites,
          see Section <a href="#index-operators">3.1.7</a>.
        </p>
        <table align="center">
          <tbody><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
A[3] := 5
A.ref_count := A.ref_count + 1</pre></td>
          </tr><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
          </tr><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
              <font size="-1"><p>
                <b>Figure 20. </b><a id="auto-188"></a>Examples of index operators
              </p></font>
            </p></td>
          </tr></tbody>
        </table>
      </li>
    </ul>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">3</class>. </b>The current implementation has a
      number of deficiencies with respect to guards, assignment and index
      operators. These are described in the corresponding sections below.
    </p>
    <h4 id="auto-189">3.1.1<span style="margin-left: 1em"></span>Rewrite declarations</h4>
    <p>
      <a id="auto-190"></a><a id="auto-191"></a>The infix <tt class="verbatim">-&gt;</tt> operator declares
      a tree rewrite. Figure <a href="#if-then-else">21</a> repeats the code in Figure <a
      href="#if-then">3</a> illustrating how rewrite declarations can be used to define
      the traditional <tt class="verbatim">if</tt>-<tt class="verbatim">then</tt>-<tt class="verbatim">else</tt>
      statement<a id="auto-192"></a>.
    </p>
    <table align="center" id="if-then-else">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
if true then TrueClause else FalseClause    -&gt; TrueClause
if false then TrueClause else FalseClause   -&gt; FalseClause</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 21. </b><a id="auto-193"></a>Examples of tree rewrites
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      The tree on the left of the <tt class="verbatim">-&gt;</tt> operator is called the
      <em>pattern</em><a id="auto-194"></a>. The tree on the right is called the
      <em>implementation</em> of the pattern. The rewrite declaration
      indicates that a tree that matches the pattern should be rewritten using
      the implementation.
    </p>
    <p>
      The pattern contains <em>constant</em><a id="auto-195"></a> and
      <em>variable</em><a id="auto-196"></a> symbols and names. Constant symbol and
      names<a id="auto-197"></a> form the structure of the pattern, whereas variable
      names form the parts of the pattern which can match other trees. The
      names are called <em>parameters</em><a id="auto-198"></a> and the tree they match
      are called <em>arguments</em><a id="auto-199"></a>.
    </p>
    <p>
      Variables and constants in the pattern are identified as follows:
    </p>
    <ul>
      <li>
        Infix symbols and names are constant, like <tt class="verbatim">+</tt> in <tt
        class="verbatim">A+B</tt>.
      </li>
      <li>
        Block-delimiting symbols and names are constant, like <tt class="verbatim">[</tt>
        and <tt class="verbatim">]</tt> in <tt class="verbatim">[A]</tt>.
      </li>
      <li>
        A name on the left of a prefix is a constant, like <tt class="verbatim">sin</tt>
        in <tt class="verbatim">sin X</tt>.
      </li>
      <li>
        A name on the right of a postfix is a constant, like <tt class="verbatim">cm</tt>
        in <tt class="verbatim">X cm</tt>.
      </li>
      <li>
        A name alone on the left of a rewrite is generally a constant
        <p>
          <font size="-1"><div align="justify">
            <div style="margin-left: 0px">
              <div style="margin-right: 0px">
                <p>
                  . In specific scenarios, e.g. when given as an argument to
                  <tt class="verbatim">map</tt>, <tt class="verbatim">reduce</tt> or <tt class="verbatim">filter</tt>
                  and other &ldquo;functional&rdquo; functions, a rewrite
                  declaration like <tt class="verbatim">X-&gt;0</tt> may be interpreted
                  as an anonymous function with parameter <tt class="verbatim">X</tt>
                  instead of a declaration of <tt class="verbatim">X</tt>. For example,
                  this is the case in <tt class="verbatim">(X-&gt;X+1) with 1,3,5</tt>,
                  which returns <tt class="verbatim">2,4,6</tt>. This specific behavior
                  is the result of a special processing done by these
                  functional functions to their function arguments.
                </p>
              </div>
            </div>
          </div></font>
        </p>
        <span style="margin-left: 0em"></span>
        <a id="footnr-5"></a>
        <sup><a href="#footnote-5">5</a></sup>
        , like
        <tt class="verbatim">X</tt>
        in
        <tt class="verbatim">X-&gt;0</tt>
        .
      </li>
      <li>
        Operators are constant, like <tt class="verbatim">+</tt> in <tt class="verbatim">X and
        +Y</tt>.
      </li>
      <li>
        The left side of a type declaration is variable, the rest is not part
        of the pattern, meaning that in <tt class="verbatim">X:real</tt>, only <tt
        class="verbatim">X</tt> will be considered when matching the pattern, and will
        be treated as a variable.
      </li>
      <li>
        All other names are variable.
      </li>
    </ul>
    <p>
      Figure <a href="#if-then-else-colorized">22</a> highlight in blue italic all variable symbols in
      the declarations of Figure <a href="#if-then-else">21</a>.
    </p>
    <table align="center" id="if-then-else-colorized">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
if <font color="blue"><em>true</em></font> then <font color="blue"><em>TrueClause</em></font> else <font color="blue"><em>FalseClause</em></font>    -&gt; TrueClause
if <em><font color="blue">false</font></em> then <em><font color="blue">TrueClause</font></em> else <em><font
        color="blue">FalseClause</font></em>   -&gt; FalseClause</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 22. </b><a id="auto-200"></a>Constants vs. Variable symbols
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      For example, to match the pattern in Figure <a href="#if-then-else">21</a>, the <tt
      class="verbatim">if</tt>, <tt class="verbatim">then</tt> and <tt class="verbatim">else</tt> words must
      match exactly, but <tt class="verbatim">TrueClause</tt> may match any tree, like
      for example <tt class="verbatim">write &quot;Hello&quot;</tt>. <tt class="verbatim">TrueClause</tt>
      is a parameter, and <tt class="verbatim">write &quot;Hello&quot;</tt> would be the
      matching argument.
    </p>
    <p>
      A rewrite like
      <tt class="verbatim">X-&gt;0</tt>
      binds
      <tt class="verbatim">X</tt>
      to value
      <tt class="verbatim">0</tt>
      , i.e.
      <tt class="verbatim">X</tt>
      is a constant that must match in the tree being evaluated. It is
      however possible to create a rewrite with a variable on the left by
      using a type declaration. For example, the rewrite
      <tt class="verbatim">X:real-&gt;X+1</tt>
      does not declare the variable
      <tt class="verbatim">X</tt>
      , but an
      <em>anonymous function</em>
      <a id="auto-201"></a>
      <p>
        <font size="-1"><div align="justify">
          <div style="margin-left: 0px">
            <div style="margin-right: 0px">
              <p>
                . In functional programming, these are often called <em>lambda
                functions</em><a id="auto-202"></a>.
              </p>
            </div>
          </div>
        </div></font>
      </p>
      <span style="margin-left: 0em"></span>
      <a id="footnr-6"></a>
      <sup><a href="#footnote-6">6</a></sup>
      that increments its input. Such rewrites are somewhat special, in
      particular because they are not visible to their implementation so as to
      avoid infinite recursion if their return type is identical to their
      input type.
    </p>
    <p>
      An expression may use declarations that follow it in the same sequence.
      Declarations are visible to prior elements in the sequence and need not
      be evaluated, as shown in Figure <a href="#out-of-order-declarations">23</a>, which computes <tt
      class="verbatim">4</tt>. More generally, rewrites in a sequence belong to the
      context<a id="auto-203"></a> for the entire sequence (contexts are defined in
      Section <a href="#binding">3.2</a>).<strong></strong>
    </p>
    <table align="center" id="out-of-order-declarations">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
foo 3
foo N -&gt; N + 1</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 23. </b><a id="auto-204"></a>Declarations are visible to the
            entire sequence containing them
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h4 id="auto-205">3.1.2<span style="margin-left: 1em"></span>Data declaration</h4>
    <p>
      <a id="auto-206"></a><a id="auto-207"></a>The <tt class="verbatim">data</tt> prefix declares tree
      structures that need not be rewritten further. For instance, Figure <a
      href="#comma-separated-list-data-declaration">24</a> declares that <tt class="verbatim">1,3,4</tt> should not be evaluated
      further, because it is made of infix <tt class="verbatim">,</tt> trees which are
      declared as <tt class="verbatim">data</tt>.
    </p>
    <table align="center" id="comma-separated-list-data-declaration">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
data a,b</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 24. </b><a id="auto-208"></a>Declaring a comma-separated list
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      The tree following a data declaration is a pattern, with constant and
      variable symbols like for rewrite declarations. Data declarations only
      limit the rewrite of the tree specified by the pattern, but not the
      evaluation of pattern variables<a id="auto-209"></a>. In other words, pattern
      variables are evaluated normally, as specified in Section <a href="#evaluation">3.3</a>.
    </p>
    <p>
      For instance, in Figure
      <a href="#complex-type">25</a>
      , the names
      <tt class="verbatim">x</tt>
      and
      <tt class="verbatim">y</tt>
      are variable, but the name
      <tt class="verbatim">complex</tt>
      is constant because it is a prefix. Using integer addition as defined
      in normal XLR,
      <tt class="verbatim">complex(3+4, 5+6)</tt>
      will evaluate as
      <tt class="verbatim">complex(7,11)</tt>
      but no further
      <p>
        <font size="-1"><div align="justify">
          <div style="margin-left: 0px">
            <div style="margin-right: 0px">
              <p>
                . Evaluation is caused by the need to check the parameter
                types, i.e. verify that <tt class="verbatim">3+4</tt> is actually an <tt
                class="verbatim">integer</tt>.
              </p>
            </div>
          </div>
        </div></font>
      </p>
      <span style="margin-left: 0em"></span>
      <a id="footnr-7"></a>
      <sup><a href="#footnote-7">7</a></sup>
      .
    </p>
    <table align="center" id="complex-type">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><tt class="verbatim">data complex(x:integer,y:integer)</tt></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 25. </b><a id="auto-210"></a>Declaring a <tt class="verbatim">complex</tt>
            data type
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      The declaration in Figure <a href="#complex-type">25</a> can be interpreted as
      declaring a <tt class="verbatim">complex</tt> data type. There is, however, a
      better way to describe data types in XLR, which is detailed in Section
      <a href="#type-definition">3.4.2</a>.
    </p>
    <p>
      The word <tt class="verbatim">self</tt><a id="auto-211"></a> can be used to build data
      forms: <tt class="verbatim">data X</tt> is equivalent to <tt class="verbatim">X-&gt;self</tt>.
    </p>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">4</class>. </b>The <tt class="verbatim">self</tt> keyword
      is not implemented yet.
    </p>
    <h4 id="auto-212">3.1.3<span style="margin-left: 1em"></span>Type declaration</h4>
    <p>
      <a id="auto-213"></a>An <em>type declaration</em><a id="auto-214"></a> is an infix colon <tt
      class="verbatim">:</tt> operator in a rewrite or data pattern with a name on the
      left and a type on the right. It indicates that the named parameter on
      the left has the type indicated on the right. A <em>return type
      declaration</em><a id="auto-215"></a> is an infix <tt class="verbatim">as</tt> in a rewrite
      pattern with a pattern on the left and a type on the right. It specifies
      the value that will be returned by the implementation of the rewrite.
      Section <a href="#types">3.4</a> explains how types are defined.
    </p>
    <p>
      Figure <a href="#type-declaration">26</a> shows examples of type declarations. To match the
      pattern for <tt class="verbatim">polynom</tt>, the arguments corresponding to
      parameters <tt class="verbatim">X</tt> and <tt class="verbatim">Z</tt> must be <tt class="verbatim">real</tt>,
      whereas the argument corresponding to parameter <tt class="verbatim">N</tt> must
      be <tt class="verbatim">integer</tt>. The value returned by <tt class="verbatim">polynom</tt>
      will belong to <tt class="verbatim">real</tt>.
    </p>
    <table align="center" id="type-declaration">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
<pre class="verbatim" xml:space="preserve">polynom X:real, Z:real, N:integer as real -&gt; (X-Z)^N</pre></pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 26. </b><a id="auto-216"></a>Simple type declarations
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      The type declarations filter which rewrites can be selected to evaluate
      a particular tree. This enables
      <em>overloading</em>
      <a id="auto-217"></a>
      , i.e. the ability to have multiple functions or operators with a
      similar structure, but different types for the parameters. Return type
      declarations, on the other hand, plays no role in the selection of
      candidates
      <p>
        <font size="-1"><div align="justify">
          <div style="margin-left: 0px">
            <div style="margin-right: 0px">
              <p>
                . Ada is one of the few programming languages that have
                overloading based on return types.
              </p>
            </div>
          </div>
        </div></font>
      </p>
      <span style="margin-left: 0em"></span>
      <a id="footnr-8"></a>
      <sup><a href="#footnote-8">8</a></sup>
      . If there is a return type declaration and the implementation does not
      actually return the declared return type, a type error expression of the
      form
      <tt class="verbatim">type_error ExpectedType, ActualValue</tt>
      will attempt to correct the problem.
    </p>
    <p>
      A type declaration can also be placed on the left of an assignment, see
      Section <a href="#assignment">3.1.4</a>.<a id="auto-218"></a><a id="auto-219"></a>
    </p>
    <h4 id="auto-220"><a id="assignment"></a>3.1.4<span style="margin-left: 1em"></span>Assignment</h4>
    <p>
      The assignment<a id="auto-221"></a> operator <tt class="verbatim">:=</tt><a id="auto-222"></a> binds
      the reference on its left to the value of the tree on its right. The
      tree on the right is evaluated prior to the assignment<a id="auto-223"></a>.
    </p>
    <p>
      An assignment is valid even if the reference on the left of <tt class="verbatim">:=</tt>
      had not previously been bound. In that case, it creates a new binding<a
      id="auto-224"></a> in the current context. This is shown in Figure <a href="#creating-a-new-binding">27</a>.
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
// Assigns to locally created X
assigns_to_local -&gt; X := 1</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 27. </b><a id="auto-225"></a>Creating a new binding<a id="creating-a-new-binding"></a>
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      On the other hand, if there is an existing binding, the assignment
      replaces the corresponding bound value. This is shown in Figure <a href="#nonlocal-assignment">28</a>:
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
// Assigns to global X defined below
assigns_to_global -&gt; X := 1
X -&gt; 0</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 28. </b><a id="auto-226"></a>Assignment to existing binding<a id="nonlocal-assignment"></a>
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">5</class>. </b>In the current state of the
      standard implementation, assigning to an existing rewrite must respect
      the type and overwrites the value in place. For example, if there is a
      declaration like <tt class="verbatim">X-&gt;0</tt>, you may assign <tt class="verbatim">X:=1</tt>
      and then <tt class="verbatim">X</tt> will be replaced with <tt class="verbatim">1</tt>. But
      you will not be able to assign <tt class="verbatim">X:=&quot;Hello&quot;</tt>.
      Furthermore, it is currently only possible to assign scalar types, i.e.
      integer, real and text values. You cannot assign an arbitrary tree to a
      rewrite.
    </p>
    <p>
      <a id="auto-227"></a><h5>Local variables</h5>If the left side of an assignment is
      a type declaration<a id="auto-228"></a><a id="auto-229"></a>, that assignment creates a new
      binding<a id="auto-230"></a> in the local scope<a id="auto-231"></a><a id="auto-232"></a>, as
      illustrated in Figure <a href="#assign-to-new-local">29</a>. That binding has a return type
      declaration<a id="auto-233"></a><a id="auto-234"></a> associated with it, so that later
      assignments to that same name will only succeed if the type of the
      assigned value matches the previously declared type. This is shown in
      Figure <a href="#assign-to-new-local">29</a>:
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
// Global X
X := 0

// Assign to local X
assigns_new -&gt; X:integer := 1</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 29. </b><a id="auto-235"></a>Assigning to new local variable <a
            id="assign-to-new-local"></a>
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">6</class>. </b>Assigning to a new local may not
      work in the current implementation.
    </p>
    <p>
      <a id="auto-236"></a><h5>Assigning to references</h5>If the left side of an
      assignment is a reference, then the assignment will apply to the
      referred value, as shown in Figure <a href="#assign-to-reference-example">30</a>. This may either
      modify the referred value if a binding already exists, or create a new
      binding in the context being referred to if no binding exists.
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
Data -&gt;
    0 -&gt; 3
    1 -&gt; 2
Data.0 := 4 // replaces 3
Data.2 := 5 // Creates new binding 2-&gt;5 in Data</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 30. </b><a id="auto-237"></a>Assignment to references
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      <a id="assign-to-reference-example"></a>An assignment can also assign to the following special
      references<a id="auto-238"></a> (see Section <a href="#tree-operations">4.1.9</a>):
    </p>
    <ul>
      <li>
        <tt class="verbatim">left X</tt>, <tt class="verbatim">right X</tt> when <tt class="verbatim">X</tt>
        is an infix, prefix or postfix
      </li>
      <li>
        <tt class="verbatim">child X</tt> when <tt class="verbatim">X</tt> is a block
      </li>
      <li>
        <tt class="verbatim">symbol X</tt> when <tt class="verbatim">X</tt> is a name or infix and
        the assigned value is a text
      </li>
      <li>
        <tt class="verbatim">opening X</tt> and <tt class="verbatim">closing X</tt> when <tt
        class="verbatim">X</tt> is a block or text and the assigned value is a text
      </li>
    </ul>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">7</class>. </b>Assignment to references, and in
      particular to portions of a tree, is mostly broken and does not work in
      the current implementation, whether standard or optimized.
    </p>
    <p>
      <a id="auto-239"></a><h5>Assigning to parameters</h5>Assigning to a reference is
      particularly useful for parameters<a id="auto-240"></a>. In some cases, parameters
      may be bound without being evaluated (see Section <a href="#lazy-evaluation">3.3.3</a>).
      This means that the parameter is bound to a reference. In that case,
      assigning to the parameter will assign to the reference, making it
      possible to implement assignment-like operations, as illustrated in
      Figure <a href="#assign-to-parameter">31</a>.
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
A : integer := 5
A+=3

// Effectively assign to A
X+=Y -&gt; X:=X+Y</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 31. </b><a id="auto-241"></a>Assigning to parameter
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      <a id="assign-to-parameter"></a>In that example, the context for evaluating the
      implementation <tt class="verbatim">X:=X+Y</tt> will contain a binding for <tt
      class="verbatim">X</tt> in the form <tt class="verbatim">X-&gt;(A-&gt;5).A</tt>, where <tt
      class="verbatim">(A-&gt;5)</tt> is the original execution context. The expression
      <tt class="verbatim">(A-&gt;5).A</tt> means that we evaluate <tt class="verbatim">A</tt> in
      the context that existed at the point where expression <tt class="verbatim">A+=3</tt>
      was evaluated. Therefore, assigning to <tt class="verbatim">X</tt> will affect the
      existing binding,, resulting in the updated binding <tt class="verbatim">A-&gt;8</tt>
      in the original context.
    </p>
    <p>
      <a id="auto-242"></a><h5>Assignments as expressions</h5>Using an assignment in an
      expression<a id="auto-243"></a><a id="auto-244"></a> is equivalent to using the value bound
      to the variable after the assignment. For instance, <tt class="verbatim">sin(x:=f(0))</tt>
      is equivalent to <tt class="verbatim">x:=f(0)</tt> followed by <tt class="verbatim">sin(x)</tt>.
    </p>
    <h4 id="auto-245">3.1.5<span style="margin-left: 1em"></span>Guards</h4>
    <p>
      <a id="auto-246"></a><a id="auto-247"></a>The infix <tt class="verbatim">when</tt> operator in a
      rewrite or data pattern introduces a <em>guard</em>, i.e. a boolean
      condition that must be true for the pattern to apply.
    </p>
    <p>
      Figure <a href="#guard">32</a> shows an improved definition of the factorial
      function which only applies for non-negative values. This set of
      rewrites is ignored for a negative <tt class="verbatim">integer</tt> value.
    </p>
    <table align="center" id="guard">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
0!            -&gt; 1
N! when N &gt; 0 -&gt; N * (N-1)!</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 32. </b><a id="auto-248"></a>Guard limit the validity of
            operations
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      A form where the guard cannot be evaluated or evaluates to anything but
      the value <tt class="verbatim">true</tt> is not selected. For example, if we try
      to evaluate <tt class="verbatim">'ABC'!</tt> the condition <tt class="verbatim">N&gt;0</tt>
      is equivalent to <tt class="verbatim">'ABC'&gt;0</tt>, which cannot be evaluated
      unless you added specific declarations. Therefore, the rewrite for <tt
      class="verbatim">N!</tt> does not apply.
    </p>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">8</class>. </b>Guards are only implemented in
      optimized mode, which is not fully functional yet.
    </p>
    <h4 id="auto-249">3.1.6<span style="margin-left: 1em"></span>Sequences</h4>
    <p>
      <a id="auto-250"></a>The infix line-break <tt class="verbatim">NEWLINE</tt> and semi-colon
      <tt class="verbatim">;</tt> operators are used to introduce a sequence between
      statements. They ensure that the left node is evaluated entirely before
      the evaluation of the right node begins<a id="auto-251"></a><a id="auto-252"></a>.
    </p>
    <p>
      Figure <a href="#sequence">33</a> for instance guarantees that the code will first
      <tt class="verbatim">write</tt> &quot;A&quot;, then <tt class="verbatim">write
      &quot;B&quot;</tt>, then write the result of the sum <tt class="verbatim">f(100)+f(200)</tt>.
      However, the implementation is entirely free to compute <tt class="verbatim">f(100)</tt>
      and <tt class="verbatim">f(200)</tt> in any order, including in parallel.
    </p>
    <table align="center" id="sequence">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
write &quot;A&quot;; write &quot;B&quot;
write f(100)+f(200)</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 33. </b><a id="auto-253"></a>Code writing <tt class="verbatim">A</tt>, then
            <tt class="verbatim">B</tt>, then <tt class="verbatim">f(100)+f(200)</tt>
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      Items in a sequence can be
      <em>declarations</em>
      <a id="auto-254"></a>
      or
      <em>statements</em>
      <a id="auto-255"></a>
      . Declarations include rewrite declarations and data declarations
      <p>
        <font size="-1"><div align="justify">
          <div style="margin-left: 0px">
            <div style="margin-right: 0px">
              <p>
                . Type declarations are only allowed in patterns, not in
                sequences.
              </p>
            </div>
          </div>
        </div></font>
      </p>
      <span style="margin-left: 0em"></span>
      <a id="footnr-9"></a>
      <sup><a href="#footnote-9">9</a></sup>
      . All other items in a sequence are statements.
    </p>
    <h4 id="auto-256"><a id="index-operators"></a>3.1.7<span style="margin-left: 1em"></span>Index operators</h4>
    <p>
      <a id="auto-257"></a>The notation <tt class="verbatim">A[B]</tt> and <tt class="verbatim">A.B</tt><a
      id="auto-258"></a> are used as index operators, i.e. to refer to individual items
      in a collection. The <tt class="verbatim">A[B]</tt> notation is intended to
      represent array<a id="auto-259"></a> indexing<a id="auto-260"></a><a id="auto-261"></a> operations,
      whereas the <tt class="verbatim">A.B</tt> notation is intended to represent field
      indexing operations<a id="auto-262"></a><a id="auto-263"></a>.
    </p>
    <p>
      For example, consider the declarations in Figure <a href="#structured-data">34</a>.
    </p>
    <table align="center" id="structured-data">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
MyData -&gt;
    Name  -&gt; &quot;Name of my data&quot;
    Value -&gt; 3.45
    1 -&gt; &quot;First&quot;
    2 -&gt; &quot;Second&quot;
    3 -&gt; &quot;Third&quot;</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 34. </b><a id="auto-264"></a>Structured data
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      In that case, the expression <tt class="verbatim">MyData.Name</tt> results in the
      value <tt class="verbatim">&quot;Name of my data&quot;</tt>. The expression <tt
      class="verbatim">MyData[1]</tt> results in the value <tt class="verbatim">&quot;First&quot;</tt>.
    </p>
    <p>
      The two index operators differ when their right operand is a name. The
      notation <tt class="verbatim">A.B</tt> evaluates <tt class="verbatim">B</tt> in the context
      of <tt class="verbatim">A</tt>, whereas <tt class="verbatim">A[B]</tt> first evaluates <tt
      class="verbatim">B</tt> in the current context, and then applies <tt class="verbatim">A</tt>
      to it (it is actually nothing more than a regular tree rewrite).
      Therefore, the notation <tt class="verbatim">MyData.Value</tt> returns the value
      <tt class="verbatim">3.45</tt>, whereas the value of <tt class="verbatim">MyData[Value]</tt>
      will evaluate <tt class="verbatim">Value</tt> in the current context, and then
      apply <tt class="verbatim">MyData</tt> to the result. For example, if we had <tt
      class="verbatim">Value-&gt;3</tt> in the current context, then <tt class="verbatim">MyData[Value]</tt>
      would evaluate to <tt class="verbatim">&quot;Third&quot;</tt>.
    </p>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">9</class>. </b>Index operators are only
      partially implemented. They work for simple examples, but may fail for
      more complex use cases. In particular, it is not currently possible to
      update a context by writing to an indexed value.
    </p>
    <p>
      <a id="auto-265"></a><h5>Comparison with C</h5>Users familiar with languages such
      as C may be somewhat disconcerted by XLR's index operators. The
      following points are critical for properly understanding them:
    </p>
    <ul>
      <li>
        <a id="auto-266"></a>Arrays, structures and functions are all represented the
        same way. The entity called <tt class="verbatim">MyData</tt> can be interpreted
        as an array in <tt class="verbatim">MyData[3]</tt>, as a structure in <tt class="verbatim">MyData.Name</tt>,
        or as a function if one writes <tt class="verbatim">MyData 3</tt>. In reality,
        there is no difference between <tt class="verbatim">MyData[3]</tt> and <tt
        class="verbatim">MyData 3</tt>: the former simply passes a block as an argument,
        i.e. it is exactly equivalent to <tt class="verbatim">MyData(3)</tt>, <tt class="verbatim">MyData{3}</tt>.
        Writing <tt class="verbatim">MyData[3]</tt> is only a way to document an intent
        to use <tt class="verbatim">MyData</tt> as an array, but does not change the
        implementation.
      </li>
      <li>
        Data structures can be extended on the fly. For example, it is
        permitted to assign something to a non-existent binding in <tt class="verbatim">MyData</tt>,
        e.g. by writing <tt class="verbatim">MyData[4]:=3</tt>. The ability to add
        &ldquo;fields&rdquo; to a data structure on the fly makes it easier to
        extend existing code.
      </li>
      <li>
        Data structures can include other kinds of rewrites, for example
        &ldquo;functions&rdquo;, enabling object-oriented data structures.
        This is demonstrated in Section <a href="#object-oriented-programming">5.6</a>.
      </li>
      <li>
        Since the notation <tt class="verbatim">A.B</tt> simply evaluates <tt class="verbatim">B</tt>
        in the context of <tt class="verbatim">A</tt>, the value of <tt class="verbatim">MyData.4</tt>
        is... <tt class="verbatim">4</tt>: there is no rewrite for <tt class="verbatim">4</tt> in
        <tt class="verbatim">MyData</tt>, therefore it evaluates a itself.
      </li>
    </ul>
    <h4 id="auto-267">3.1.8<span style="margin-left: 1em"></span>C interface</h4>
    <p>
      A <em>C interface</em><a id="auto-268"></a> is is a rewrite where the
      implementation is a prefix of two names, the first one being <tt class="verbatim">C</tt>
      and the second one being the name of a C function. A C interface can
      also be specified using a special <tt class="verbatim">extern</tt> syntax<a id="auto-269"></a>.
      The name of the C function can also be specified as text if it does not
      obey XLR naming rules, e.g. to interface to a function named <tt class="verbatim">_foobar_</tt>.
    </p>
    <p>
      Figure <a href="#C-interface">35</a> shows two ways of making the <tt class="verbatim">sin</tt>
      function of the C standard library available to an XLR program. The
      first one uses an XLR-style rewrite, whereas the second one uses a
      C-style syntax:
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
sin X:real as real -&gt; C sin
extern double sin(double);</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 35. </b><a id="auto-270"></a>Creating an interface for a C
            function
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      <a id="C-interface"></a>The C-like syntax used for <tt class="verbatim">extern</tt> declaration
      is defined by the file <tt class="verbatim">C.syntax</tt><a id="auto-271"></a>, and applies
      for anything between delimiters <tt class="verbatim">extern</tt> and <tt class="verbatim">;</tt>
      as indicated in the <tt class="verbatim">xl.syntax</tt> file<a id="auto-272"></a><a id="auto-273"></a>.
      While extremely simplistic relative to the real C syntax, it is
      sufficient to import most functions.
    </p>
    <p>
      Table <a href="#C-types-conversion">1</a> shows which types can be used in a C interface and
      what C type they map to:
    </p>
    <table align="center" id="C-types-conversion">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><table style="display: inline; vertical-align: -6.05em">
          <tbody><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid; border-top: 1px solid"><strong>XLR type</strong></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-top: 1px solid"><strong>C type</strong></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">integer</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"><tt class="verbatim">int</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">real</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"><tt class="verbatim">double</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">text</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"><tt class="verbatim">const char *</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">tree</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"><tt class="verbatim">Tree *</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">infix</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"><tt class="verbatim">Infix *</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">prefix</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"><tt class="verbatim">Prefix *</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">postfix</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"><tt class="verbatim">Postfix *</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">block</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"><tt class="verbatim">Block *</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">name</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"><tt class="verbatim">Name *</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">boolean</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"><tt class="verbatim">bool</tt></td>
          </tr></tbody>
        </table></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Table 1. </b><a id="auto-274"></a>Type correspondances in a C interface
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">10</class>. </b>The C interface syntax is only
      available in optimized mode.
    </p>
    <h4 id="auto-275">3.1.9<span style="margin-left: 1em"></span>Machine Interface</h4>
    <p>
      A <em>machine interface</em><a id="auto-276"></a> is a rewrite where the
      implementation is a prefix of two names, the first one being <tt class="verbatim">opcode</tt><a
      id="auto-277"></a>. Figure <a href="#opcode-declaration">36</a> shows how a specific tree rewrite can
      be connected to the generation of machine-level opcodes:
    </p>
    <table align="center" id="opcode-declaration">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><tt class="verbatim">X:integer+Y:integer as integer -&gt; opcode
        Add</tt></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 36. </b><a id="auto-278"></a>Generating machine code using opcode
            declarations
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      Machine-level opcodes are provided by the LLVM library (<a href="http://llvm.org">http://llvm.org</a>).
      Opcodes available to XLR programs are described in Section <a href="#machine-interface">6.14</a>.
    </p>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">11</class>. </b>The machine-level interface is
      only available in optimized mode.
    </p>
    <h3 id="auto-279"><a id="binding"></a>3.2<span style="margin-left: 1em"></span>Binding References to
    Values</h3>
    <p>
      A <em>rewrite declaration</em> of the form <tt class="verbatim">Pattern-&gt;Implementation</tt>
      is said to <em>bind</em><a id="auto-280"></a> its pattern to its implementation. A
      sequence of rewrite declarations is called a <em>context</em><a id="auto-281"></a>.
      For example, the block <tt class="verbatim">{x-&gt;3;y-&gt;4}</tt> is a context
      that binds <tt class="verbatim">x</tt> to <tt class="verbatim">3</tt> and <tt class="verbatim">y</tt>
      to <tt class="verbatim">4</tt>.
    </p>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">12</class>. </b>The idea of defining the
      context and making it available to programs was only elaborated after
      the standard and optimized mode were implemented. It is not currently
      working, but should be implemented in a future release. However, many
      notions described in this section apply internally to the existing
      implementations, i.e. the context order is substantially similar even if
      it is not made visible to programs in the way being described here.
    </p>
    <h4 id="auto-282">3.2.1<span style="margin-left: 1em"></span>Context Order</h4>
    <p>
      <a id="auto-283"></a>A context may contain multiple rewrites that hide one
      another.
    </p>
    <p>
      For example, in the context <tt class="verbatim">{x-&gt;0;x-&gt;1}</tt>, the name
      <tt class="verbatim">x</tt> is bound twice. The evaluation of <tt class="verbatim">x</tt> in
      that context will return <tt class="verbatim">0</tt> because rewrites are tested
      in order. In other words, the declaration <tt class="verbatim">x-&gt;0</tt>
      <em>shadows</em><a id="auto-284"></a> the declaration <tt class="verbatim">x-&gt;1</tt> in
      that context.
    </p>
    <p>
      For the purpose of finding the first match, a context is traversed depth
      first in left-to-right order, which is called <em>context order</em>.
    </p>
    <h4 id="auto-285">3.2.2<span style="margin-left: 1em"></span>Scoping</h4>
    <p>
      <a id="auto-286"></a>The left child of a context is called the <em>local
      scope</em><a id="auto-287"></a>. The right child of a context is the <em>enclosing
      context</em><a id="auto-288"></a>. All other left children in the sequence are the
      local scopes of expressions currently being evaluated. The first one
      being the <em>enclosing scope</em><a id="auto-289"></a> (i.e. the local scope of
      the enclosing context) and the last one being the <em>global
      scope</em><a id="auto-290"></a>.
    </p>
    <p>
      This ensures that local declarations hide declarations from the
      surrounding context, since they are on the left of the right child,
      while allowing local declarations in the left child of the context to be
      kept in program order, so that the later ones are shadowed by the
      earlier ones.
    </p>
    <p>
      The child at the far right of a context is a catch-all<a id="auto-291"></a>
      rewrite intended to specify what happens when evaluating an undefined
      form<a id="auto-292"></a>.
    </p>
    <h4 id="auto-293">3.2.3<span style="margin-left: 1em"></span>Current context</h4>
    <p>
      <a id="auto-294"></a><a id="auto-295"></a>Any evaluation in XLR is performed in a context
      called the <em>current context</em>. The current context is updated by
      the following operations:
    </p>
    <ol>
      <li>
        Evaluating the implementation of a rewrite creates a scope<a id="auto-296"></a>
        binding all arguments to the corresponding parameters, then a new
        context with that scope as its left child and the old context as its
        right child. The implementation is then evaluated in the newly created
        context.
      </li>
      <li>
        Evaluating a sequence initializes a local context with all
        declarations in that sequence, and creates a new current context with
        the newly created local context as its left child and the old context
        as its right child. Statements in the sequence are then evaluated in
        the newly created context.
      </li>
      <li>
        <a id="auto-297"></a>Evaluating an assignment changes the implementation of an
        existing binding if there is one in the current context, or otherwise
        creates a new binding in the local scope.
      </li>
    </ol>
    <h4 id="auto-298">3.2.4<span style="margin-left: 1em"></span>References</h4>
    <p>
      <a id="auto-299"></a>An expression that can be placed on the left of an assignment
      to identify a particular binding is called a <em>reference</em>. A
      reference can be any pattern that would go on the left of a rewrite. In
      addition, it can be an index operator<a id="auto-300"></a>:
    </p>
    <ul>
      <li>
        If <tt class="verbatim">A</tt> refers to a context, assigning to <tt class="verbatim">A.B</tt>
        will affect the binding of <tt class="verbatim">B</tt> in the context <tt class="verbatim">A</tt>,
        and not the binding of <tt class="verbatim">A.B</tt> in the current context.
      </li>
      <li>
        If <tt class="verbatim">A</tt> refers to a context, assigning to <tt class="verbatim">A[B]</tt>
        (or, equivalently, to <tt class="verbatim">A{B}</tt>, <tt class="verbatim">A(B)</tt> or
        <tt class="verbatim">A B</tt>) will affect the binding corresponding to <tt
        class="verbatim">B</tt> in the context of <tt class="verbatim">A</tt>, not the binding of
        <tt class="verbatim">A B</tt> in the current context. The index <tt class="verbatim">B</tt>
        will be evaluated in the current context if required to match patterns
        in <tt class="verbatim">A</tt>, as explained in Section <a href="#evaluation">3.3</a>.
      </li>
      <li>
        Special forms described in  Section <a href="#tree-operations">4.1.9</a>, such as <tt
        class="verbatim">left X</tt> refer to children of <tt class="verbatim">infix</tt>, <tt
        class="verbatim">prefix</tt>, <tt class="verbatim">postfix</tt> or <tt class="verbatim">block</tt>
        trees. They can be used as a reference in an assignment, and will
        modify the tree being referred to. This can be used to directly
        manipulate the program structure. 
      </li>
    </ul>
    <h3 id="auto-301"><a id="evaluation"></a>3.3<span style="margin-left: 1em"></span>Evaluation</h3>
    <p>
      <a id="auto-302"></a><em>Evaluation</em> is the process through which a given tree
      is rewritten.
    </p>
    <h4 id="auto-303"><a id="standard-evaluation"></a>3.3.1<span style="margin-left: 1em"></span>Standard evaluation</h4>
    <p>
      <a id="auto-304"></a>Except for special forms described later, the evaluation of
      XLR trees is performed as follows:
    </p>
    <ol>
      <li>
        The tree to evaluate, <tt class="verbatim">T</tt>, is matched against the
        available data and rewrite pattern. <tt class="verbatim">3*4+5</tt> will match
        <tt class="verbatim">A*B+C</tt> as well as <tt class="verbatim">A+B</tt> (since the
        outermost tree is an infix <tt class="verbatim">+</tt> as in <tt class="verbatim">A+B</tt>).
      </li>
      <li>
        Possible matches are tested in <em>context order</em><a id="auto-305"></a>
        (defined in Section <a href="#binding">3.2</a>) against the tree to evaluate.
        The first matching tree is selected. For example, in Figure <a href="#factorial">1</a>,
        <tt class="verbatim">(N-1)!</tt> will be matched against the rules <tt class="verbatim">0!</tt>
        and <tt class="verbatim">N!</tt> in this order.
      </li>
      <li>
        <p>
          <a id="auto-306"></a>Nodes in each candidate pattern <tt class="verbatim">P</tt> are
          compared to the tree <tt class="verbatim">T</tt> as follows:
        </p>
        <ul>
          <li>
            Constant symbols or names in <tt class="verbatim">P</tt> are compared to the
            corresponding element in <tt class="verbatim">T</tt> and must match exactly.
            For example, the <tt class="verbatim">+</tt> symbol in pattern <tt class="verbatim">A+B</tt>
            will match the plus <tt class="verbatim">+</tt> symbol in expression <tt
            class="verbatim">3*4+5</tt> but not the minus <tt class="verbatim">-</tt> symbol in
            <tt class="verbatim">3-5</tt>.
          </li>
          <li>
            Variables names in <tt class="verbatim">P</tt> that are not bound to any
            value and are not part of a type declaration are bound to the
            corresponding fragment of the tree in <tt class="verbatim">T</tt>. For
            example, for the expression <tt class="verbatim">3!</tt>, the variable <tt
            class="verbatim">N</tt> in Figure <a href="#factorial">1</a> will be bound to <tt class="verbatim">3</tt>.
          </li>
          <li>
            Variable names in <tt class="verbatim">P</tt> that are bound to a value are
            compared to the corresponding tree fragment in <tt class="verbatim">T</tt>
            after evaluation. For instance, if <tt class="verbatim">true</tt> is bound
            at the point of the declaration in Figure <a href="#if-then-else">21</a>, the
            test <tt class="verbatim">if A&lt;3 then X else Y</tt> requires the
            evaluation of the expression <tt class="verbatim">A&lt;3</tt>, and the
            result will be compared against <tt class="verbatim">true</tt>.
          </li>
          <li>
            This rule applies even if the binding occurred in the same
            pattern. For example, the pattern <tt class="verbatim">A+A</tt> will match
            <tt class="verbatim">3+3</tt> but not <tt class="verbatim">3+4</tt>, because <tt
            class="verbatim">A</tt> is first bound to <tt class="verbatim">3</tt> and then cannot
            match <tt class="verbatim">4</tt>. The pattern <tt class="verbatim">A+A</tt> will also
            match <tt class="verbatim">(3-1)+(4-2)</tt>: although <tt class="verbatim">A</tt> may
            first be bound to the unevaluated value <tt class="verbatim">3-1</tt>,
            verifying if the second <tt class="verbatim">A</tt> matches requires
            evaluating both <tt class="verbatim">A</tt> and the test value.
          </li>
          <li>
            Type declarations in <tt class="verbatim">P</tt> match if the result of
            evaluating the corresponding fragment in <tt class="verbatim">T</tt> has the
            declared type, as defined in Section <a href="#types">3.4</a>. In that
            case, the variable being declared is bound to the evaluated value.
          </li>
          <li>
            Constant values (integer, real and text) in <tt class="verbatim">P</tt> are
            compared to the corresponding fragment of <tt class="verbatim">T</tt> after
            evaluation. For example, in Figure <a href="#factorial">1</a>, when the
            expression <tt class="verbatim">(N-1)!</tt> is compared against <tt class="verbatim">0!</tt>,
            the expression <tt class="verbatim">(N-1)</tt> is evaluated in order to be
            compared to <tt class="verbatim">0</tt>.
          </li>
          <li>
            Infix, prefix and postfix nodes in <tt class="verbatim">P</tt> are compared
            to the matching node in <tt class="verbatim">T</tt> by comparing their
            children in depth-first, left to right order.
          </li>
        </ul>
        <p>
          The comparison process, called <em>pattern matching</em>, may cause
          fragments of the tree to be evaluated<a id="auto-307"></a>. Each fragment is
          evaluated at most once for the process of evaluating the tree <tt
          class="verbatim">T</tt>. Once the fragment has been evaluated, the evaluated
          value will be <em>memoized</em><a id="auto-308"></a> and used in any
          subsequent comparison or variable binding. For example, when
          computing <tt class="verbatim">F(3)!</tt>, the evaluation of <tt class="verbatim">F(3)</tt>
          is required in order to compare to <tt class="verbatim">0!</tt>, guaranteeing
          that <tt class="verbatim">N</tt> in <tt class="verbatim">N!</tt> will be bound to the
          evaluated value if <tt class="verbatim">F(3)</tt> is not equal to <tt class="verbatim">0</tt>.
        </p>
      </li>
      <li>
        <p>
          <a id="auto-309"></a>If there is no match found between any pattern <tt class="verbatim">P</tt>
          and the tree to evaluate <tt class="verbatim">T</tt>:
        </p>
        <ul>
          <li>
            Integer, real and text terminals evaluates as themselves.
          </li>
          <li>
            A block evaluates as the result of evaluating its child.
          </li>
          <li>
            If the tree is a prefix with the left being a name containing <tt
            class="verbatim">error</tt>, then the program immediately aborts and shows
            the offending tree. This case corresponds to an unhandled error.
          </li>
          <li>
            For a prefix node or postfix tree, the operator child (i.e. the
            left child for prefix and the right child for postfix) is
            evaluated, and if the result is different from the original
            operator child, evaluation is attempted again after replacing the
            original operator child with its evaluated version.
          </li>
          <li>
            In any other case, the tree is prefixed with <tt class="verbatim">evaluation_error</tt>
            and the result is evaluated. For example, <tt class="verbatim">$foo</tt>
            will be transformed into <tt class="verbatim">evaluation_error $foo</tt>. A
            prefix rewrite for <tt class="verbatim">evaluation_error</tt> is supposed to
            handle such errors.
          </li>
        </ul>
      </li>
      <li>
        <p>
          If a match is found, variables in the first matching pattern (called
          <em>parameters</em>) are bound to the corresponding fragments of the
          tree to evaluate (called <em>arguments</em>)<a id="auto-310"></a>.
        </p>
        <ul>
          <li>
            If an argument was evaluated (including as required for comparison
            with an earlier pattern), then the corresponding parameter is
            bound with the evaluated version.
          </li>
          <li>
            If the argument was not evaluated, the corresponding parameter is
            bound with the tree fragment in context, as explained in Section
            <a href="#binding">3.2</a>. In line with the terminology used in functional
            languages, this context-including binding<a id="auto-311"></a> is called a
            <em>closure</em><a id="auto-312"></a>.
          </li>
        </ul>
      </li>
      <li>
        Once all bindings have been performed, the implementation
        corresponding to the pattern in the previous step is itself evaluated.
        The result of the evaluation of the original form is the result of
        evaluating the implementation in the new context<a id="auto-313"></a> created by
        adding to the original context the bindings of parameters to their
        arguments. For a data form, the result of evaluation is the pattern
        after replacing parameters with the corresponding arguments.
      </li>
    </ol>
    <h4 id="auto-314">3.3.2<span style="margin-left: 1em"></span>Special forms</h4>
    <p>
      <a id="auto-315"></a><a id="auto-316"></a>Some forms have a special meaning and are
      evaluated specially:
    </p>
    <ol>
      <li>
        A terminal node (integer, real, type, name) evaluates as itself,
        unless there is an explicit rewrite rule for it
        <p>
          <font size="-1"><div align="justify">
            <div style="margin-left: 0px">
              <div style="margin-right: 0px">
                <p>
                  . There are several use cases for allowing rewrite rules for
                  integer, real or text constants, notably to implement data
                  maps such as <tt class="verbatim">(1-&gt;0; 0-&gt;1)</tt>, also known
                  as associative arrays.
                </p>
              </div>
            </div>
          </div></font>
        </p>
        <span style="margin-left: 0em"></span>
        <a id="footnr-10"></a>
        <sup><a href="#footnote-10">10</a></sup>
        .
      </li>
      <li>
        A block evaluate as the result of evaluating its child.
      </li>
      <li>
        A rewrite rule evaluates as itself.
      </li>
      <li>
        A data declaration evaluates as itself
      </li>
      <li>
        An assignment binds the variable and evaluates as the named variable
        after assignment
      </li>
      <li>
        Evaluating a sequence creates a new local context with all
        declarations in the sequence, then evaluates all its statements in
        order in that new local context. The result of evaluation is the
        result of the last statement, if there is one, or the newly created
        context if the sequence only contains declarations.
      </li>
      <li>
        If <tt class="verbatim">C</tt> is a context and <tt class="verbatim">E</tt> is an
        expression, evaluating <tt class="verbatim">C E</tt> is equivalent to evaluating
        <tt class="verbatim">E</tt> in the current context, then evaluating the result
        in the context of <tt class="verbatim">C</tt>. For example, <tt class="verbatim">(0-&gt;3)(1-1)</tt>
        will evaluate <tt class="verbatim">1-1</tt>, resulting in <tt class="verbatim">0</tt>,
        then evaluate the result in the context <tt class="verbatim">0-&gt;3</tt>,
        resulting in the value <tt class="verbatim">3</tt>.
      </li>
      <li>
        If <tt class="verbatim">C</tt> is a context and <tt class="verbatim">E</tt> is an
        expression, evaluating <tt class="verbatim">C.E</tt> is equivalent to evaluating
        <tt class="verbatim">E</tt> in the context of <tt class="verbatim">C</tt>. For example,
        <tt class="verbatim">(foo-&gt;1;bar-&gt;2).bar</tt> will return <tt class="verbatim">2</tt>.
      </li>
    </ol>
    <h4 id="auto-317"><a id="lazy-evaluation"></a>3.3.3<span style="margin-left: 1em"></span>Lazy evaluation</h4>
    <p>
      <a id="auto-318"></a><a id="auto-319"></a>When an argument is bound to a parameter, it is
      associated to a context which allows correct evaluation at a later time,
      but the argument is in general not evaluated immediately. Instead, it is
      only evaluated when evaluation becomes necessary for the program to
      execute correctly. This technique is called <em>lazy evaluation</em>. It
      is intended to minimize unnecessary evaluations.
    </p>
    <p>
      Evaluation of an argument before binding it to its parameter occurs in
      the following cases, collectively called <em>demand-based
      evaluation</em><a id="auto-320"></a>:
    </p>
    <ol>
      <li>
        <p>
          The argument is compared to a constant value or bound name, see
          Section <a href="#standard-evaluation">3.3.1</a>, and the static value of the tree is not
          sufficient to perform the comparison. For example, in Figure <a
          href="#evaluation-for-comparison">37</a>, the expression <tt class="verbatim">4+X</tt> requires evaluation
          of <tt class="verbatim">X</tt> for comparison with <tt class="verbatim">4</tt> to check
          if it matches <tt class="verbatim">A+A</tt>; the expression <tt class="verbatim">B+B</tt>
          can be statically bound to the form <tt class="verbatim">A+A</tt> without
          requiring evaluation of <tt class="verbatim">B</tt>; finally, in <tt class="verbatim">B+C</tt>,
          both <tt class="verbatim">B</tt> and <tt class="verbatim">C</tt> need to be evaluated to
          compare if they are equal and if the form <tt class="verbatim">A+A</tt>
          matches.
        </p>
        <table align="center" id="evaluation-for-comparison">
          <tbody><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
A+A -&gt; 2*A
4+X  // X evaluated
B+B  // B not evaluated
B+C  // B and C evaluated</pre></td>
          </tr><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
          </tr><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
              <font size="-1"><p>
                <b>Figure 37. </b><a id="auto-321"></a>Evaluation for comparison
              </p></font>
            </p></td>
          </tr></tbody>
        </table>
      </li>
      <li>
        <p>
          The argument is tested against a parameter with a type declaration,
          and the static type of the tree is not sufficient to guarantee a
          match. For example, in Figure <a href="#evaluation-for-type-comparison">38</a>, the expression <tt
          class="verbatim">Z+1</tt> can statically be found to match the form <tt class="verbatim">X+Y</tt>,
          so <tt class="verbatim">Z</tt> needn't be evaluated. On the other hand, in <tt
          class="verbatim">1+Z</tt>, it is necessary to evaluate <tt class="verbatim">Z</tt> to
          type-check it against <tt class="verbatim">integer</tt>.
        </p>
        <table align="center" id="evaluation-for-type-comparison">
          <tbody><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
X:tree + Y:integer -&gt; ...
Z + 1 // Z not evaluated
1 + Z // Z evaluated</pre></td>
          </tr><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
          </tr><tr>
            <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
              <font size="-1"><p>
                <b>Figure 38. </b><a id="auto-322"></a>Evaluation for type comparison
              </p></font>
            </p></td>
          </tr></tbody>
        </table>
      </li>
      <li>
        A specific case of the above scenario is the left side of any index
        operator. In <tt class="verbatim">A.B</tt> or <tt class="verbatim">A[B]</tt>, the value
        <tt class="verbatim">A</tt> needs to be evaluated to verify if it contains <tt
        class="verbatim">B</tt>.
      </li>
    </ol>
    <p>
      When lazy evaluation happens, the expression being bound is a closure as
      explained in Section <a href="#standard-evaluation">3.3.1</a>, i.e. it will be an expression
      of the form <tt class="verbatim">C.E</tt> where <tt class="verbatim">C</tt> is the original
      evaluation context and <tt class="verbatim">E</tt> is the original expression to
      evaluate.
    </p>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">13</class>. </b>Lazy evaluation was documented
      after the compilers were implemented, and is not entirely consistent in
      the current implementations. This should be fixed in future versions.
    </p>
    <h4 id="auto-323"><a id="explicit-evaluation"></a>3.3.4<span style="margin-left: 1em"></span>Explicit evaluation</h4>
    <p>
      <a id="auto-324"></a><a id="auto-325"></a>Expressions are also evaluated in the following
      cases, collectively called <em>explicit evaluation</em>:
    </p>
    <ol>
      <li>
        An expression on the left or right of a sequence is evaluated. For
        example, in <tt class="verbatim">A;B</tt>, the names <tt class="verbatim">A</tt> and <tt
        class="verbatim">B</tt> will be evaluated.
      </li>
      <li>
        The prefix <tt class="verbatim">do</tt> forces evaluation of its argument. For
        example, <tt class="verbatim">do X</tt> will force the evaluation of <tt class="verbatim">X</tt>.
      </li>
      <li>
        The program itself is evaluated. Most useful programs are sequences.
      </li>
    </ol>
    <p>
      The explicit evaluation of a name does not change the value bound to
      that name in the current context. For example, if the current context
      contains <tt class="verbatim">A-&gt;write &quot;Hello&quot;</tt>, each explicit
      evaluation of <tt class="verbatim">A</tt> will cause the message <tt class="verbatim">Hello</tt>
      to be written.
    </p>
    <h4 id="auto-326">3.3.5<span style="margin-left: 1em"></span>Memoization</h4>
    <p>
      <a id="auto-327"></a>Whenever a parameter is evaluated, the evaluated result may
      be used for all subsequent demand-based evaluations of the same tree, a
      process called <em>memoization</em>. What is memoized is associated with
      the original tree.
    </p>
    <p>
      
    </p>
    <p>
      Memoization does not happen for explicit evaluations. This is
      illustrated with the example in Figure <a href="#explicit-vs-lazy-evaluation">39</a>:
    </p>
    <table align="center" id="explicit-vs-lazy-evaluation">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
foo X -&gt;
    X
    if X then writeln &quot;X is true&quot;
    if do X then writeln &quot;X is true&quot;
    X
bar -&gt;
    writeln &quot;bar evaluated&quot;
    true
foo bar</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 39. </b><a id="auto-328"></a>Explicit vs. lazy evaluation
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      <a id="auto-329"></a>In Figure <a href="#explicit-vs-lazy-evaluation">39</a>, evaluation happens as follows:
    </p>
    <ol>
      <li>
        The expression <tt class="verbatim">foo bar</tt> is evaluated explicitly, being
        part of a sequence. This matches the rewrite for <tt class="verbatim">foo X</tt>
        on the first line.
      </li>
      <li>
        The first reference to <tt class="verbatim">X</tt> in the implementation is
        evaluated explicitly. This causes the message <samp>bar
        evaluated</samp> to be written to the console.
      </li>
      <li>
        The second reference to <tt class="verbatim">X</tt> is demand-based, but since
        <tt class="verbatim">X</tt> has already been evaluated, the result <tt class="verbatim">true</tt>
        is used directly. The message <samp>X is true</samp> is emitted on the
        console, but the message <samp>bar evaluated</samp> is not.
      </li>
      <li>
        The third reference to <tt class="verbatim">X</tt> is an argument to <tt class="verbatim">do</tt>,
        so it is evaluated again, which writes the message <samp>bar
        evaluated</samp> on the console.
      </li>
      <li>
        The last reference to <tt class="verbatim">X</tt> is another explicit
        evaluation, so the message <samp>bar evaluated</samp> is written on
        the console again.
      </li>
    </ol>
    <p>
      The purpose of these rules is to allow the programmer to pass code to be
      evaluated as an argument, while at the same time minimizing the number
      of repeated evaluations when a parameter is used for its value. In
      explicit evaluation, the value of the parameter is not used, making it
      clear that what matters is the effect of evaluation itself. In
      demand-based evaluation, it is on the contrary assumed that what matters
      is the result of the evaluation, not the process of evaluating it. It is
      always possible to force evaluation explicitly using <tt class="verbatim">do</tt><a
      id="auto-330"></a>.
    </p>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">14</class>. </b>Like lazy evaluation,
      memoization is not fully consistent in the current implementations.
    </p>
    <h3 id="auto-331"><a id="types"></a>3.4<span style="margin-left: 1em"></span>Types</h3>
    <p>
      <em>Types</em><a id="auto-332"></a> are expressions that appear on the right of
      the colon operator <tt class="verbatim">:</tt> in type declarations<a id="auto-333"></a><a
      id="auto-334"></a>. In XLR, a type identifies the <em>shape</em> of a tree. A
      value is said to <em>belong</em> to a type if it matches the shape
      defined by the type. A value may belong to multiple types<a id="auto-335"></a>.
    </p>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">15</class>. </b>Like contexts, the type system
      was largely redesigned based on experience with the first
      implementations of the language. As a result, the current
      implementations implement a very weak type system compared to what is
      being described in this section. At this point, user-defined types do
      not work as descried in either the standard or optimized implementation.
      This section defines the future implementation.
    </p>
    <h4 id="auto-336">3.4.1<span style="margin-left: 1em"></span>Predefined types</h4>
    <p>
      <a id="auto-337"></a><a id="auto-338"></a>The following types are predefined:
    </p>
    <ul>
      <li>
        <tt class="verbatim">integer</tt><a id="auto-339"></a> matches integer values
      </li>
      <li>
        <tt class="verbatim">real</tt><a id="auto-340"></a> matches real values
      </li>
      <li>
        <tt class="verbatim">text<a id="auto-341"></a></tt> matches text values
      </li>
      <li>
        <tt class="verbatim">symbol</tt><a id="auto-342"></a> matches names and operator symbols
      </li>
      <li>
        <tt class="verbatim">name</tt><a id="auto-343"></a> matches names only
      </li>
      <li>
        <tt class="verbatim">operator</tt><a id="auto-344"></a> matches operator symbols only
      </li>
      <li>
        <tt class="verbatim">infix</tt><a id="auto-345"></a> matches infix nodes
      </li>
      <li>
        <tt class="verbatim">prefix</tt><a id="auto-346"></a> matches prefix nodes
      </li>
      <li>
        <tt class="verbatim">postfix</tt><a id="auto-347"></a> matches postfix nodes
      </li>
      <li>
        <tt class="verbatim">block</tt><a id="auto-348"></a> matches block nodes
      </li>
      <li>
        <tt class="verbatim">tree</tt><a id="auto-349"></a> matches any abstract syntax tree, i.e.
        any representable XL value
      </li>
      <li>
        <tt class="verbatim">boolean</tt><a id="auto-350"></a> matches the names <tt class="verbatim">true</tt>
        and <tt class="verbatim">false</tt>.
      </li>
    </ul>
    <h4 id="auto-351"><a id="type-definition"></a>3.4.2<span style="margin-left: 1em"></span>Type definition</h4>
    <p>
      <a id="auto-352"></a><a id="auto-353"></a><a id="auto-354"></a>A <em>type definition</em> for type <tt
      class="verbatim">T</tt> is a special form of tree rewrite declaration where the
      pattern has the form <tt class="verbatim">type X</tt>. A type definition declares
      a type name, and the pattern that the type must match. For example,
      Figure <a href="#simple-type">40</a> declares a type named <tt class="verbatim">complex</tt>
      requiring two real numbers called <tt class="verbatim">re</tt> and <tt class="verbatim">im</tt>,
      and another type named <tt class="verbatim">ifte</tt><a id="auto-355"></a> that contains
      three arbitrary trees called <tt class="verbatim">Cond</tt>, <tt class="verbatim">TrueC</tt>
      and <tt class="verbatim">FalseC</tt>.
    </p>
    <table align="center" id="simple-type">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
complex -&gt; type (re:real, im:real)
ifte -&gt; type {if Cond then TrueC else FalseC}</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 40. </b><a id="auto-356"></a>Simple type declaration
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      The outermost block of a type pattern, if it exists, is not part of the
      type pattern<a id="auto-357"></a><a id="auto-358"></a><a id="auto-359"></a>. To create a type matching
      a specific block shape, two nested bocks are required, as illustrated
      with <tt class="verbatim">paren_block_type</tt> in Figure <a href="#block-type-declaration">41</a>:
    </p>
    <table align="center" id="block-type-declaration">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
paren_block_type -&gt; type((BlockChild))</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 41. </b><a id="auto-360"></a>Simple type declaration
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      Note that type definitions and type declarations should not be confused.
      A type <em>definition</em> defines a type and has the form <tt class="verbatim">Name
      -&gt; type TypePattern</tt>, whereas a type <em>declaration</em><a id="auto-361"></a><a
      id="auto-362"></a> declares the type of an entity and has the form <tt class="verbatim">Name:Type</tt>.
      The type defined by a type definition can be used on the right of a type
      declaration. For example, Figure <a href="#using-complex">42</a> shows how to use the
      <tt class="verbatim">complex</tt> type defined in Figure <a href="#simple-type">40</a> in
      parameters.
    </p>
    <table align="center" id="using-complex">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
Z1:complex+Z2:complex -&gt; (Z1.re+Z2.re, Z1.im+Z2.im)</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 42. </b><a id="auto-363"></a>Using the <tt class="verbatim">complex</tt>
            type
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      Parameters<a id="auto-364"></a> of types such as <tt class="verbatim">complex</tt> are bound
      to contexts with declarations for the individual variables of the
      pattern of the type. For example, a <tt class="verbatim">complex</tt> like <tt
      class="verbatim">Z1</tt> in Figure <a href="#using-complex">42</a> contains a rewrite for <tt
      class="verbatim">re</tt> and a rewrite for <tt class="verbatim">im</tt>. Figure <a href="#binding-for-complex-parameter">43</a>
      possible bindings<a id="auto-365"></a> when using the complex addition operator
      defined in Figure <a href="#using-complex">42</a>. The standard index notation<a id="auto-366"></a>
      described in Section <a href="#index-operators">3.1.7</a> applies, e.g. in <tt class="verbatim">Z1.re</tt>,
      and these bindings can be assigned to.
    </p>
    <table align="center" id="binding-for-complex-parameter">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
// Expression being evaluated
(3.4, 5.2)+(0.4, 2.22)

// Possible resulting bindings
// in the implementation of +
Z1 -&gt;
    re-&gt;3.4
    im-&gt;5.2
    re, im
Z2 -&gt;
    re-&gt;0.4
    im-&gt;2.22
    re, im</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 43. </b><a id="auto-367"></a>Binding for a <tt class="verbatim">complex</tt>
            parameter
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      Figure <a href="#making-two-types-equivalent">44</a> shows two ways to make type <tt class="verbatim">A</tt>
      equivalent to type <tt class="verbatim">B</tt>:
    </p>
    <table align="center" id="making-two-types-equivalent">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
A -&gt; B
A -&gt; type X:B</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 44. </b><a id="auto-368"></a>Making type <tt class="verbatim">A</tt>
            equivalent to type <tt class="verbatim">B</tt>
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h4 id="auto-369">3.4.3<span style="margin-left: 1em"></span>Normal form for a type</h4>
    <p>
      <a id="auto-370"></a><a id="auto-371"></a>By default, the name of a type is not part of the
      pattern being recognized. It is often recommended to make data types
      easier to identify by making the pattern more specific<a id="auto-372"></a>, for
      instance by including the type name in the pattern itself, as shown in
      Figure <a href="#more-specific-complex-types">45</a>:
    </p>
    <table align="center" id="more-specific-complex-types">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
complex -&gt; type complex(re:real, im:real)</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 45. </b><a id="auto-373"></a>Named patterns for <tt class="verbatim">complex</tt>
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      In general, multiple notations for a same type<a id="auto-374"></a> can coexist.
      In that case, it is necessary to define a form for trees that the other
      possible forms will reduce to. This form is called the <em>normal
      form</em>. This is illustrated in Figure <a href="#complex-normal-form">46</a>, where the
      normal form is <tt class="verbatim">complex(re;im)</tt> and the other notations
      are rewritten to this normal form for convenience.
    </p>
    <table align="center" id="complex-normal-form">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
// Normal form for the complex type
complex -&gt; type complex(re:real, im:real)

// Other possible notations that reduce to the normal form
i -&gt; complex(0,1)
A:real + i*B:real -&gt; complex(A,B)
A:real + B:real*i -&gt; complex(A,B)</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 46. </b><a id="auto-375"></a>Creating a normal form for the
            complex type
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h4 id="auto-376">3.4.4<span style="margin-left: 1em"></span>Properties</h4>
    <p>
      <a id="auto-377"></a><a id="auto-378"></a>Properties are types that match a number of trees,
      based not just on the shape of the tree, but on symbols bound in that
      tree. For instance, when you need a <tt class="verbatim">color</tt> type
      representing red, green and blue components, you care about the value of
      the components, but not the order in which they appear.
    </p>
    <p>
      A <em>properties definition</em> is a rewrite declaration like the one
      shown in Figure <a href="#properties-declaration">47</a> where:
    </p>
    <ol>
      <li>
        The implementation is a prefix with the name <tt class="verbatim">properties</tt>
        followed by a block.
      </li>
      <li>
        The block contains a sequence of type declarations <tt class="verbatim">Name:Type</tt>
        or assignments to type declarations <tt class="verbatim">Name:Type:=DefaultValue</tt>,
        each such statement being called a <em>property</em><a id="auto-379"></a>.
      </li>
      <li>
        The block optionally contains one or more <tt class="verbatim">inherit</tt><a
        id="auto-380"></a> prefix (see Section <a href="#data-inheritance-section">3.4.5</a>)
      </li>
    </ol>
    <table align="center" id="properties-declaration">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
color -&gt; properties
    red   : real
    green : real
    blue  : real
    alpha : real := 1.0</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 47. </b><a id="auto-381"></a>Properties declaration
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      Properties parameters<a id="auto-382"></a> match any block for which all the
      properties are defined. Properties are defined<a id="auto-383"></a><a id="auto-384"></a>
      either if they exist in the argument's context, or if they are
      explicitly set in the block argument, or if a <em>default value</em><a
      id="auto-385"></a><a id="auto-386"></a> was assigned to the property in the properties
      declaration. An individual property can be set<a id="auto-387"></a> using an
      assignment or by using the property name as a prefix.
    </p>
    <p>
      For example, Figure <a href="#color-properties">48</a> shows how the <tt class="verbatim">color</tt>
      type defined in Figure <a href="#properties-declaration">47</a> can be used in a parameter
      declaration<a id="auto-388"></a>, and how a <tt class="verbatim">color</tt> argument<a id="auto-389"></a>
      can be passed.
    </p>
    <table align="center" id="color-properties">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
write C:color -&gt;
    write &quot;R&quot;, C.red
    write &quot;G&quot;, C.green
    write &quot;B&quot;, C.blue
    write &quot;A&quot;, C.alpha
write_color { red 0.5; green 0.2; blue 0.6 }</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 48. </b><a id="auto-390"></a>Color properties
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      Properties parameters are contexts containing local declarations called
      <em>getters</em><a id="auto-391"></a> and <em>setters</em><a id="auto-392"></a> for each
      individual property:
    </p>
    <ul>
      <li>
        The setter is a prefix taking an argument of the property's type, and
        setting the property's value to its argument.
      </li>
      <li>
        The getter returns the value of the property in the argument's context
        (which may be actually set in the argument's enclosing contexts), or
        the default value if the property is not bound in the argument's
        context.
      </li>
    </ul>
    <p>
      This makes it possible to set default value in the caller's context,
      which will be injected in the argument, as illustrated in Figure <a
      href="#setting-default-arguments">49</a>, where the expression <tt class="verbatim">C.red</tt> in <tt class="verbatim">write_color</tt>
      will evaluate to <tt class="verbatim">0.5</tt>, and the argument <tt class="verbatim">C.alpha</tt>
      will evaluate to <tt class="verbatim">1.0</tt> as specified by the default value:
    </p>
    <table align="center" id="setting-default-arguments">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
red := 0.5
write_color (blue 0.6; green 0.2)</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 49. </b><a id="auto-393"></a>Setting default arguments from the
            current context
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      It is sufficient for the block argument to define all required
      properties<a id="auto-394"></a><a id="auto-395"></a>. The block argument may also contain
      more code than just the references to the setters, as illustrated in
      Figure <a href="#extra-code-for-properties">50</a>:
    </p>
    <table align="center" id="extra-code-for-properties">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
write_color
    X:real := 0.444 * sin time
    if X &lt; 0 then X := 1.0+X
    red X
    green X^2
    blue X^3</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 50. </b><a id="auto-396"></a>Additional code in properties
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      
    </p>
    <h4 id="auto-397"><a id="data-inheritance-section"></a>3.4.5<span style="margin-left: 1em"></span>Data inheritance</h4>
    <p>
      <a id="auto-398"></a><a id="auto-399"></a>Properties declarations may <em>inherit</em> data
      from one or more other types by using one or more <tt class="verbatim">inherit</tt>
      prefixes in the properties declaration, as illustrated in Figure <a
      href="#data-inheritance">51</a>, where the type <tt class="verbatim">rgb</tt> contains three
      properties called <tt class="verbatim">red</tt>, <tt class="verbatim">green</tt> and <tt
      class="verbatim">blue</tt>, and the type <tt class="verbatim">rgba</tt> additionally
      contains an <tt class="verbatim">alpha</tt> property:
    </p>
    <table align="center" id="data-inheritance">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
rgb -&gt; properties
    red   : real
    green : real
    blue  : real
rgba -&gt; properties
    inherit rgb
    alpha : real</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 51. </b><a id="auto-400"></a>Data inheritance
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      Only declarations are inherited in this manner. The resulting types are
      not compatible, although they can be made compatible using automatic
      type conversions<a id="auto-401"></a> (see Section <a href="#type-conversions">3.4.7</a>).
    </p>
    <h4 id="auto-402">3.4.6<span style="margin-left: 1em"></span>Explicit type check</h4>
    <p>
      <a id="auto-403"></a><a id="auto-404"></a><a id="auto-405"></a><a id="auto-406"></a>Internally, a type is any
      context where a <tt class="verbatim">contains</tt><a id="auto-407"></a> prefix can be
      evaluated. In such a context, the expression <tt class="verbatim">contains X</tt>
      is called a <em>type check</em> for the type and for value <tt class="verbatim">X</tt>.
      A type check must return a <tt class="verbatim">boolean</tt> value to indicate if
      the value <tt class="verbatim">X</tt> belongs to the given type.
    </p>
    <p>
      <a id="auto-408"></a>Type checks can be declared explicitly to create types
      identifying arbitrary forms of trees that would be otherwise difficult
      to specify. This is illustrated in Figure <a href="#arbitrary-type">52</a> where we
      define an <tt class="verbatim">odd</tt> type that contains only odd integers and
      the text <tt class="verbatim">&quot;Odd&quot;</tt>. We could similarly add a type
      check to the definition of <tt class="verbatim">rgb</tt> in Figure <a href="#data-inheritance">51</a>
      to make sure that <tt class="verbatim">red</tt>, <tt class="verbatim">green</tt> and <tt
      class="verbatim">blue</tt> are between <tt class="verbatim">0.0</tt> and <tt class="verbatim">1.0</tt>.
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
odd -&gt;
    contains X:integer -&gt; X mod 2 = 1
    contains &quot;Odd&quot; -&gt; true
    contains X -&gt; false</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 52. </b><a id="auto-409"></a>Defining a type identifying an
            arbitrary AST shape
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      <a id="arbitrary-type"></a>The type check for a type can be invoked explicitly using the
      infix <tt class="verbatim">contains</tt> (with the type on the left) or <tt class="verbatim">is_a</tt><a
      id="auto-410"></a> (with the type on the right).  This is shown in Figure <a href="#contains-tests">53</a>.
      The first type check <tt class="verbatim">odd contains 3</tt> should return <tt
      class="verbatim">true</tt>, since <tt class="verbatim">3</tt> belongs to the <tt class="verbatim">odd</tt>
      type. The second type check should return <tt class="verbatim">false</tt> since
      <tt class="verbatim">rgb</tt> expects the property <tt class="verbatim">blue</tt> to be set.
    </p>
    <table align="center" id="contains-tests">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
if odd contains 3 then pass else fail
if (red 1; green 1) is_a rgb then fail else pass</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 53. </b><a id="auto-411"></a>Explicit type check
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h4 id="auto-412"><a id="type-conversions"></a>3.4.7<span style="margin-left: 1em"></span>Explicit and automatic type
    conversions</h4>
    <p>
      <a id="auto-413"></a><a id="auto-414"></a>Prefix forms with the same name as a type can be
      provided to make it easy to convert values to type <tt class="verbatim">T</tt>.
      Such forms are called <em>explicit type conversions</em>. This is
      illustrated in Figure <a href="#explicit-type-conversion">54</a>:
    </p>
    <table align="center" id="explicit-type-conversion">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
rgba C:rgb  -&gt; (red C.red; green C.green; blue C.blue; alpha 1.0)
rgb  C:rgba -&gt; (red C.red; green C.green; blue C.blue)</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 54. </b><a id="auto-415"></a>Explicit type conversion
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      <a id="auto-416"></a>An <em>automatic type conversion</em> is an infix <tt class="verbatim">as</tt>
      form with a type on the right. If such a form exists, it can be invoked
      to automatically convert a value to the type on the right of <tt class="verbatim">as</tt>.
      This is illustrated in Figure <a href="#automatic-type-conversion">55</a>.
    </p>
    <table align="center" id="automatic-type-conversion">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
X:integer as real -&gt; real X
1+1.5   // 1.0+1.5 using conversion above</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 55. </b><a id="auto-417"></a>Automatic type conversion
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h4 id="auto-418">3.4.8<span style="margin-left: 1em"></span>Parameterized types</h4>
    <p>
      <a id="auto-419"></a><a id="auto-420"></a>Since type definitions are just regular rewrites,
      a type definition may contain a more complex pattern on the left of the
      rewrite. This is illustrated in Figure <a href="#parameterized-type">56</a>, where we define
      a <tt class="verbatim">one_modulo N</tt> type that generalizes the <tt class="verbatim">odd</tt>
      type.
    </p>
    <table align="center" id="parameterized-type">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
one_modulo N:integer -&gt;
    contains X:integer -&gt; X mod N = 1
    contains X -&gt; false
show X:(one_modulo 1)</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 56. </b><a id="auto-421"></a>Parameterized type
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      It is also possible to define tree forms that are neither name nor
      prefix. Figure <a href="#infix-type">57</a> shows how we can use an infix form with
      the <tt class="verbatim">..</tt> operator to declare a range type.
    </p>
    <table align="center" id="infix-type">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
Low:integer..High:integer -&gt;
    contains X:integer -&gt; X&gt;=Low and X&lt;=High
    contains X -&gt; false
foo X:1..5 -&gt; write X</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 57. </b><a id="auto-422"></a>Declaring a range type using an infix
            form
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h4 id="auto-423">3.4.9<span style="margin-left: 1em"></span>Rewrite types</h4>
    <p>
      <a id="auto-424"></a><a id="auto-425"></a>The infix <tt class="verbatim">-&gt;</tt> operator can be
      used in a type definition to identify specific forms of rewrites that
      perform a particular kind of tree transformation. Figure <a href="#rewrite-type">58</a>
      illustrates this usage to declare an <tt class="verbatim">adder</tt> type that
      will only match rewrites declaring an infix <tt class="verbatim">+</tt> node:
    </p>
    <table align="center" id="rewrite-type">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
adder -&gt; type {X+Y -&gt; Z}</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 58. </b><a id="auto-426"></a>Declaration of a rewrite type
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h2 id="auto-427">4<span style="margin-left: 1em"></span>Standard XL library</h2>
    <p>
      <a id="auto-428"></a>The XLR language is intentionally very simple, with a strong
      focus on how to extend it rather than on built-in features. Most
      features that would be considered fundamental in other languages are
      implemented in the library in XLR. Implementing basic amenities that way
      is an important proof point to validate the initial design objective,
      extensibility of the language.
    </p>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">16</class>. </b>This describes the standard XL
      library for the core, text-only implementation of XL found in the
      open-source implementation. Since there is no real difference between
      built-in functions and library definitions, the XL language can be
      &ldquo;embedded&rdquo; in an application that will provide a much richer
      vocabulary. In particular, users of Tao Presentations should refer to
      the Tao Presentations on-line documentation for information about
      features specific to this product, such as 3D graphics, regular
      expressions, networking, etc.
    </p>
    <h3 id="auto-429"><a id="built-ins"></a>4.1<span style="margin-left: 1em"></span>Built-in operations</h3>
    <p>
      <a id="auto-430"></a>A number of operations are defined by the core run-time of
      the language, and appear in the context used to evaluate any XLR
      program.
    </p>
    <p>
      This section describes the minimum list of operations available in any
      XLR program. Operator priorities are defined by the <tt class="verbatim">xl.syntax</tt><a
      id="auto-431"></a> file in Figure <a href="#syntax-file">11</a>. All operations listed in this
      section may be implemented specially in the compiler, or using regular
      rewrite rules defined in a particular file called <tt class="verbatim">builtins.xl</tt><a
      id="auto-432"></a> that is loaded by XLR before evaluating any program, or a
      combination of both.
    </p>
    <h4 id="auto-433">4.1.1<span style="margin-left: 1em"></span>Arithmetic</h4>
    <p>
      <a id="auto-434"></a>Arithmetic operators for <tt class="verbatim">integer</tt> and <tt
      class="verbatim">real</tt> values are listed in Table <a href="#arithmetic">2</a>, where <tt
      class="verbatim">x</tt> and <tt class="verbatim">y</tt> denote integer or real values.
      Arithmetic operators take arguments of the same type and return an
      argument of the same type. In addition, the power<a id="auto-435"></a> operator
      <strong>^</strong> can take a first <tt class="verbatim">real</tt> argument and an
      <tt class="verbatim">integer</tt> second argument.
    </p>
    <table align="center" id="arithmetic">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><table style="display: inline; vertical-align: -6.05em">
          <tbody><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid; border-top: 1px solid"><strong>Form</strong></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-top: 1px solid"><strong>Description</strong></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x+y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Addition</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x-y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Subtraction</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x*y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Multiplication</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x/y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Division</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x rem y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Remainder</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x mod y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Modulo</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x^y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Power</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">-x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Negation</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x%</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Percentage (<tt class="verbatim">x/100.0)</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x!</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Factorial</td>
          </tr></tbody>
        </table></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Table 2. </b><a id="auto-436"></a>Arithmetic operations
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h4 id="auto-437">4.1.2<span style="margin-left: 1em"></span>Comparison</h4>
    <p>
      <a id="auto-438"></a>
      Comparison operators can take
      <tt class="verbatim">integer</tt>
      ,
      <tt class="verbatim">real</tt>
      or
      <tt class="verbatim">text</tt>
      argument, both arguments being of the same type, and return a
      <tt class="verbatim">boolean</tt>
      argument, which can be either
      <tt class="verbatim">true</tt>
      or
      <tt class="verbatim">false</tt>
      . Text is compared using the lexicographic order
      <p>
        <font size="-1"><div align="justify">
          <div style="margin-left: 0px">
            <div style="margin-right: 0px">
              <p>
                . There is currently no locale-dependent text comparison.
              </p>
            </div>
          </div>
        </div></font>
      </p>
      <span style="margin-left: 0em"></span>
      <a id="footnr-11"></a>
      <sup><a href="#footnote-11">11</a></sup>
      .
    </p>
    <table align="center" id="comparisons">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><table style="display: inline; vertical-align: -3.85em">
          <tbody><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid; border-top: 1px solid"><strong>Form</strong></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-top: 1px solid"><strong>Description</strong></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x=y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Equal</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x&lt;&gt;y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Not equal</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x&lt;y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Less-than</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x&gt;y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Greater than</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x&lt;=y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Less or equal</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x&gt;=y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Greater or equal</td>
          </tr></tbody>
        </table></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Table 3. </b><a id="auto-439"></a>Comparisons
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h4 id="auto-440">4.1.3<span style="margin-left: 1em"></span>Bitwise arithmetic</h4>
    <p>
      <a id="auto-441"></a><a id="auto-442"></a>Bitwise operators operate on the binary
      representation of <tt class="verbatim">integer</tt> values, treating each bit
      individually.
    </p>
    <table align="center" id="bitwise-arithmetic">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><table style="display: inline; vertical-align: -3.85em">
          <tbody><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid; border-top: 1px solid"><strong>Form</strong></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-top: 1px solid"><strong>Description</strong></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x shl y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Shift <tt class="verbatim">x</tt> left by <tt class="verbatim">y</tt>
            bits</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x shr y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Shift <tt class="verbatim">x</tt> right by <tt class="verbatim">y</tt>
            bits</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x and y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Bitwise and</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x or y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Bitwise or</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x xor y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Bitwise exclusive or</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">not x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Bitwise complement</td>
          </tr></tbody>
        </table></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Table 4. </b><a id="auto-443"></a>Bitwise arithmetic operations
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h4 id="auto-444">4.1.4<span style="margin-left: 1em"></span>Boolean operations</h4>
    <p>
      <a id="auto-445"></a>Boolean operators operate on the names <tt class="verbatim">true</tt>
      and <tt class="verbatim">false</tt>.
    </p>
    <table align="center" id="boolean-operations">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><table style="display: inline; vertical-align: -3.85em">
          <tbody><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid; border-top: 1px solid"><strong>Form</strong></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-top: 1px solid"><strong>Description</strong></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x=y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Equal</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x&lt;&gt;y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Not equal</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x and y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Logical and</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x or y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Logical or</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x xor y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Logical exclusive or</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">not x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Logical not</td>
          </tr></tbody>
        </table></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Table 5. </b><a id="auto-446"></a>Boolean operations
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h4 id="auto-447">4.1.5<span style="margin-left: 1em"></span>Mathematical functions</h4>
    <p>
      <a id="auto-448"></a>Mathematical functions operate on <tt class="verbatim">real</tt>
      numbers. The <tt class="verbatim">random</tt> function can also take two <tt
      class="verbatim">integer</tt> arguments, in which case it returns an <tt class="verbatim">integer</tt>
      value.
    </p>
    <table align="center" id="math-operations">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><table style="display: inline; vertical-align: -9.9em">
          <tbody><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid; border-top: 1px solid"><strong>Form</strong></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-top: 1px solid"><strong>Description</strong></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><table style="display: inline; vertical-align: -0.55em">
              <tbody><tr>
                <td><tt class="verbatim">sqrt x</tt></td>
              </tr></tbody>
            </table></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Square root</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">sin x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Sine</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">cos x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Cosine</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">tan x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Tangent</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">asin x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Arc-sine</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">acos x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Arc-cosine</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">atan x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Arc-tangent</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">atan(y,x)</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Coordinates arc-tangent (<tt class="verbatim">atan2</tt> in
            C)</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">exp x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Exponential</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">expm1 x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Exponential minus one</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">log x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Natural logarithm</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">log2 x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Base 2 logarithm</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">log10 x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Base 10 logarithm</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">log1p x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Log of one plus x</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">pi</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Numerical constant &pi;</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">random</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">A random value between 0 and 1</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">random x,y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">A random value between <tt class="verbatim">x</tt> and <tt class="verbatim">y</tt></td>
          </tr></tbody>
        </table></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Table 6. </b><a id="auto-449"></a>Mathematical operations
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h4 id="auto-450">4.1.6<span style="margin-left: 1em"></span>Text functions</h4>
    <p>
      <a id="auto-451"></a>Text functions operate on <tt class="verbatim">text</tt> values.
    </p>
    <table align="center" id="text-operations">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><table style="display: inline; vertical-align: -3.3em">
          <tbody><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid; border-top: 1px solid"><strong>Form</strong></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-top: 1px solid"><strong>Description</strong></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><table style="display: inline; vertical-align: -0.55em">
              <tbody><tr>
                <td><tt class="verbatim">x&amp;y</tt></td>
              </tr></tbody>
            </table></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Concatenation</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">text_length x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Length of the text</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">text_range t, start, len</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Range of characters in <tt class="verbatim">t</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">t[n]</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Character at index <tt class="verbatim">n</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">t[n1..n2]</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Characters in range <tt class="verbatim">n1..n2</tt></td>
          </tr></tbody>
        </table></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Table 7. </b><a id="auto-452"></a>Text operations
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      The first character in a text is numbered <tt class="verbatim">0</tt>.
    </p>
    <h4 id="auto-453">4.1.7<span style="margin-left: 1em"></span>Conversions</h4>
    <p>
      <a id="auto-454"></a><a id="auto-455"></a>Conversions operations transform data from one
      type to another.
    </p>
    <table align="center" id="conversions">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><table style="display: inline; vertical-align: -4.95em">
          <tbody><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid; border-top: 1px solid"><strong>Form</strong></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-top: 1px solid"><strong>Description</strong></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><table style="display: inline; vertical-align: -0.55em">
              <tbody><tr>
                <td><tt class="verbatim">real x:integer</tt></td>
              </tr></tbody>
            </table></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Convert integer to real</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">real x:text</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Convert text to real</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">integer x:real</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Convert real to integer</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">integer x:text</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Convert text to real</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">text x:integer</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Convert integer to text</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">text x:real</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Convert real to text</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">text n:name</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Convert name to text</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">name t:text</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Convert text to name</td>
          </tr></tbody>
        </table></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Table 8. </b><a id="auto-456"></a>Conversions
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      <a id="auto-457"></a><a id="auto-458"></a>A conversion from text that fails returns the
      value <tt class="verbatim">0</tt>. Conversions to text always use the format used
      for XLR source code, using dot as a decimal separator: <tt class="verbatim">text
      0.0</tt> is <tt class="verbatim">&quot;0.0&quot;</tt>.
    </p>
    <h4 id="auto-459">4.1.8<span style="margin-left: 1em"></span>Date and time</h4>
    <p>
      <a id="auto-460"></a>Date and time functions manipulates time. Time is expressed
      with an integer representing a number of seconds since a time origin.
      Except for <tt class="verbatim">system_time</tt> which never takes an argument,
      the functions can either take an explicit time represented as an <tt
      class="verbatim">integer</tt> as returned by <tt class="verbatim">system_time</tt>, or apply
      to the current time in the current time zone.
    </p>
    <table align="center" id="time-operations">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><table style="display: inline; vertical-align: -5.5em">
          <tbody><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid; border-top: 1px solid"><strong>Form</strong></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-top: 1px solid"><strong>Description</strong></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><table style="display: inline; vertical-align: -0.55em">
              <tbody><tr>
                <td><tt class="verbatim">hours</tt></td>
              </tr></tbody>
            </table></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Hours</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">minutes</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Minutes</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">seconds</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Seconds</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">year</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Year</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">month</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Month</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">day</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Day of the month</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">week_day</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Day of the week</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">year_day</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Day of the year</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">system_time</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Current time in seconds</td>
          </tr></tbody>
        </table></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Table 9. </b><a id="auto-461"></a>Date and time
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h4 id="auto-462"><a id="tree-operations"></a>4.1.9<span style="margin-left: 1em"></span>Tree operations</h4>
    <p>
      <a id="auto-463"></a>Tree operations allow direct manipulation of abstract syntax
      trees<a id="auto-464"></a>.
    </p>
    <table align="center" id="tree-operations-table">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><table style="display: inline; vertical-align: -4.95em">
          <tbody><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid; border-top: 1px solid"><strong>Form</strong></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-top: 1px solid"><strong>Description</strong></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><table style="display: inline; vertical-align: -0.55em">
              <tbody><tr>
                <td><tt class="verbatim">identity x</tt></td>
              </tr></tbody>
            </table></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Returns <tt class="verbatim">x</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">do x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Forces explicit evaluation of <tt class="verbatim">x</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x.y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Evaluate <tt class="verbatim">y</tt> in context of <tt class="verbatim">x</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">self</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">The input form in a rewrite implementation</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">left X</tt>, <tt class="verbatim">right X</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Left and right child for infix, prefix, postfix</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">child X</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Child of a block</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">symbol X</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Symbol for an infix or name as text</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">opening X</tt>, <tt class="verbatim">closing
            X</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Opening and closing of text or blocks</td>
          </tr></tbody>
        </table></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Table 10. </b><a id="auto-465"></a>Tree operations
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      The prefix <tt class="verbatim">left</tt><a id="auto-466"></a>, <tt class="verbatim">right<a id="auto-467"></a></tt>,
      <tt class="verbatim">child</tt><a id="auto-468"></a>, <tt class="verbatim">symbol</tt><a id="auto-469"></a>, <tt
      class="verbatim">opening</tt><a id="auto-470"></a> and <tt class="verbatim">closing</tt><a id="auto-471"></a>
      can be assigned to, as described in Section <a href="#assignment">3.1.4</a>.
    </p>
    <h4 id="auto-472"><a id="list-operations"></a>4.1.10<span style="margin-left: 1em"></span>List operations, map, reduce
    and filter</h4>
    <p>
      <a id="auto-473"></a><a id="auto-474"></a>By convention, XLR lists use comma-separated
      lists<a id="auto-475"></a>, such as <tt class="verbatim">1,3,5,6</tt>, although similar
      operations can be built with any other data structure. The map, reduce
      and filter operations act on such lists. They also can take a range <tt
      class="verbatim">Low..High</tt> as input. An empty list is represented by the name
      <tt class="verbatim">nil</tt>. Basic list operations are shown in Table <a href="#list-operations-table">11</a>:
    </p>
    <table align="center" id="list-operations-table">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><table style="display: inline; vertical-align: -6.6em">
          <tbody><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid; border-top: 1px solid"><strong>Form</strong></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-top: 1px solid"><strong>Description</strong></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><table style="display: inline; vertical-align: -0.55em">
              <tbody><tr>
                <td><tt class="verbatim">nil</tt></td>
              </tr></tbody>
            </table></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">The empty list</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">head,tail</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">A data form for lists</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">length L</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">The length of list <tt class="verbatim">L</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">map F L</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Map function <tt class="verbatim">F</tt> to list <tt class="verbatim">L</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">reduce F L</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Combine list elements in a single value</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">filter F L</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Filter elements of a list</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x with y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Convenience notation for Map, Reduce or Filter</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">x..y</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Create a range of elements between <tt class="verbatim">x</tt>
            and <tt class="verbatim">y</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">head L</tt> or <tt class="verbatim">L.head</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Head of the list</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">tail L</tt> or <tt class="verbatim">L.tail</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Tail of the list (all but first element)</td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">L1 &amp; L2</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">Concatenation of lists</td>
          </tr></tbody>
        </table></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Table 11. </b><a id="auto-476"></a>List operations
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      The <em>map</em><a id="auto-477"></a> operation builds a list by applying the
      first argument as a prefix to each element of the list in turn. For
      example, <tt class="verbatim">map foo (1,3,5)</tt> returns the list <tt class="verbatim">foo
      1, foo 3, foo 5</tt>. Map can be used with anonymous functions: <tt
      class="verbatim">map (x-&gt;x+1) (2,4,6)</tt> returns <tt class="verbatim">(2+1,4+1,6+1)</tt>.
    </p>
    <p>
      The <em>reduce</em><a id="auto-478"></a> operation, sometimes called <em>fold</em>
      or <em>accumulate</em> in other functional languages, combines elements
      of the list two by two using a binary operation, and returns a single
      result. For example, <tt class="verbatim">reduce (x,y-&gt;x+y) (1,3,5)</tt>
      returns <tt class="verbatim">1+3+5</tt>.
    </p>
    <p>
      The <em>filter</em><a id="auto-479"></a> operation takes a predicate<a id="auto-480"></a>
      (i.e. a function taking a single argument and returning a <tt class="verbatim">boolean</tt>)
      and a list, and returns elements of the list for which the predicate
      returns <tt class="verbatim">true</tt>. For example, <tt class="verbatim">filter
      (x-&gt;x&lt;10) (1,12,17,2)</tt> returns <tt class="verbatim">(1,2)</tt>.
    </p>
    <p>
      The notation <tt class="verbatim">(X where Predicate X) with L</tt> corresponds to
      a filter operation on list <tt class="verbatim">L</tt> with predicate <tt class="verbatim">Predicate</tt>.
      For example, <tt class="verbatim">(X where X&lt;10) with (1,12,17,2)</tt> returns
      <tt class="verbatim">(1,2)</tt>.
    </p>
    <p>
      The notation <tt class="verbatim">(X,Y -&gt; ...) with L</tt> corresponds to a
      reduce operation on list <tt class="verbatim">L</tt>. For example, <tt class="verbatim">(X,Y
      -&gt; X+Y) with (2,4,6)</tt> returns <tt class="verbatim">(2+1,4+1,6+1)</tt>.
    </p>
    <p>
      For other forms of <tt class="verbatim">F</tt>, the notation <tt class="verbatim">F with
      L</tt> corresponds to a map operation on list <tt class="verbatim">L</tt>. For
      example, <tt class="verbatim">sin with (1,3,5)</tt> returns <tt class="verbatim">sin 1, sin
      3, sin 5</tt>.
    </p>
    <p>
      The notation <tt class="verbatim">x..y</tt> is called a <em>range</em><a id="auto-481"></a>.
      A range of integer, real numbers or text can be used as a type. A range
      of integers can also be used as a lazy enumeration of all elements as a
      comma-separated list. In other words, <tt class="verbatim">1..5</tt> is a
      short-hand notation for <tt class="verbatim">1,2,3,4,5</tt>.
    </p>
    <h3 id="auto-482">4.2<span style="margin-left: 1em"></span>Control structures</h3>
    <p>
      Control structures such as tests and loops are implemented in the XLR
      standard library.
    </p>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">17</class>. </b>The control structures
      described below are not necessarily all implemented at all optimization
      levels. Future implementations will add new control structures as soon
      as the compiler becomes smart enough to generate correct code for the
      definitions given in this section.
    </p>
    <h4 id="auto-483">4.2.1<span style="margin-left: 1em"></span>Tests</h4>
    <p>
      The definition of the if-then-else statement in the library is as shown
      in Figure <a href="#if-then-else-definition">59</a><a id="auto-484"></a>:
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
// Declaration of if-then-else
if true then TrueClause else FalseClause   -&gt; TrueClause
if false then TrueClause else FalseClause  -&gt; FalseClause</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 59. </b><a id="auto-485"></a>Library definition of if-then-else
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      <a id="if-then-else-definition"></a>This definition requires the value to be a <tt class="verbatim">boolean</tt>,
      i.e. <tt class="verbatim">true</tt> or <tt class="verbatim">false</tt>. The <tt class="verbatim">good</tt><a
      id="auto-486"></a>  function shown in Figure <a href="#good-function">60</a> provides a behaviour
      closer to what is seen in languages such as C, where the value <tt
      class="verbatim">0</tt> is logically false and non-zero values are logically true.
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
good false -&gt; false
good 0     -&gt; false
good 0.0   -&gt; false
good &quot;&quot;    -&gt; false
good nil   -&gt; false
good Other -&gt; true</pre><p>
          
        </p></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 60. </b><a id="auto-487"></a>The <tt class="verbatim">good</tt> function
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      <a id="good-function"></a>It is possible to add declarations of <tt class="verbatim">good</tt>
      for other data types. Such local declarations will precede the
      declarations for <tt class="verbatim">good</tt> in scoping order, so that they
      override that &ldquo;default&rdquo; implementation of <tt class="verbatim">good</tt>
      shown above.
    </p>
    <h4 id="auto-488">4.2.2<span style="margin-left: 1em"></span>Infinite Loops</h4>
    <p>
      The XLR standard library provides a number of loop constructs. Figure
      <a href="#infinite-loop">4.2.3</a> shows an implementation for the simplest form of
      loop, the infinite loop. The repeated evaluation of <tt class="verbatim">Body</tt>
      illustrates the importance of explicit evaluation (see Section <a href="#explicit-evaluation">3.3.4</a>).
      Note that such a recursive implementation is only efficient if tail
      recursion optimization works correctly (see Section <a href="#tail-recursion">6.12</a>).
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
loop Body -&gt;
    Body
    loop Body</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 61. </b><a id="auto-489"></a>Infinite loop
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h4 id="auto-490">4.2.3<span style="margin-left: 1em"></span>Conditional Loops (<tt class="verbatim">while</tt>
    and <tt class="verbatim">until</tt> loops)</h4>
    <p>
      <a id="infinite-loop"></a>Figure <a href="#while-loop">62</a> shows an implementation for the <tt
      class="verbatim">while</tt> loop, which runs while a given condition is true.
      Explicit evaluation is not required for <tt class="verbatim">Condition</tt>
      because it is evaluated only once in the implementation of the <tt
      class="verbatim">while</tt> loop, preventing memoization of <tt class="verbatim">Condition</tt>
      (see Section <a href="#lazy-evaluation">3.3.3</a>). The parameter <tt class="verbatim">Condition</tt>
      is not given a <tt class="verbatim">boolean</tt> type because we want the
      expression, not the result of evaluating that expression.
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
while Condition loop Body -&gt;
    if Condition then
        Body
        while Condition loop Body</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 62. </b><a id="auto-491"></a>While loop
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      <a id="while-loop"></a>The <tt class="verbatim">until</tt> loop shown in Figure <a href="#until-loop">4.2.4</a>
      is very similar to the <tt class="verbatim">while</tt> loop except that it stops
      when the condition becomes <tt class="verbatim">true</tt> instead of <tt class="verbatim">false</tt>.
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
until Condition loop Body -&gt;
    if not Condition then
        Body
        until Condition loop Body</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 63. </b><a id="auto-492"></a>Until loop
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h4 id="auto-493">4.2.4<span style="margin-left: 1em"></span>Controlled Loops (<tt class="verbatim">for</tt>
    loops)</h4>
    <p>
      <a id="until-loop"></a>The <tt class="verbatim">for</tt> loop is the most complex kind of
      loop. It exists in multiple variants. The simplest one, shown in Figure
      <a href="#for-loop-integer-range">64</a>, iterates over a range of <tt class="verbatim">integer</tt>
      values. Notice that it creates a local <tt class="verbatim">Index</tt> variable to
      ensure it doesn't modify <tt class="verbatim">Variable</tt> unless the loop is
      actually executed.
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
for Variable in Low:integer..High:integer loop Body -&gt;
    Index : integer := Low
    while Index &lt; High loop
        Variable := Index
        Body
        Index := Index + 1</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 64. </b><a id="auto-494"></a>For loop on an integer range
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      <a id="for-loop-integer-range"></a>The <tt class="verbatim">for</tt> loop shown in Figure <a href="#for-loop-container">65</a>
      iterates on all elements of a container such as a list or a range. It
      updates its <tt class="verbatim">Variable</tt> for each iteration with a new
      element in the container.
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
for Variable in Container loop Body -&gt;
    C : tree := Container    
    while good C loop
        Variable := head C
        Body
        C := tail C</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 65. </b><a id="auto-495"></a>For loop on a container
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      <a id="for-loop-container"></a>There are several other kinds of <tt class="verbatim">for</tt> loops,
      corresponding to the patterns shown in Figure <a href="#other-for-loops">66</a>:
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
for Variable in Low:integer..High:integer step Step:integer
for Variable in Low:real..High:real
for Variable in Low:real..High:real step Step:real</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 66. </b><a id="auto-496"></a>Other kinds of <tt class="verbatim">for</tt>
            loop
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      <a id="other-for-loops"></a>It is not difficult to create custom for loops to explore
      other data structures.
    </p>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">18</class>. </b>The standard mode implements
      hard-coded <tt class="verbatim">for</tt> loops. The optimized mode is not
      currently powerful enough to handle <tt class="verbatim">for</tt> loop definitions
      properly.
    </p>
    <h4 id="auto-497">4.2.5<span style="margin-left: 1em"></span>Excursions<strong></strong></h4>
    <p>
      
    </p>
    <h4 id="auto-498">4.2.6<span style="margin-left: 1em"></span>Error handling</h4>
    <p>
      
    </p>
    <h3 id="auto-499">4.3<span style="margin-left: 1em"></span>Library-defined types</h3>
    <p>
      A variety of types are defined in the library.
    </p>
    <h4 id="auto-500">4.3.1<span style="margin-left: 1em"></span>Range and range types</h4>
    <p>
      The notation <tt class="verbatim">low..high</tt> defines a <em>range</em>. A range
      can be used as a list by list operations, as explained in Section <a
      href="#list-operations">4.1.10</a>, but also as a type. The range type <tt class="verbatim">low..high</tt>
      accepts all values between <tt class="verbatim">low</tt> and <tt class="verbatim">high</tt>
      included. It is defined in a way substantially equivalent to Figure <a
      href="#range-type-definition">67</a>:
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
low..high -&gt;
    contains X -&gt; X&gt;=low and X&lt;=high
    self</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 67. </b><a id="auto-501"></a>Range and range type definition
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      <a id="range-type-definition"></a>Arithmetic operations are also defined on ranges of <tt
      class="verbatim">integer</tt> and <tt class="verbatim">real</tt> numbers, and operate
      simultaneously on the <tt class="verbatim">low</tt> and <tt class="verbatim">high</tt> part
      of the range. When <tt class="verbatim">low</tt> and <tt class="verbatim">high</tt> are <tt
      class="verbatim">real</tt>, operations are performed with different rounding for
      <tt class="verbatim">low</tt> and <tt class="verbatim">high</tt>, so as to implement proper
      interval arithmetic<a id="auto-502"></a>.
    </p>
    <p>
      Ranges of <tt class="verbatim">integer</tt> can also be interpreted as lists, with
      <tt class="verbatim">head</tt> and <tt class="verbatim">tail</tt> operations implemented in
      a way substantially similar to Figure <a href="#ranges-as-lists">68</a>. Lazy evaluation
      ensures that very large ranges can be processed efficiently (see Section
      <a href="#infinite-data-structures">5.7.7</a>).
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
head low:integer..high:integer -&gt; if low &lt;= high then low else nil
tail low:integer..high:integer -&gt; if low &lt;  high then low+1..high else nil</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 68. </b><a id="auto-503"></a>Ranges as lists
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      <a id="ranges-as-lists"></a>A test is required to deal with the corner case of empty
      lists.
    </p>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">19</class>. </b>The <tt class="verbatim">range</tt> type
      is not currently implemented, pending improvements in the type system.
    </p>
    <h4 id="auto-504">4.3.2<span style="margin-left: 1em"></span>Union types</h4>
    <p>
      The notation <tt class="verbatim">A|B</tt> in types is a <em>union type</em> for
      <tt class="verbatim">A</tt> and <tt class="verbatim">B</tt>, i.e. a type that can accept any
      element of types <tt class="verbatim">A</tt> or <tt class="verbatim">B</tt>. It is
      pre-defined in the standard library as in Figure <a href="#union-type-definition">69</a>:
    </p>
    <table align="center" id="union-type-definition">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
A|B -&gt;
    contains X:A -&gt; true
    contains X:B -&gt; true
    contains X -&gt; false</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 69. </b><a id="auto-505"></a>Union type definition
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      Union types facilitate the definition of functions that work correctly
      on a multiplicity of data types, but not necessarily all of them, as
      shown in Figure <a href="#using-union-types">70</a>:
    </p>
    <table align="center" id="using-union-types">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
number                -&gt; type X:(integer|real)
succ X:number         -&gt; X + 1
pred X:(integer|real) -&gt; X-1</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 70. </b><a id="auto-506"></a>Using union types
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">20</class>. </b>Union types are not implemented
      yet, pending improvements in the type system.
    </p>
    <h4 id="auto-507">4.3.3<span style="margin-left: 1em"></span>Enumeration types</h4>
    <p>
      An <em>enumeration type</em> accepts names in a predefined set. The
      notation <tt class="verbatim">enumeration(A, B, C)</tt> corresponds to an
      enumeration accepting the names <tt class="verbatim">A</tt>, <tt class="verbatim">B</tt>,
      <tt class="verbatim">C</tt>... This notation is pre-defined in the standard
      library as in Figure <a href="#enum-type-definition">71</a>:
    </p>
    <table align="center" id="enum-type-definition">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
enumeration(A:name,Rest) -&gt;
    contains X:name -&gt; text X = text A or enumeration(Rest) contains X
    contains X -&gt; false</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 71. </b><a id="auto-508"></a>Enumeration type definition
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      Unlike in other languages, enumeration types are not distinct from one
      another and can overlap. For example, the name <tt class="verbatim">do</tt>
      belongs to <tt class="verbatim">enumeration(do,undo,redo)</tt> as well as to <tt
      class="verbatim">enumeration(do,re,mi,fa,sol,la,si)</tt>. Also, as this
      enumeration example demonstrates, enumerations can use names such as <tt
      class="verbatim">do</tt> that are also used by standard prefix functions.
    </p>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">21</class>. </b>Enumeration types are not
      implemented yet.
    </p>
    <h4 id="auto-509">4.3.4<span style="margin-left: 1em"></span>A type matching type declarations</h4>
    <p>
      Type declarations in a type definition are used to declare actual types,
      so a type that matches type declarations cannot be defined by a simple
      pattern. Figure <a href="#type-declaration-type">72</a> shows how the standard library defines a
      <tt class="verbatim">type_declaration</tt> type using a type check.
    </p>
    <table align="center" id="type-declaration-type">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
type type_declaration -&gt;
   contains X:infix -&gt; X.name = &quot;:&quot;
   contains X -&gt; false</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 72. </b><a id="auto-510"></a>Type matching a type declaration
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">22</class>. </b>This definition of <tt class="verbatim">type_declaration</tt>
      does not work yet, pending improvements in the type system
      implementation.
    </p>
    <h3 id="auto-511">4.4<span style="margin-left: 1em"></span>Modules</h3>
    <p>
      XLR modules make it possible to decompose a large XLR program in smaller
      units.
    </p>
    <h4 id="auto-512"><a id="import-statement"></a>4.4.1<span style="margin-left: 1em"></span>Import statement</h4>
    <p>
      The <tt class="verbatim">import</tt> prefix imports a source file or a module<a
      id="auto-513"></a><a id="auto-514"></a><a id="auto-515"></a>, as shown in Figure <a href="#import-statement-example">73</a>:
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
import &quot;file.xl&quot;
import MyModule
import OtherModule 1.2
import MOD = LongMessage 1.3</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 73. </b><a id="auto-516"></a>Import statements examples
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      <a id="import-statement-example"></a>An import statement can be followed by a file name or a
      module specification:
    </p>
    <ul>
      <li>
        A file name provides a system-dependent file name for an XLR source
        file. By convention, XLR source file names end in <tt class="verbatim">.xl</tt>.
        In order to improve compatibility between systems, backslash
        characters <tt class="verbatim">\</tt> in file names are converted to slash
        characters <tt class="verbatim">/</tt> on Unix systems, and slash characters in
        file names are converted to backslash on Windows. Drive specifications
        such as <tt class="verbatim">C:</tt> are not converted.
      </li>
      <li>
        A module can also be identified by a name, optionally followed by a
        real number representing a minimum required version number. Modules
        source files are located in a set of directories defined by a
        <em>module path</em><a id="auto-517"></a>, and contain special module
        declarations specifying the module import name and the version number.
      </li>
      <li>
        Finally, the module being imported can locally be given a short name<a
        id="auto-518"></a><a id="auto-519"></a> with the syntax <tt class="verbatim">import M=ModSpec</tt>.
        In that case, the contents of the module is only visible using the
        index notation with either the short name <tt class="verbatim">M</tt> or the
        long module name.
      </li>
    </ul>
    <p>
      Importing a module or file has the following effects:
    </p>
    <ol>
      <li>
        Any <tt class="verbatim">syntax</tt> statement<a id="auto-520"></a> in the imported module
        applies to the source code importing it.
      </li>
      <li>
        A scope<a id="auto-521"></a> is created and populated with all declarations in
        the module.
      </li>
      <li>
        Except if a short name is given, that scope is placed immediately to
        the right of the current context. In other words, it potentially
        shadows previously imported modules, but also is potentially
        shadowed<a id="auto-522"></a> by declarations in the current file.
      </li>
      <li>
        If the module is identified by a name and not a file name, a binding<a
        id="auto-523"></a> of that module name to the newly created module scope, and
        another binding to the short name in case one was provided.
      </li>
    </ol>
    <p style="margin-top: 1em; margin-bottom: 1em">
      <b>Warning <class style="font-style: normal">23</class>. </b>In the current implementation,
      the <tt class="verbatim">import</tt> statement does not make the syntax visible
      yet.
    </p>
    <p>
      The rationale for these rules is to make different usage scenarios
      equally convenient:
    </p>
    <ul>
      <li>
        If declarations in a module are going to be used extensively, using
        <tt class="verbatim">import Module</tt> makes all declarations visible by
        default.
      </li>
      <li>
        If a local declaration <tt class="verbatim">Foo</tt> hides a declaration of <tt
        class="verbatim">Foo</tt> in the module, it is still possible to refer to the
        module's declaration as <tt class="verbatim">Module.Foo</tt>.
      </li>
      <li>
        If it is undesirable to see declarations from the module, using <tt
        class="verbatim">import M=Module</tt> will prevent the module from becoming
        visible, but will make it convenient to refer to entities declared in
        the module using the short name, as in <tt class="verbatim">M.Foo</tt>.
      </li>
    </ul>
    <h4 id="auto-524">4.4.2<span style="margin-left: 1em"></span>Declaring a module</h4>
    <p>
      A module is identified by a module description<a id="auto-525"></a><a id="auto-526"></a>
      similar to Figure <a href="#module-definition">74</a>:
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
module_description
    id &quot;B1E18CF6-0E3E-4992-98AD-0FD998C9C9CB&quot;
    name &quot;My Incredible Module&quot;
    description &quot;This is an example of module&quot;
    import_name &quot;MyModule&quot;
    author &quot;John Doe&quot;
    website &quot;http://www.taodyne.com&quot;
    url &quot;git://git.taodyne.com/MyModule&quot;
    dependencies BaseLibrary 1.1, XLR 0.9
    version 1.0</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 74. </b><a id="auto-527"></a>Module definition
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      <a id="module-definition"></a>The module description contains information allowing the XLR
      compiler to identify the modules. Only the <tt class="verbatim">import_name</tt>
      is required for that purpose. It is however considered good practice to
      provide the rest of the information, which can be used by various
      applications to provide meaningful information to the user, or useful
      utilities such as module dependency management.
    </p>
    <h2 id="auto-528">5<span style="margin-left: 1em"></span>Example code</h2>
    <h3 id="auto-529">5.1<span style="margin-left: 1em"></span>Minimum and maximum</h3>
    <p>
      The minimum and maximum can be defined as follows:
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
min x, y -&gt; m:tree := min y; if m &lt; x then m else x
min x    -&gt; x
max x, y -&gt; m:tree := max y; if m &gt; x then m else x
max x    -&gt; x</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 75. </b><a id="auto-530"></a>Computing a minimum and a maximum
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      The functions as defined will work with any number of arguments, as well
      as with lists of items.
    </p>
    <h3 id="auto-531">5.2<span style="margin-left: 1em"></span>Complex numbers</h3>
    <p>
      
    </p>
    <h3 id="auto-532">5.3<span style="margin-left: 1em"></span>Vector and Matrix computations</h3>
    <h3 id="auto-533">5.4<span style="margin-left: 1em"></span>Linked lists with dynamic allocation</h3>
    <p>
      
    </p>
    <h3 id="auto-534">5.5<span style="margin-left: 1em"></span>Input / Output</h3>
    <p>
      
    </p>
    <h3 id="auto-535"><a id="object-oriented-programming"></a>5.6<span style="margin-left: 1em"></span>Object-Oriented Programming</h3>
    <h4 id="auto-536">5.6.1<span style="margin-left: 1em"></span>Classes</h4>
    <h4 id="auto-537">5.6.2<span style="margin-left: 1em"></span>Methods</h4>
    <h4 id="auto-538">5.6.3<span style="margin-left: 1em"></span>Dynamic dispatch</h4>
    <h4 id="auto-539">5.6.4<span style="margin-left: 1em"></span>Polymorphism</h4>
    <h4 id="auto-540">5.6.5<span style="margin-left: 1em"></span>Inheritance</h4>
    <h4 id="auto-541">5.6.6<span style="margin-left: 1em"></span>Multi-methods</h4>
    <h4 id="auto-542">5.6.7<span style="margin-left: 1em"></span>Object prototypes</h4>
    <h3 id="auto-543">5.7<span style="margin-left: 1em"></span>Functional-Programming</h3>
    <h4 id="auto-544">5.7.1<span style="margin-left: 1em"></span>Map</h4>
    <h4 id="auto-545">5.7.2<span style="margin-left: 1em"></span>Reduce</h4>
    <h4 id="auto-546">5.7.3<span style="margin-left: 1em"></span>Filter</h4>
    <h4 id="auto-547">5.7.4<span style="margin-left: 1em"></span>Functions as first-class objects</h4>
    <h4 id="auto-548">5.7.5<span style="margin-left: 1em"></span>Anonymous functions (Lambda)</h4>
    <p>
      <b><h4 id="auto-549">5.7.6<span style="margin-left: 1em"></span>Y-Combinator</h4></b>
    </p>
    <h4 id="auto-550"><a id="infinite-data-structures"></a>5.7.7<span style="margin-left: 1em"></span>Infinite data structures</h4>
    <p>
      Since arguments are evaluated lazily, the evaluation of one fragment of
      the form does not imply the evaluation of any other. This makes it
      possible to correctly evaluate infinite data structures, as illustrated
      in Figure <a href="#infinite-list">76</a>.
    </p>
    <table align="center" id="infinite-list">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
integers_above N:integer -&gt; N, integers_above N+1
head X,Y -&gt; X
tail X,Y -&gt; Y

// This computes 7 without evaluating integers_above 8
head tail tail tail integers_above 4</pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 76. </b><a id="auto-551"></a>Lazy evaluation of an infinite list
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <h2 id="auto-552"><a id="implementation-notes"></a>6<span style="margin-left: 1em"></span>Implementation notes</h2>
    <p>
      This section describes the implementation as published at <tt class="verbatim">http://xlr.sourceforge.net</tt>.
    </p>
    <h3 id="auto-553">6.1<span style="margin-left: 1em"></span>Lazy evaluation</h3>
    <h3 id="auto-554">6.2<span style="margin-left: 1em"></span>Type inference</h3>
    <h3 id="auto-555">6.3<span style="margin-left: 1em"></span>Built-in operations</h3>
    <h3 id="auto-556">6.4<span style="margin-left: 1em"></span>Controlled compilation</h3>
    <p>
      A special form, <tt class="verbatim">compile</tt>, is used to tell the compiler
      how to compile its argument. This makes it possible to implement special
      optimization for often-used forms.
    </p>
    <table align="center">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><pre class="verbatim" xml:space="preserve">
compile {if Condition then TrueForm else FalseForm} -&gt;
    generate_if_then_else Condition, TrueForm, FalseForm     </pre></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 77. </b><a id="auto-557"></a>Controlled compilation
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      Controlled compilation depends on low-level compilation primitives
      provided by the LLVM infrastructure
      <p>
        <font size="-1"><div align="justify">
          <div style="margin-left: 0px">
            <div style="margin-right: 0px">
              <p>
                . For details, refer to <tt class="verbatim">http://llvm.org</tt>.
              </p>
            </div>
          </div>
        </div></font>
      </p>
      <span style="margin-left: 0em"></span>
      <a id="footnr-12"></a>
      <sup><a href="#footnote-12">12</a></sup>
      , and assumes a good understanding of LLVM basic operations. Table
      <a href="#llvm-operations">12</a>
      shows the correspondance between LLVM primitives and primitives that
      can be used during controlled compilation.
    </p>
    <table align="center" id="llvm-operations">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><table style="display: inline; vertical-align: -4.95em">
          <tbody><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid; border-top: 1px solid"><strong>XLR Form</strong></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-top: 1px solid"><strong>LLVM Entity</strong></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-top: 1px solid"><strong>Description</strong></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><table style="display: inline; vertical-align: -0.55em">
              <tbody><tr>
                <td><tt class="verbatim">llvm_value x</tt></td>
              </tr></tbody>
            </table></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"><tt class="verbatim">Value *</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">The machine value associated to tree <tt class="verbatim">x</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">llvm_type x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"><tt class="verbatim">Type *</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">The type associated to tree <tt class="verbatim">x</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">llvm_struct x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"><tt class="verbatim">StructType *</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">The structure type for signature <tt class="verbatim">x</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">llvm_function_type x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"><tt class="verbatim">FunctionType *</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">The function type for signature <tt class="verbatim">x</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">llvm_function x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"><tt class="verbatim">Function *</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">The machine function associated to <tt class="verbatim">x</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">llvm_global x</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"><tt class="verbatim">GlobalValue *</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">The global value identifying tree <tt class="verbatim">x</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">llvm_bb n</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"><tt class="verbatim">BasicBlock *</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center">A basic block with name <tt class="verbatim">n</tt></td>
          </tr><tr>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center; border-left: 1px solid"><tt class="verbatim">llvm_type</tt></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"></td>
            <td style="border-right: 1px solid; border-bottom: 1px solid; text-align: center"></td>
          </tr></tbody>
        </table></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Table 12. </b><a id="auto-558"></a>LLVM operations
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      
    </p>
    <h3 id="auto-559">6.5<span style="margin-left: 1em"></span>Tree representation</h3>
    <p>
      The tree representation is performed by the <tt class="verbatim">Tree</tt> class,
      with one subclass per node type: <tt class="verbatim">Integer</tt>, <tt class="verbatim">Real</tt>,
      <tt class="verbatim">Text</tt>, <tt class="verbatim">Name</tt>, <tt class="verbatim">Infix</tt>, <tt
      class="verbatim">Prefix</tt>, <tt class="verbatim">Postfix</tt> and <tt class="verbatim">Block</tt>.
    </p>
    <p>
      The <tt class="verbatim">Tree</tt> structure has template members <tt class="verbatim">GetInfo</tt>
      and <tt class="verbatim">SetInfo</tt> that make it possible to associate arbitrary
      data to a tree. Data is stored there using a class deriving from <tt
      class="verbatim">Info</tt>.
    </p>
    <p>
      The rule of thumb is that <tt class="verbatim">Tree</tt> only contains members for
      data that is used in the evaluation of any tree. Other data is stored
      using <tt class="verbatim">Info</tt> entries.
    </p>
    <p>
      Currently, data that is directly associated to the <tt class="verbatim">Tree</tt>
      includes:
    </p>
    <ul>
      <li>
        The <tt class="verbatim">tag</tt> field stores the kind of the tree as well as
        its position in the source code.
      </li>
      <li>
        The <tt class="verbatim">info</tt> field is a linked list of <tt class="verbatim">Info</tt>
        entries.
      </li>
    </ul>
    <h3 id="auto-560">6.6<span style="margin-left: 1em"></span>Evaluation of trees</h3>
    <p>
      Trees are evaluated in a given <em>context</em>, representing the
      evaluation environment. The context contains a lexical (static) and
      stack (dynamic) part.
    </p>
    <ol>
      <li>
        The <em>lexical context</em> represents the declarations that precede
        the tree being evaluated in the source code. It can be determined
        statically.
      </li>
      <li>
        The <em>dynamic context</em> represents the declarations that were
        introduced as part of earlier evaluation, i.e. in the &ldquo;call
        stack&rdquo;.
      </li>
    </ol>
    <p>
      A context is represented by a tree holding the declarations, along with
      associated code.
    </p>
    <h3 id="auto-561">6.7<span style="margin-left: 1em"></span>Tree position</h3>
    <p>
      The position held in the <tt class="verbatim">tag</tt> field is character-precise.
      To save space, it counts the number of characters since the beginning of
      compilation in a single integer value.
    </p>
    <p>
      The <tt class="verbatim">Positions</tt> class defined in <tt class="verbatim">scanner.h</tt>
      maps this count to the more practical file-line-column positioning. This
      process is relatively slow, but this is acceptable when emitting error
      messages.
    </p>
    <h3 id="auto-562">6.8<span style="margin-left: 1em"></span>Actions on trees</h3>
    <p>
      Recursive operations on tree are performed by the <tt class="verbatim">Action</tt>
      class. This class implements virtual functions for each tree type called
      <tt class="verbatim">DoInteger</tt>, <tt class="verbatim">DoReal</tt>, <tt class="verbatim">DoText</tt>
      and so on.
    </p>
    <h3 id="auto-563">6.9<span style="margin-left: 1em"></span>Symbols</h3>
    <p>
      The XL runtime environment maintains symbol tables which form a
      hierarchy. Each symbol table has a (possibly <tt class="verbatim">NULL</tt>)
      parent, and contains two kinds of symbols: names and rewrites.
    </p>
    <ul>
      <li>
        Names are associated directly with a tree value. For example, <tt
        class="verbatim">X-&gt;0</tt> will associate the value <tt class="verbatim">0</tt> to name
        <tt class="verbatim">X</tt>.
      </li>
      <li>
        Rewrites are used for more complex tree rewrites, e.g. <tt class="verbatim">X+Y-&gt;add
        X,Y</tt>.
      </li>
    </ul>
    <h3 id="auto-564">6.10<span style="margin-left: 1em"></span>Evaluating trees</h3>
    <p>
      A tree is evaluated as follows:
    </p>
    <ol>
      <li>
        Evaluation of a tree is performed by <tt class="verbatim">xl_evaluate()</tt> in
        <tt class="verbatim">runtime.cpp</tt>.
      </li>
      <li>
        This function checks the stack depth to report infinite recursion.
      </li>
      <li>
        If <tt class="verbatim">code</tt> is <tt class="verbatim">NULL</tt>, then the tree is
        compiled first.
      </li>
      <li>
        Then, evaluation is performed by calling <tt class="verbatim">code</tt> with the
        tree as argument.
      </li>
    </ol>
    <p>
      The signature for <tt class="verbatim">code</tt> is a function taking a <tt class="verbatim">Tree</tt>
      pointer and returning a <tt class="verbatim">Tree</tt> pointer.
    </p>
    <h3 id="auto-565">6.11<span style="margin-left: 1em"></span>Code generation for trees</h3>
    <p>
      Evaluation functions are functions with the signature shown in Figure <a
      href="#rewrite-code">78</a>:
    </p>
    <table align="center" id="rewrite-code">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><tt class="verbatim">Tree * (*eval_fn) (eval_fn eval, Tree
        *self)</tt></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 78. </b><a id="auto-566"></a>Signature for rewrite code with two
            variables.
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      Unfortunately, the signature in Figure <a href="#rewrite-code">78</a> is not valid in C
      or C++, so we need a lot of casting to achieve the desired effect.
    </p>
    <p>
      
    </p>
    <p>
      In general, the <tt class="verbatim">code</tt> for a tree takes the tree as input,
      and returns the evaluated value.
    </p>
    <p>
      However, there are a few important exceptions to this rule:
    </p>
    <h4 id="auto-567">6.11.1<span style="margin-left: 1em"></span>Right side of a rewrite</h4>
    <p>
      If the tree is on the right of a rewrite (i.e. the right of an infix <tt
      class="verbatim">-&gt;</tt> operator), then <tt class="verbatim">code</tt> will take
      additional input trees as arguments. Specifically, there will be one
      additional parameter in the code per variable in the rewrite rule
      pattern.
    </p>
    <p>
      For example, if a rewrite is <tt class="verbatim">X+Y-&gt;foo X,Y</tt>, then the
      <tt class="verbatim">code</tt> field for <tt class="verbatim">foo X,Y</tt> will have <tt
      class="verbatim">X</tt> as its second argument and <tt class="verbatim">Y</tt> as its third
      argument, as shown in Figure <a href="#rewrite-code">78</a>.
    </p>
    <p>
      
    </p>
    <p>
      
    </p>
    <p>
      In that case, the input tree for the actual expression being rewritten
      remains passed as the first argument, generally denoted as <tt class="verbatim">self</tt>.
    </p>
    <h4 id="auto-568">6.11.2<span style="margin-left: 1em"></span>Closures</h4>
    <p>
      If a tree is passed as a <tt class="verbatim">tree</tt> argument to a function,
      then it is encapsulated in a <em>closure</em>. The intent is to capture
      the environment that the passed tree depends on. Therefore, the
      associated <tt class="verbatim">code</tt> will take additional arguments
      representing all the captured values. For instance, a closure for <tt
      class="verbatim">write X,Y</tt> that captures variables <tt class="verbatim">X</tt> and <tt
      class="verbatim">Y</tt> will have the signature shown in Figure <a href="#closure-code">79</a>:
    </p>
    <table align="center" id="closure-code">
      <tbody><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em"><tt class="verbatim">Tree * (*code) (Tree *self, Tree *X, Tree
        *Y)</tt></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: left; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 79. </b><a id="auto-569"></a>Signature for rewrite code with two
            variables.
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      At runtime, the closure is represented by a prefix tree with the
      original tree on the left, and the captured values cascading on the
      right. For consistency, the captured values are always on the left of a
      <tt class="verbatim">Prefix</tt> tree. The rightmost child of the rightmost <tt
      class="verbatim">Prefix</tt> is set to an arbitrary, unused value (specifically,
      <tt class="verbatim">false</tt>).
    </p>
    <p>
      Closures are built by the function <tt class="verbatim">xl_new_closure</tt>, which
      is generally invoked from generated code. Their <tt class="verbatim">code</tt>
      field is set to a function that reads all the arguments from the tree
      and invokes the code with the additional arguments.
    </p>
    <p>
      For example, <tt class="verbatim">do</tt> takes a <tt class="verbatim">tree</tt> argument.
      When evaluating <tt class="verbatim">do write X,Y</tt>, the tree given as an
      argument to <tt class="verbatim">do</tt> depends on variable <tt class="verbatim">X</tt> and
      <tt class="verbatim">Y</tt>, which may not be visible in the body of <tt class="verbatim">do</tt>.
      These variables are therefore captured in the closure. If its values of
      <tt class="verbatim">X</tt> and <tt class="verbatim">Y</tt> are <tt class="verbatim">42</tt> and <tt
      class="verbatim">Universe</tt>, then <tt class="verbatim">do</tt> receives a closure for <tt
      class="verbatim">write X,Y</tt> with arguments <tt class="verbatim">42</tt> and <tt class="verbatim">Universe</tt>.
    </p>
    <p>
      
    </p>
    <h3 id="auto-570"><a id="tail-recursion"></a>6.12<span style="margin-left: 1em"></span>Tail recursion</h3>
    <h3 id="auto-571">6.13<span style="margin-left: 1em"></span>Partial recompilation</h3>
    <h3 id="auto-572"><a id="machine-interface"></a>6.14<span style="margin-left: 1em"></span>Machine Interface</h3>
    <h3 id="auto-573"><a id="machine-types"></a>6.15<span style="margin-left: 1em"></span>Machine Types and Normal
    Types</h3>
    <p>
      
    </p>
    <h2>Table of contents</h2>
    <div style="text-indent: 0em">
      <div class="compact-block">
        <p style="margin-top: 1em; margin-bottom: 0.5em">
          <b>1<span style="margin-left: 1em"></span>Introduction</b> <span style="margin-left: 5mm"></span> <a
          href="#auto-1">1</a>
        </p>
        <div style="margin-left: 24px">
          <p>
            1.1<span style="margin-left: 1em"></span>Design objectives <span style="margin-left: 5mm"></span> <a
            href="#auto-2">1</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            1.2<span style="margin-left: 1em"></span>Keeping it simple <span style="margin-left: 5mm"></span> <a
            href="#auto-6">1</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            1.3<span style="margin-left: 1em"></span>Examples <span style="margin-left: 5mm"></span> <a href="#auto-19">2</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            1.4<span style="margin-left: 1em"></span>Concept programming <span style="margin-left: 5mm"></span> <a
            href="#auto-30">3</a>
          </p>
        </div>
        <div style="margin-left: 96px">
          <p>
            From concept to code: a lossy conversion <span style="margin-left: 5mm"></span> <a
            href="#auto-34">3</a>
          </p>
        </div>
        <div style="margin-left: 96px">
          <p>
            Pseudo-metrics <span style="margin-left: 5mm"></span> <a href="#auto-35">3</a>
          </p>
        </div>
        <div style="margin-left: 96px">
          <p>
            Influence on XLR <span style="margin-left: 5mm"></span> <a href="#auto-44">3</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            1.5<span style="margin-left: 1em"></span>State of the implementation <span style="margin-left: 5mm"></span>
            <a href="#auto-45">3</a>
          </p>
        </div>
        <p style="margin-top: 1em; margin-bottom: 0.5em">
          <b>2<span style="margin-left: 1em"></span>Syntax</b> <span style="margin-left: 5mm"></span> <a href="#auto-46">4</a>
        </p>
        <div style="margin-left: 24px">
          <p>
            2.1<span style="margin-left: 1em"></span>Spaces and indentation <span style="margin-left: 5mm"></span>
            <a href="#auto-52">4</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            2.2<span style="margin-left: 1em"></span>Comments and spaces <span style="margin-left: 5mm"></span> <a
            href="#auto-58">4</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            2.3<span style="margin-left: 1em"></span>Literals <span style="margin-left: 5mm"></span> <a href="#auto-61">5</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            2.3.1<span style="margin-left: 1em"></span>Integer constants <span style="margin-left: 5mm"></span> <a
            href="#auto-63">5</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            2.3.2<span style="margin-left: 1em"></span>Real constants <span style="margin-left: 5mm"></span> <a
            href="#auto-69">5</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            2.3.3<span style="margin-left: 1em"></span>Text literals <span style="margin-left: 5mm"></span> <a
            href="#auto-75">6</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            2.3.4<span style="margin-left: 1em"></span>Name and operator symbols<a id="auto-90"></a>
            <span style="margin-left: 5mm"></span> <a href="#auto-90">40</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            2.4<span style="margin-left: 1em"></span>Structured nodes <span style="margin-left: 5mm"></span> <a
            href="#auto-96">7</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            2.4.1<span style="margin-left: 1em"></span>Infix nodes <span style="margin-left: 5mm"></span> <a href="#auto-103">7</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            2.4.2<span style="margin-left: 1em"></span>Prefix and postfix nodes <span style="margin-left: 5mm"></span>
            <a href="#auto-105">7</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            2.4.3<span style="margin-left: 1em"></span>Block nodes <span style="margin-left: 5mm"></span> <a href="#auto-112">7</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            2.5<span style="margin-left: 1em"></span>Parsing rules <span style="margin-left: 5mm"></span> <a href="#auto-115">8</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            2.5.1<span style="margin-left: 1em"></span>Precedence <span style="margin-left: 5mm"></span> <a href="#auto-121">8</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            2.5.2<span style="margin-left: 1em"></span>Associativity <span style="margin-left: 5mm"></span> <a
            href="#auto-125">8</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            2.5.3<span style="margin-left: 1em"></span>Infix versus Prefix versus Postfix <span
            style="margin-left: 5mm"></span> <a href="#auto-127">8</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            2.5.4<span style="margin-left: 1em"></span>Expression versus statement <span style="margin-left: 5mm"></span>
            <a href="#auto-134">9</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            2.6<span style="margin-left: 1em"></span>Syntax configuration <span style="margin-left: 5mm"></span>
            <a href="#auto-141">9</a>
          </p>
        </div>
        <div style="margin-left: 96px">
          <p>
            Format of syntax configuration <span style="margin-left: 5mm"></span> <a href="#auto-151">11</a>
          </p>
        </div>
        <p style="margin-top: 1em; margin-bottom: 0.5em">
          <b>3<span style="margin-left: 1em"></span>Language semantics</b> <span style="margin-left: 5mm"></span>
          <a href="#auto-163">12</a>
        </p>
        <div style="margin-left: 24px">
          <p>
            3.1<span style="margin-left: 1em"></span>Tree rewrite operators <span style="margin-left: 5mm"></span>
            <a href="#auto-167">12</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.1.1<span style="margin-left: 1em"></span>Rewrite declarations <span style="margin-left: 5mm"></span>
            <a href="#auto-189">13</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.1.2<span style="margin-left: 1em"></span>Data declaration <span style="margin-left: 5mm"></span> <a
            href="#auto-205">14</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.1.3<span style="margin-left: 1em"></span>Type declaration <span style="margin-left: 5mm"></span> <a
            href="#auto-212">15</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.1.4<span style="margin-left: 1em"></span>Assignment <span style="margin-left: 5mm"></span> <a href="#auto-220">15</a>
          </p>
        </div>
        <div style="margin-left: 96px">
          <p>
            Local variables <span style="margin-left: 5mm"></span> <a href="#auto-227">15</a>
          </p>
        </div>
        <div style="margin-left: 96px">
          <p>
            Assigning to references <span style="margin-left: 5mm"></span> <a href="#auto-236">16</a>
          </p>
        </div>
        <div style="margin-left: 96px">
          <p>
            Assigning to parameters <span style="margin-left: 5mm"></span> <a href="#auto-239">16</a>
          </p>
        </div>
        <div style="margin-left: 96px">
          <p>
            Assignments as expressions <span style="margin-left: 5mm"></span> <a href="#auto-242">16</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.1.5<span style="margin-left: 1em"></span>Guards <span style="margin-left: 5mm"></span> <a href="#auto-245">16</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.1.6<span style="margin-left: 1em"></span>Sequences <span style="margin-left: 5mm"></span> <a href="#auto-249">17</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.1.7<span style="margin-left: 1em"></span>Index operators <span style="margin-left: 5mm"></span> <a
            href="#auto-256">17</a>
          </p>
        </div>
        <div style="margin-left: 96px">
          <p>
            Comparison with C <span style="margin-left: 5mm"></span> <a href="#auto-265">17</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.1.8<span style="margin-left: 1em"></span>C interface <span style="margin-left: 5mm"></span> <a href="#auto-267">18</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.1.9<span style="margin-left: 1em"></span>Machine Interface <span style="margin-left: 5mm"></span> <a
            href="#auto-275">18</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            3.2<span style="margin-left: 1em"></span>Binding References to Values <span style="margin-left: 5mm"></span>
            <a href="#auto-279">18</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.2.1<span style="margin-left: 1em"></span>Context Order <span style="margin-left: 5mm"></span> <a
            href="#auto-282">18</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.2.2<span style="margin-left: 1em"></span>Scoping <span style="margin-left: 5mm"></span> <a href="#auto-285">19</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.2.3<span style="margin-left: 1em"></span>Current context <span style="margin-left: 5mm"></span> <a
            href="#auto-293">19</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.2.4<span style="margin-left: 1em"></span>References <span style="margin-left: 5mm"></span> <a href="#auto-298">19</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            3.3<span style="margin-left: 1em"></span>Evaluation <span style="margin-left: 5mm"></span> <a href="#auto-301">19</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.3.1<span style="margin-left: 1em"></span>Standard evaluation <span style="margin-left: 5mm"></span>
            <a href="#auto-303">19</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.3.2<span style="margin-left: 1em"></span>Special forms <span style="margin-left: 5mm"></span> <a
            href="#auto-314">21</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.3.3<span style="margin-left: 1em"></span>Lazy evaluation <span style="margin-left: 5mm"></span> <a
            href="#auto-317">21</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.3.4<span style="margin-left: 1em"></span>Explicit evaluation <span style="margin-left: 5mm"></span>
            <a href="#auto-323">22</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.3.5<span style="margin-left: 1em"></span>Memoization <span style="margin-left: 5mm"></span> <a href="#auto-326">22</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            3.4<span style="margin-left: 1em"></span>Types <span style="margin-left: 5mm"></span> <a href="#auto-331">23</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.4.1<span style="margin-left: 1em"></span>Predefined types <span style="margin-left: 5mm"></span> <a
            href="#auto-336">23</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.4.2<span style="margin-left: 1em"></span>Type definition <span style="margin-left: 5mm"></span> <a
            href="#auto-351">23</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.4.3<span style="margin-left: 1em"></span>Normal form for a type <span style="margin-left: 5mm"></span>
            <a href="#auto-369">24</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.4.4<span style="margin-left: 1em"></span>Properties <span style="margin-left: 5mm"></span> <a href="#auto-376">25</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.4.5<span style="margin-left: 1em"></span>Data inheritance <span style="margin-left: 5mm"></span> <a
            href="#auto-397">26</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.4.6<span style="margin-left: 1em"></span>Explicit type check <span style="margin-left: 5mm"></span>
            <a href="#auto-402">26</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.4.7<span style="margin-left: 1em"></span>Explicit and automatic type conversions
            <span style="margin-left: 5mm"></span> <a href="#auto-412">26</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.4.8<span style="margin-left: 1em"></span>Parameterized types <span style="margin-left: 5mm"></span>
            <a href="#auto-418">27</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            3.4.9<span style="margin-left: 1em"></span>Rewrite types <span style="margin-left: 5mm"></span> <a
            href="#auto-423">27</a>
          </p>
        </div>
        <p style="margin-top: 1em; margin-bottom: 0.5em">
          <b>4<span style="margin-left: 1em"></span>Standard XL library</b> <span style="margin-left: 5mm"></span>
          <a href="#auto-427">27</a>
        </p>
        <div style="margin-left: 24px">
          <p>
            4.1<span style="margin-left: 1em"></span>Built-in operations <span style="margin-left: 5mm"></span> <a
            href="#auto-429">27</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.1.1<span style="margin-left: 1em"></span>Arithmetic <span style="margin-left: 5mm"></span> <a href="#auto-433">27</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.1.2<span style="margin-left: 1em"></span>Comparison <span style="margin-left: 5mm"></span> <a href="#auto-437">28</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.1.3<span style="margin-left: 1em"></span>Bitwise arithmetic <span style="margin-left: 5mm"></span>
            <a href="#auto-440">28</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.1.4<span style="margin-left: 1em"></span>Boolean operations <span style="margin-left: 5mm"></span>
            <a href="#auto-444">28</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.1.5<span style="margin-left: 1em"></span>Mathematical functions <span style="margin-left: 5mm"></span>
            <a href="#auto-447">28</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.1.6<span style="margin-left: 1em"></span>Text functions <span style="margin-left: 5mm"></span> <a
            href="#auto-450">29</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.1.7<span style="margin-left: 1em"></span>Conversions <span style="margin-left: 5mm"></span> <a href="#auto-453">29</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.1.8<span style="margin-left: 1em"></span>Date and time <span style="margin-left: 5mm"></span> <a
            href="#auto-459">29</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.1.9<span style="margin-left: 1em"></span>Tree operations <span style="margin-left: 5mm"></span> <a
            href="#auto-462">30</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.1.10<span style="margin-left: 1em"></span>List operations, map, reduce and filter
            <span style="margin-left: 5mm"></span> <a href="#auto-472">30</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            4.2<span style="margin-left: 1em"></span>Control structures <span style="margin-left: 5mm"></span> <a
            href="#auto-482">31</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.2.1<span style="margin-left: 1em"></span>Tests <span style="margin-left: 5mm"></span> <a href="#auto-483">31</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.2.2<span style="margin-left: 1em"></span>Infinite Loops <span style="margin-left: 5mm"></span> <a
            href="#auto-488">31</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.2.3<span style="margin-left: 1em"></span>Conditional Loops (<tt>while</tt> and
            <tt>until</tt> loops) <span style="margin-left: 5mm"></span> <a href="#auto-490">32</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.2.4<span style="margin-left: 1em"></span>Controlled Loops (<tt>for</tt> loops)
            <span style="margin-left: 5mm"></span> <a href="#auto-493">32</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.2.5<span style="margin-left: 1em"></span>Excursions<b></b> <span style="margin-left: 5mm"></span> <a
            href="#auto-497">33</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.2.6<span style="margin-left: 1em"></span>Error handling <span style="margin-left: 5mm"></span> <a
            href="#auto-498">33</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            4.3<span style="margin-left: 1em"></span>Library-defined types <span style="margin-left: 5mm"></span>
            <a href="#auto-499">33</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.3.1<span style="margin-left: 1em"></span>Range and range types <span style="margin-left: 5mm"></span>
            <a href="#auto-500">33</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.3.2<span style="margin-left: 1em"></span>Union types <span style="margin-left: 5mm"></span> <a href="#auto-504">33</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.3.3<span style="margin-left: 1em"></span>Enumeration types <span style="margin-left: 5mm"></span> <a
            href="#auto-507">34</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.3.4<span style="margin-left: 1em"></span>A type matching type declarations <span
            style="margin-left: 5mm"></span> <a href="#auto-509">34</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            4.4<span style="margin-left: 1em"></span>Modules <span style="margin-left: 5mm"></span> <a href="#auto-511">34</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.4.1<span style="margin-left: 1em"></span>Import statement <span style="margin-left: 5mm"></span> <a
            href="#auto-512">34</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            4.4.2<span style="margin-left: 1em"></span>Declaring a module <span style="margin-left: 5mm"></span>
            <a href="#auto-524">35</a>
          </p>
        </div>
        <p style="margin-top: 1em; margin-bottom: 0.5em">
          <b>5<span style="margin-left: 1em"></span>Example code</b> <span style="margin-left: 5mm"></span> <a
          href="#auto-528">35</a>
        </p>
        <div style="margin-left: 24px">
          <p>
            5.1<span style="margin-left: 1em"></span>Minimum and maximum <span style="margin-left: 5mm"></span> <a
            href="#auto-529">35</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            5.2<span style="margin-left: 1em"></span>Complex numbers <span style="margin-left: 5mm"></span> <a
            href="#auto-530">36</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            5.3<span style="margin-left: 1em"></span>Vector and Matrix computations <span style="margin-left: 5mm"></span>
            <a href="#auto-531">36</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            5.4<span style="margin-left: 1em"></span>Linked lists with dynamic allocation <span
            style="margin-left: 5mm"></span> <a href="#auto-532">36</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            5.5<span style="margin-left: 1em"></span>Input / Output <span style="margin-left: 5mm"></span> <a
            href="#auto-533">36</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            5.6<span style="margin-left: 1em"></span>Object-Oriented Programming <span style="margin-left: 5mm"></span>
            <a href="#auto-534">36</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            5.6.1<span style="margin-left: 1em"></span>Classes <span style="margin-left: 5mm"></span> <a href="#auto-535">36</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            5.6.2<span style="margin-left: 1em"></span>Methods <span style="margin-left: 5mm"></span> <a href="#auto-536">36</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            5.6.3<span style="margin-left: 1em"></span>Dynamic dispatch <span style="margin-left: 5mm"></span> <a
            href="#auto-537">36</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            5.6.4<span style="margin-left: 1em"></span>Polymorphism <span style="margin-left: 5mm"></span> <a
            href="#auto-538">36</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            5.6.5<span style="margin-left: 1em"></span>Inheritance <span style="margin-left: 5mm"></span> <a href="#auto-539">36</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            5.6.6<span style="margin-left: 1em"></span>Multi-methods <span style="margin-left: 5mm"></span> <a
            href="#auto-540">36</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            5.6.7<span style="margin-left: 1em"></span>Object prototypes <span style="margin-left: 5mm"></span> <a
            href="#auto-541">36</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            5.7<span style="margin-left: 1em"></span>Functional-Programming <span style="margin-left: 5mm"></span>
            <a href="#auto-542">36</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            5.7.1<span style="margin-left: 1em"></span>Map <span style="margin-left: 5mm"></span> <a href="#auto-543">36</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            5.7.2<span style="margin-left: 1em"></span>Reduce <span style="margin-left: 5mm"></span> <a href="#auto-544">36</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            5.7.3<span style="margin-left: 1em"></span>Filter <span style="margin-left: 5mm"></span> <a href="#auto-545">36</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            5.7.4<span style="margin-left: 1em"></span>Functions as first-class objects <span
            style="margin-left: 5mm"></span> <a href="#auto-546">36</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            5.7.5<span style="margin-left: 1em"></span>Anonymous functions (Lambda) <span style="margin-left: 5mm"></span>
            <a href="#auto-547">36</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            5.7.6<span style="margin-left: 1em"></span>Y-Combinator <span style="margin-left: 5mm"></span> <a
            href="#auto-548">36</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            5.7.7<span style="margin-left: 1em"></span>Infinite data structures <span style="margin-left: 5mm"></span>
            <a href="#auto-549">36</a>
          </p>
        </div>
        <p style="margin-top: 1em; margin-bottom: 0.5em">
          <b>6<span style="margin-left: 1em"></span>Implementation notes</b> <span style="margin-left: 5mm"></span>
          <a href="#auto-551">37</a>
        </p>
        <div style="margin-left: 24px">
          <p>
            6.1<span style="margin-left: 1em"></span>Lazy evaluation <span style="margin-left: 5mm"></span> <a
            href="#auto-552">37</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            6.2<span style="margin-left: 1em"></span>Type inference <span style="margin-left: 5mm"></span> <a
            href="#auto-553">37</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            6.3<span style="margin-left: 1em"></span>Built-in operations <span style="margin-left: 5mm"></span> <a
            href="#auto-554">37</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            6.4<span style="margin-left: 1em"></span>Controlled compilation <span style="margin-left: 5mm"></span>
            <a href="#auto-555">37</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            6.5<span style="margin-left: 1em"></span>Tree representation <span style="margin-left: 5mm"></span> <a
            href="#auto-558">37</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            6.6<span style="margin-left: 1em"></span>Evaluation of trees <span style="margin-left: 5mm"></span> <a
            href="#auto-559">37</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            6.7<span style="margin-left: 1em"></span>Tree position <span style="margin-left: 5mm"></span> <a href="#auto-560">38</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            6.8<span style="margin-left: 1em"></span>Actions on trees <span style="margin-left: 5mm"></span> <a
            href="#auto-561">38</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            6.9<span style="margin-left: 1em"></span>Symbols <span style="margin-left: 5mm"></span> <a href="#auto-562">38</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            6.10<span style="margin-left: 1em"></span>Evaluating trees <span style="margin-left: 5mm"></span> <a
            href="#auto-563">38</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            6.11<span style="margin-left: 1em"></span>Code generation for trees <span style="margin-left: 5mm"></span>
            <a href="#auto-564">38</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            6.11.1<span style="margin-left: 1em"></span>Right side of a rewrite <span style="margin-left: 5mm"></span>
            <a href="#auto-566">38</a>
          </p>
        </div>
        <div style="margin-left: 48px">
          <p>
            6.11.2<span style="margin-left: 1em"></span>Closures <span style="margin-left: 5mm"></span> <a href="#auto-567">39</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            6.12<span style="margin-left: 1em"></span>Tail recursion <span style="margin-left: 5mm"></span> <a
            href="#auto-569">39</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            6.13<span style="margin-left: 1em"></span>Partial recompilation <span style="margin-left: 5mm"></span>
            <a href="#auto-570">39</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            6.14<span style="margin-left: 1em"></span>Machine Interface <span style="margin-left: 5mm"></span> <a
            href="#auto-571">39</a>
          </p>
        </div>
        <div style="margin-left: 24px">
          <p>
            6.15<span style="margin-left: 1em"></span>Machine Types and Normal Types <span
            style="margin-left: 5mm"></span> <a href="#auto-572">39</a>
          </p>
        </div>
        <p style="margin-top: 1em; margin-bottom: 0.5em">
          <b>Index</b> <span style="margin-left: 5mm"></span> <a href="#auto-90">40</a>
        </p>
        <p style="margin-top: 1em; margin-bottom: 0.5em">
          <b>List of figures</b> <span style="margin-left: 5mm"></span> <a href="#auto-91">43</a>
        </p>
        <p style="margin-top: 1em; margin-bottom: 0.5em">
          <b>List of tables</b> <span style="margin-left: 5mm"></span> <a href="#auto-92">46</a>
        </p>
      </div>
    </div>
    <h2 id="auto-91">Index</h2>
    <p>
      <p>
        
      </p>
      <div style="text-indent: 0em">
        <div class="compact-block">
          <font size="-1"><multicol cols="2"><p>
            := <span style="margin-left: 5mm"></span> <a href="#auto-222">15</a>
          </p><p>
            abstract syntax tree <span style="margin-left: 5mm"></span> <a href="#auto-15">2</a>, <a href="#auto-47">4</a>
          </p><p>
            anonymous function <span style="margin-left: 5mm"></span> <a href="#auto-201">14</a>
          </p><p>
            argument <span style="margin-left: 5mm"></span> <a href="#auto-200">14</a>
          </p><p>
            arithmetic <span style="margin-left: 5mm"></span> <a href="#auto-434">27</a>
          </p><div style="margin-left: 24px">
            <p>
              bitwise <span style="margin-left: 5mm"></span> <a href="#auto-442">28</a>
            </p>
          </div><p>
            array
          </p><div style="margin-left: 24px">
            <p>
              as function <span style="margin-left: 5mm"></span> <a href="#auto-266">17</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              index <span style="margin-left: 5mm"></span> <a href="#auto-259">17</a>
            </p>
          </div><p>
            array index <span style="margin-left: 5mm"></span> <a href="#auto-260">17</a>
          </p><p>
            art <span style="margin-left: 5mm"></span> <a href="#auto-41">3</a>
          </p><p>
            assignment <span style="margin-left: 5mm"></span> <a href="#auto-180">13</a>, <a href="#auto-221">15</a>,
            <a href="#auto-297">19</a>
          </p><div style="margin-left: 24px">
            <p>
              in expression <span style="margin-left: 5mm"></span> <a href="#auto-243">16</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              to parameter <span style="margin-left: 5mm"></span> <a href="#auto-240">16</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              to type declaration <span style="margin-left: 5mm"></span> <a href="#auto-219">15</a>, <a
              href="#auto-228">15</a>
            </p>
          </div><p>
            associativity <span style="margin-left: 5mm"></span> <a href="#auto-118">8</a>, <a href="#auto-126">8</a>
          </p><p>
            AST
          </p><div style="margin-left: 24px">
            <p>
              manipulations <span style="margin-left: 5mm"></span> <a href="#auto-464">30</a>
            </p>
          </div><p>
            AST (abstract syntax tree) <span style="margin-left: 5mm"></span> <a href="#auto-16">2</a>
          </p><p>
            automatic type conversion <span style="margin-left: 5mm"></span> <a href="#auto-401">26</a>, <a
            href="#auto-416">26</a>
          </p><p>
            bandwidth <span style="margin-left: 5mm"></span> <a href="#auto-39">3</a>
          </p><p>
            binding <span style="margin-left: 5mm"></span> <a href="#auto-181">13</a>, <a href="#auto-280">18</a>
          </p><div style="margin-left: 24px">
            <p>
              in assignment <span style="margin-left: 5mm"></span> <a href="#auto-224">15</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              local scope <span style="margin-left: 5mm"></span> <a href="#auto-230">15</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              of module names <span style="margin-left: 5mm"></span> <a href="#auto-523">35</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              parameters <span style="margin-left: 5mm"></span> <a href="#auto-310">20</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              with return type declaration <span style="margin-left: 5mm"></span> <a href="#auto-234">15</a>
            </p>
          </div><p>
            bindings
          </p><div style="margin-left: 24px">
            <p>
              in type definitions <span style="margin-left: 5mm"></span> <a href="#auto-365">24</a>
            </p>
          </div><p>
            bitwise arithmetic <span style="margin-left: 5mm"></span> <a href="#auto-441">28</a>
          </p><p>
            block <span style="margin-left: 5mm"></span> <a href="#auto-101">7</a>, <a href="#auto-113">7</a>, <a
            href="#auto-348">23</a>
          </p><p>
            block delimiters <span style="margin-left: 5mm"></span> <a href="#auto-114">7</a>, <a href="#auto-156">11</a>
          </p><p>
            block type <span style="margin-left: 5mm"></span> <a href="#auto-14">2</a>
          </p><p>
            boolean <span style="margin-left: 5mm"></span> <a href="#auto-350">23</a>, <a href="#auto-445">28</a>
          </p><p>
            built-in operations <span style="margin-left: 5mm"></span> <a href="#auto-430">27</a>
          </p><p>
            builtins.xl <span style="margin-left: 5mm"></span> <a href="#auto-432">27</a>
          </p><p>
            C interface <span style="margin-left: 5mm"></span> <a href="#auto-268">18</a>
          </p><p>
            C symbols <span style="margin-left: 5mm"></span> <a href="#auto-161">11</a>
          </p><p>
            catch-all rewrite <span style="margin-left: 5mm"></span> <a href="#auto-291">19</a>
          </p><p>
            child <span style="margin-left: 5mm"></span> <a href="#auto-468">30</a>
          </p><p>
            child node <span style="margin-left: 5mm"></span> <a href="#auto-102">7</a>
          </p><p>
            closing <span style="margin-left: 5mm"></span> <a href="#auto-471">30</a>
          </p><p>
            closure <span style="margin-left: 5mm"></span> <a href="#auto-312">21</a>
          </p><p>
            code space <span style="margin-left: 5mm"></span> <a href="#auto-33">3</a>
          </p><p>
            comments <span style="margin-left: 5mm"></span> <a href="#auto-59">4</a>
          </p><p>
            comparisons <span style="margin-left: 5mm"></span> <a href="#auto-438">28</a>
          </p><p>
            concept <span style="margin-left: 5mm"></span> <a href="#auto-31">3</a>
          </p><p>
            concept space <span style="margin-left: 5mm"></span> <a href="#auto-32">3</a>
          </p><p>
            constant <span style="margin-left: 5mm"></span> <a href="#auto-195">13</a>
          </p><p>
            constant symbols <span style="margin-left: 5mm"></span> <a href="#auto-198">14</a>
          </p><p>
            contains <span style="margin-left: 5mm"></span> <a href="#auto-407">26</a>
          </p><p>
            context <span style="margin-left: 5mm"></span> <a href="#auto-203">14</a>, <a href="#auto-281">18</a>
          </p><div style="margin-left: 24px">
            <p>
              current <span style="margin-left: 5mm"></span> <a href="#auto-295">19</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              enclosing <span style="margin-left: 5mm"></span> <a href="#auto-288">19</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              parameter context <span style="margin-left: 5mm"></span> <a href="#auto-313">21</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              passed with arguments <span style="margin-left: 5mm"></span> <a href="#auto-311">21</a>
            </p>
          </div><p>
            context order <span style="margin-left: 5mm"></span> <a href="#auto-283">18</a>, <a href="#auto-305">20</a>
          </p><p>
            control characters <span style="margin-left: 5mm"></span> <a href="#auto-79">6</a>
          </p><p>
            conversion
          </p><div style="margin-left: 24px">
            <p>
              from number to text <span style="margin-left: 5mm"></span> <a href="#auto-458">29</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              from text to number <span style="margin-left: 5mm"></span> <a href="#auto-457">29</a>
            </p>
          </div><p>
            conversions <span style="margin-left: 5mm"></span> <a href="#auto-454">29</a>
          </p><p>
            C.syntax <span style="margin-left: 5mm"></span> <a href="#auto-271">18</a>
          </p><div style="margin-left: 24px">
            <p>
              connexion to xl.syntax <span style="margin-left: 5mm"></span> <a href="#auto-273">18</a>
            </p>
          </div><p>
            C.syntax file <span style="margin-left: 5mm"></span> <a href="#auto-160">11</a>
          </p><p>
            current context <span style="margin-left: 5mm"></span> <a href="#auto-294">19</a>
          </p><p>
            data declaration <span style="margin-left: 5mm"></span> <a href="#auto-207">14</a>
          </p><p>
            data declarations <span style="margin-left: 5mm"></span> <a href="#auto-174">12</a>
          </p><p>
            data inheritance <span style="margin-left: 5mm"></span> <a href="#auto-399">26</a>
          </p><p>
            date and time <span style="margin-left: 5mm"></span> <a href="#auto-460">29</a>
          </p><p>
            declaration <span style="margin-left: 5mm"></span> <a href="#auto-254">17</a>
          </p><div style="margin-left: 24px">
            <p>
              of data <span style="margin-left: 5mm"></span> <a href="#auto-206">14</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              of rewrites <span style="margin-left: 5mm"></span> <a href="#auto-190">13</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              of types <span style="margin-left: 5mm"></span> <a href="#auto-213">15</a>
            </p>
          </div><p>
            default precedence <span style="margin-left: 5mm"></span> <a href="#auto-154">11</a>
          </p><p>
            default prefix (precedence) <span style="margin-left: 5mm"></span> <a href="#auto-131">9</a>
          </p><p>
            default value <span style="margin-left: 5mm"></span> <a href="#auto-385">25</a>
          </p><p>
            definition
          </p><div style="margin-left: 24px">
            <p>
              of properties <span style="margin-left: 5mm"></span> <a href="#auto-384">25</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              of types <span style="margin-left: 5mm"></span> <a href="#auto-354">23</a>
            </p>
          </div><p>
            domain-specific language <span style="margin-left: 5mm"></span> <a href="#auto-17">2</a>
          </p><p>
            dot
          </p><div style="margin-left: 24px">
            <p>
              as decimal separator <span style="margin-left: 5mm"></span> <a href="#auto-70">5</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              as index operator <span style="margin-left: 5mm"></span> <a href="#auto-258">17</a>
            </p>
          </div><p>
            double quote <span style="margin-left: 5mm"></span> <a href="#auto-83">6</a>
          </p><p>
            DSL (domain-specific language) <span style="margin-left: 5mm"></span> <a href="#auto-18">2</a>
          </p><p>
            evaluation <span style="margin-left: 5mm"></span> <a href="#auto-166">12</a>, <a href="#auto-302">19</a>
          </p><div style="margin-left: 24px">
            <p>
              data declaration arguments <span style="margin-left: 5mm"></span> <a href="#auto-209">14</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              demand-based <span style="margin-left: 5mm"></span> <a href="#auto-320">21</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              explicit <span style="margin-left: 5mm"></span> <a href="#auto-325">22</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              explicit vs. lazy <span style="margin-left: 5mm"></span> <a href="#auto-329">22</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              forcing explicit evaluation <span style="margin-left: 5mm"></span> <a href="#auto-330">23</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              in assignment <span style="margin-left: 5mm"></span> <a href="#auto-223">15</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              lazy <span style="margin-left: 5mm"></span> <a href="#auto-319">21</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              mismatch <span style="margin-left: 5mm"></span> <a href="#auto-309">20</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              of arguments <span style="margin-left: 5mm"></span> <a href="#auto-307">20</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              order <span style="margin-left: 5mm"></span> <a href="#auto-252">17</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              special forms <span style="margin-left: 5mm"></span> <a href="#auto-316">21</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              standard case <span style="margin-left: 5mm"></span> <a href="#auto-304">19</a>
            </p>
          </div><p>
            evaluation order <span style="margin-left: 5mm"></span> <a href="#auto-185">13</a>
          </p><p>
            execution (of programs) <span style="margin-left: 5mm"></span> <a href="#auto-165">12</a>
          </p><p>
            explicit evaluation <span style="margin-left: 5mm"></span> <a href="#auto-324">22</a>
          </p><p>
            explicit type check <span style="margin-left: 5mm"></span> <a href="#auto-403">26</a>
          </p><p>
            explicit type conversion <span style="margin-left: 5mm"></span> <a href="#auto-413">26</a>
          </p><p>
            exponent (for real constants) <span style="margin-left: 5mm"></span> <a href="#auto-73">5</a>
          </p><p>
            expression
          </p><div style="margin-left: 24px">
            <p>
              allowed on left of assignment <span style="margin-left: 5mm"></span> <a href="#auto-238">16</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              assignment as expression <span style="margin-left: 5mm"></span> <a href="#auto-244">16</a>
            </p>
          </div><p>
            expression (as opposed to statement) <span style="margin-left: 5mm"></span> <a href="#auto-138">9</a>
          </p><p>
            expression vs. statement <span style="margin-left: 5mm"></span> <a href="#auto-94">7</a>, <a
            href="#auto-120">8</a>, <a href="#auto-135">9</a>
          </p><p>
            Extensible language and runtime <span style="margin-left: 5mm"></span> <a href="#auto-4">1</a>
          </p><p>
            extern syntax <span style="margin-left: 5mm"></span> <a href="#auto-269">18</a>
          </p><p>
            external syntax file <span style="margin-left: 5mm"></span> <a href="#auto-159">11</a>
          </p><p>
            field index <span style="margin-left: 5mm"></span> <a href="#auto-262">17</a>
          </p><p>
            filter <span style="margin-left: 5mm"></span> <a href="#auto-25">2</a>
          </p><p>
            filter operation <span style="margin-left: 5mm"></span> <a href="#auto-479">31</a>
          </p><p>
            function <span style="margin-left: 5mm"></span> <a href="#auto-111">7</a>
          </p><p>
            function precedence <span style="margin-left: 5mm"></span> <a href="#auto-110">7</a>, <a href="#auto-132">9</a>,
            <a href="#auto-155">11</a>
          </p><p>
            functional programming <span style="margin-left: 5mm"></span> <a href="#auto-20">2</a>, <a
            href="#auto-26">2</a>
          </p><p>
            getter <span style="margin-left: 5mm"></span> <a href="#auto-391">25</a>
          </p><p>
            good (function) <span style="margin-left: 5mm"></span> <a href="#auto-486">31</a>
          </p><p>
            guard <span style="margin-left: 5mm"></span> <a href="#auto-246">16</a>
          </p><p>
            guard (in a rewrite declaration) <span style="margin-left: 5mm"></span> <a href="#auto-178">13</a>
          </p><p>
            hash sign (as a radix delimiter) <span style="margin-left: 5mm"></span> <a href="#auto-66">5</a>
          </p><p>
            if-then-else
          </p><div style="margin-left: 24px">
            <p>
              library definition <span style="margin-left: 5mm"></span> <a href="#auto-484">31</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              statement <span style="margin-left: 5mm"></span> <a href="#auto-28">2</a>, <a href="#auto-192">13</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              type <span style="margin-left: 5mm"></span> <a href="#auto-355">23</a>
            </p>
          </div><p>
            implementation <span style="margin-left: 5mm"></span> <a href="#auto-172">12</a>
          </p><p>
            import <span style="margin-left: 5mm"></span> <a href="#auto-514">34</a>
          </p><div style="margin-left: 24px">
            <p>
              with a short name <span style="margin-left: 5mm"></span> <a href="#auto-519">35</a>
            </p>
          </div><p>
            indentation <span style="margin-left: 5mm"></span> <a href="#auto-56">4</a>, <a href="#auto-152">11</a>,
            <a href="#auto-157">11</a>
          </p><p>
            indentation (in long text) <span style="margin-left: 5mm"></span> <a href="#auto-86">6</a>
          </p><p>
            index
          </p><div style="margin-left: 24px">
            <p>
              array <span style="margin-left: 5mm"></span> <a href="#auto-261">17</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              field <span style="margin-left: 5mm"></span> <a href="#auto-263">17</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              for user-defined types <span style="margin-left: 5mm"></span> <a href="#auto-366">24</a>
            </p>
          </div><p>
            index operator <span style="margin-left: 5mm"></span> <a href="#auto-187">13</a>, <a href="#auto-257">17</a>,
            <a href="#auto-300">19</a>
          </p><p>
            infix <span style="margin-left: 5mm"></span> <a href="#auto-98">7</a>, <a href="#auto-104">7</a>, <a
            href="#auto-345">23</a>
          </p><p>
            infix type <span style="margin-left: 5mm"></span> <a href="#auto-11">2</a>
          </p><p>
            infix vs. prefix vs. postfix <span style="margin-left: 5mm"></span> <a href="#auto-119">8</a>,
            <a href="#auto-128">8</a>
          </p><p>
            inherit <span style="margin-left: 5mm"></span> <a href="#auto-380">25</a>, <a href="#auto-398">26</a>
          </p><p>
            integer <span style="margin-left: 5mm"></span> <a href="#auto-339">23</a>
          </p><p>
            integer constant <span style="margin-left: 5mm"></span> <a href="#auto-64">5</a>
          </p><p>
            integer type <span style="margin-left: 5mm"></span> <a href="#auto-7">2</a>
          </p><p>
            interval arithmetic <span style="margin-left: 5mm"></span> <a href="#auto-502">33</a>
          </p><p>
            is_a <span style="margin-left: 5mm"></span> <a href="#auto-410">26</a>
          </p><p>
            lambda function <span style="margin-left: 5mm"></span> <a href="#auto-202">14</a>
          </p><p>
            lazy evaluation <span style="margin-left: 5mm"></span> <a href="#auto-318">21</a>
          </p><p>
            left <span style="margin-left: 5mm"></span> <a href="#auto-466">30</a>
          </p><p>
            library <span style="margin-left: 5mm"></span> <a href="#auto-428">27</a>
          </p><p>
            line-terminating characters <span style="margin-left: 5mm"></span> <a href="#auto-78">6</a>
          </p><p>
            list
          </p><div style="margin-left: 24px">
            <p>
              comma-separated <span style="margin-left: 5mm"></span> <a href="#auto-475">30</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              operations on lists <span style="margin-left: 5mm"></span> <a href="#auto-474">30</a>
            </p>
          </div><p>
            list operations <span style="margin-left: 5mm"></span> <a href="#auto-473">30</a>
          </p><p>
            literal node types <span style="margin-left: 5mm"></span> <a href="#auto-62">5</a>
          </p><p>
            local scope <span style="margin-left: 5mm"></span> <a href="#auto-231">15</a>
          </p><p>
            long text <span style="margin-left: 5mm"></span> <a href="#auto-84">6</a>
          </p><p>
            machine interface <span style="margin-left: 5mm"></span> <a href="#auto-276">18</a>
          </p><p>
            map <span style="margin-left: 5mm"></span> <a href="#auto-23">2</a>
          </p><p>
            map operation <span style="margin-left: 5mm"></span> <a href="#auto-477">30</a>
          </p><p>
            mathematical functions <span style="margin-left: 5mm"></span> <a href="#auto-448">28</a>
          </p><p>
            memoization
          </p><div style="margin-left: 24px">
            <p>
              of arguments <span style="margin-left: 5mm"></span> <a href="#auto-308">20</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              of parameters <span style="margin-left: 5mm"></span> <a href="#auto-327">22</a>
            </p>
          </div><p>
            meta-programming <span style="margin-left: 5mm"></span> <a href="#auto-21">2</a>
          </p><p>
            module <span style="margin-left: 5mm"></span> <a href="#auto-513">34</a>
          </p><div style="margin-left: 24px">
            <p>
              description <span style="margin-left: 5mm"></span> <a href="#auto-526">35</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              import <span style="margin-left: 5mm"></span> <a href="#auto-515">34</a>
            </p>
          </div><p>
            module description <span style="margin-left: 5mm"></span> <a href="#auto-525">35</a>
          </p><p>
            module path <span style="margin-left: 5mm"></span> <a href="#auto-517">34</a>
          </p><p>
            music <span style="margin-left: 5mm"></span> <a href="#auto-43">3</a>
          </p><p>
            name <span style="margin-left: 5mm"></span> <a href="#auto-92">46</a>, <a href="#auto-343">23</a>
          </p><p>
            name type <span style="margin-left: 5mm"></span> <a href="#auto-10">2</a>
          </p><p>
            noise <span style="margin-left: 5mm"></span> <a href="#auto-42">3</a>
          </p><p>
            normal form <span style="margin-left: 5mm"></span> <a href="#auto-370">24</a>
          </p><p>
            normal XLR <span style="margin-left: 5mm"></span> <a href="#auto-51">4</a>
          </p><p>
            off-side rule <span style="margin-left: 5mm"></span> <a href="#auto-53">4</a>
          </p><p>
            opcode <span style="margin-left: 5mm"></span> <a href="#auto-277">18</a>
          </p><p>
            opening <span style="margin-left: 5mm"></span> <a href="#auto-470">30</a>
          </p><p>
            operand (in prefix and postfix) <span style="margin-left: 5mm"></span> <a href="#auto-108">7</a>
          </p><p>
            operator <span style="margin-left: 5mm"></span> <a href="#auto-344">23</a>
          </p><p>
            operator symbols <span style="margin-left: 5mm"></span> <a href="#auto-93">48</a>
          </p><p>
            operators <span style="margin-left: 5mm"></span> <a href="#auto-144">9</a>
          </p><p>
            overloading <span style="margin-left: 5mm"></span> <a href="#auto-217">15</a>
          </p><p>
            parameter <span style="margin-left: 5mm"></span> <a href="#auto-199">14</a>
          </p><p>
            parameterized types <span style="margin-left: 5mm"></span> <a href="#auto-419">27</a>
          </p><p>
            parameters
          </p><div style="margin-left: 24px">
            <p>
              of types <span style="margin-left: 5mm"></span> <a href="#auto-364">24</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              with properties types <span style="margin-left: 5mm"></span> <a href="#auto-382">25</a>
            </p>
          </div><p>
            parsing <span style="margin-left: 5mm"></span> <a href="#auto-116">8</a>, <a href="#auto-129">8</a>
          </p><p>
            parsing ambiguities <span style="margin-left: 5mm"></span> <a href="#auto-130">8</a>, <a href="#auto-136">9</a>
          </p><p>
            pattern <span style="margin-left: 5mm"></span> <a href="#auto-171">12</a>, <a href="#auto-194">13</a>
          </p><div style="margin-left: 24px">
            <p>
              in type <span style="margin-left: 5mm"></span> <a href="#auto-359">23</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              making type pattern specific <span style="margin-left: 5mm"></span> <a href="#auto-372">24</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              matching <span style="margin-left: 5mm"></span> <a href="#auto-306">20</a>
            </p>
          </div><p>
            postfix <span style="margin-left: 5mm"></span> <a href="#auto-100">7</a>, <a href="#auto-107">7</a>, <a
            href="#auto-347">23</a>
          </p><p>
            postfix type <span style="margin-left: 5mm"></span> <a href="#auto-13">2</a>
          </p><p>
            power operator <span style="margin-left: 5mm"></span> <a href="#auto-435">27</a>
          </p><p>
            precedence <span style="margin-left: 5mm"></span> <a href="#auto-117">8</a>, <a href="#auto-122">8</a>, <a
            href="#auto-146">9</a>
          </p><p>
            predefined types <span style="margin-left: 5mm"></span> <a href="#auto-338">23</a>
          </p><p>
            predicate <span style="margin-left: 5mm"></span> <a href="#auto-480">31</a>
          </p><p>
            prefix <span style="margin-left: 5mm"></span> <a href="#auto-99">7</a>, <a href="#auto-106">7</a>, <a
            href="#auto-346">23</a>
          </p><p>
            prefix type <span style="margin-left: 5mm"></span> <a href="#auto-12">2</a>
          </p><p>
            programming paradigm <span style="margin-left: 5mm"></span> <a href="#auto-3">1</a>
          </p><p>
            properties <span style="margin-left: 5mm"></span> <a href="#auto-377">25</a>
          </p><div style="margin-left: 24px">
            <p>
              arguments <span style="margin-left: 5mm"></span> <a href="#auto-389">25</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              as parameter types <span style="margin-left: 5mm"></span> <a href="#auto-388">25</a>
            </p>
          </div><p>
            property <span style="margin-left: 5mm"></span> <a href="#auto-379">25</a>
          </p><div style="margin-left: 24px">
            <p>
              default value <span style="margin-left: 5mm"></span> <a href="#auto-386">25</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              required <span style="margin-left: 5mm"></span> <a href="#auto-395">25</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              setting <span style="margin-left: 5mm"></span> <a href="#auto-387">25</a>
            </p>
          </div><p>
            property definition <span style="margin-left: 5mm"></span> <a href="#auto-383">25</a>
          </p><p>
            pseudo-metric <span style="margin-left: 5mm"></span> <a href="#auto-36">3</a>
          </p><p>
            quote <span style="margin-left: 5mm"></span> <a href="#auto-81">6</a>
          </p><p>
            radix
          </p><div style="margin-left: 24px">
            <p>
              in integer numbers <span style="margin-left: 5mm"></span> <a href="#auto-65">5</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              in real numbers <span style="margin-left: 5mm"></span> <a href="#auto-71">5</a>
            </p>
          </div><p>
            range <span style="margin-left: 5mm"></span> <a href="#auto-481">31</a>
          </p><p>
            real <span style="margin-left: 5mm"></span> <a href="#auto-340">23</a>
          </p><p>
            real type <span style="margin-left: 5mm"></span> <a href="#auto-8">2</a>
          </p><p>
            reduce <span style="margin-left: 5mm"></span> <a href="#auto-24">2</a>
          </p><p>
            reduce operation <span style="margin-left: 5mm"></span> <a href="#auto-478">30</a>
          </p><p>
            reference <span style="margin-left: 5mm"></span> <a href="#auto-299">19</a>
          </p><p>
            required property <span style="margin-left: 5mm"></span> <a href="#auto-394">25</a>
          </p><p>
            return type declaration <span style="margin-left: 5mm"></span> <a href="#auto-215">15</a>
          </p><div style="margin-left: 24px">
            <p>
              in assignment <span style="margin-left: 5mm"></span> <a href="#auto-233">15</a>
            </p>
          </div><p>
            rewrite declaration <span style="margin-left: 5mm"></span> <a href="#auto-191">13</a>
          </p><p>
            rewrite declarations <span style="margin-left: 5mm"></span> <a href="#auto-170">12</a>
          </p><p>
            rewrite type <span style="margin-left: 5mm"></span> <a href="#auto-424">27</a>
          </p><p>
            right <span style="margin-left: 5mm"></span> <a href="#auto-467">30</a>
          </p><p>
            scope <span style="margin-left: 5mm"></span> <a href="#auto-286">19</a>
          </p><div style="margin-left: 24px">
            <p>
              creation <span style="margin-left: 5mm"></span> <a href="#auto-296">19</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              enclosing <span style="margin-left: 5mm"></span> <a href="#auto-289">19</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              for modules <span style="margin-left: 5mm"></span> <a href="#auto-521">35</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              global <span style="margin-left: 5mm"></span> <a href="#auto-290">19</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              local <span style="margin-left: 5mm"></span> <a href="#auto-232">15</a>, <a href="#auto-287">19</a>
            </p>
          </div><p>
            self <span style="margin-left: 5mm"></span> <a href="#auto-211">14</a>
          </p><p>
            semantic noise <span style="margin-left: 5mm"></span> <a href="#auto-38">3</a>
          </p><p>
            semantics <span style="margin-left: 5mm"></span> <a href="#auto-164">12</a>
          </p><p>
            sequence <span style="margin-left: 5mm"></span> <a href="#auto-183">13</a>, <a href="#auto-250">17</a>
          </p><div style="margin-left: 24px">
            <p>
              evaluation order <span style="margin-left: 5mm"></span> <a href="#auto-251">17</a>
            </p>
          </div><p>
            sequence operator <span style="margin-left: 5mm"></span> <a href="#auto-184">13</a>
          </p><p>
            setter <span style="margin-left: 5mm"></span> <a href="#auto-392">25</a>
          </p><p>
            shadowed binding <span style="margin-left: 5mm"></span> <a href="#auto-284">19</a>
          </p><p>
            shadowing
          </p><div style="margin-left: 24px">
            <p>
              in modules <span style="margin-left: 5mm"></span> <a href="#auto-522">35</a>
            </p>
          </div><p>
            short module name <span style="margin-left: 5mm"></span> <a href="#auto-518">35</a>
          </p><p>
            signal-noise ratio <span style="margin-left: 5mm"></span> <a href="#auto-40">3</a>
          </p><p>
            single quote <span style="margin-left: 5mm"></span> <a href="#auto-82">6</a>
          </p><p>
            spaces (for indentation) <span style="margin-left: 5mm"></span> <a href="#auto-54">4</a>
          </p><p>
            special forms <span style="margin-left: 5mm"></span> <a href="#auto-315">21</a>
          </p><p>
            standard operators <span style="margin-left: 5mm"></span> <a href="#auto-145">9</a>
          </p><p>
            statement <span style="margin-left: 5mm"></span> <a href="#auto-137">9</a>, <a href="#auto-255">17</a>
          </p><p>
            statement precedence <span style="margin-left: 5mm"></span> <a href="#auto-140">9</a>, <a href="#auto-153">11</a>
          </p><p>
            structured node types <span style="margin-left: 5mm"></span> <a href="#auto-97">7</a>
          </p><p>
            subject and complement <span style="margin-left: 5mm"></span> <a href="#auto-139">9</a>
          </p><p>
            symbol <span style="margin-left: 5mm"></span> <a href="#auto-342">23</a>, <a href="#auto-469">30</a>
          </p><p>
            symbols <span style="margin-left: 5mm"></span> <a href="#auto-91">43</a>, <a href="#auto-89">6</a>
          </p><p>
            syntactic noise <span style="margin-left: 5mm"></span> <a href="#auto-37">3</a>
          </p><p>
            syntax
          </p><div style="margin-left: 24px">
            <p>
              in modules <span style="margin-left: 5mm"></span> <a href="#auto-520">35</a>
            </p>
          </div><p>
            syntax configuration <span style="margin-left: 5mm"></span> <a href="#auto-50">4</a>, <a href="#auto-133">9</a>,
            <a href="#auto-142">9</a>
          </p><p>
            syntax statement <span style="margin-left: 5mm"></span> <a href="#auto-124">8</a>, <a href="#auto-148">11</a>,
            <a href="#auto-150">11</a>
          </p><p>
            tabs (for indentation) <span style="margin-left: 5mm"></span> <a href="#auto-55">4</a>
          </p><p>
            text <span style="margin-left: 5mm"></span> <a href="#auto-341">23</a>
          </p><p>
            text delimiters <span style="margin-left: 5mm"></span> <a href="#auto-80">6</a>, <a href="#auto-158">11</a>
          </p><p>
            text functions <span style="margin-left: 5mm"></span> <a href="#auto-451">29</a>
          </p><p>
            text literals <span style="margin-left: 5mm"></span> <a href="#auto-76">6</a>
          </p><p>
            text type <span style="margin-left: 5mm"></span> <a href="#auto-9">2</a>
          </p><p>
            tree <span style="margin-left: 5mm"></span> <a href="#auto-349">23</a>
          </p><div style="margin-left: 24px">
            <p>
              operations <span style="margin-left: 5mm"></span> <a href="#auto-463">30</a>
            </p>
          </div><p>
            tree rewrite <span style="margin-left: 5mm"></span> <a href="#auto-168">12</a>
          </p><p>
            tree rewrite operators <span style="margin-left: 5mm"></span> <a href="#auto-169">12</a>
          </p><p>
            type <span style="margin-left: 5mm"></span> <a href="#auto-332">23</a>
          </p><div style="margin-left: 24px">
            <p>
              belonging to a type <span style="margin-left: 5mm"></span> <a href="#auto-335">23</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              check <span style="margin-left: 5mm"></span> <a href="#auto-406">26</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              conversions <span style="margin-left: 5mm"></span> <a href="#auto-414">26</a>, <a href="#auto-455">29</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              declaration <span style="margin-left: 5mm"></span> <a href="#auto-334">23</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              definition <span style="margin-left: 5mm"></span> <a href="#auto-353">23</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              explicit type check <span style="margin-left: 5mm"></span> <a href="#auto-404">26</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              identifying arbitrary tree shapes <span style="margin-left: 5mm"></span> <a href="#auto-408">26</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              multiple notations <span style="margin-left: 5mm"></span> <a href="#auto-374">24</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              normal form <span style="margin-left: 5mm"></span> <a href="#auto-371">24</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              parameterized type <span style="margin-left: 5mm"></span> <a href="#auto-420">27</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              pattern <span style="margin-left: 5mm"></span> <a href="#auto-358">23</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              predefined <span style="margin-left: 5mm"></span> <a href="#auto-337">23</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              properties <span style="margin-left: 5mm"></span> <a href="#auto-378">25</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              rewrite type <span style="margin-left: 5mm"></span> <a href="#auto-425">27</a>
            </p>
          </div><p>
            type check <span style="margin-left: 5mm"></span> <a href="#auto-405">26</a>
          </p><p>
            type declaration <span style="margin-left: 5mm"></span> <a href="#auto-214">15</a>, <a href="#auto-333">23</a>
          </p><div style="margin-left: 24px">
            <p>
              in assignment <span style="margin-left: 5mm"></span> <a href="#auto-218">15</a>, <a href="#auto-229">15</a>
            </p>
          </div><div style="margin-left: 24px">
            <p>
              vs. type definition <span style="margin-left: 5mm"></span> <a href="#auto-361">24</a>
            </p>
          </div><p>
            type declarations <span style="margin-left: 5mm"></span> <a href="#auto-176">12</a>
          </p><p>
            type definition <span style="margin-left: 5mm"></span> <a href="#auto-352">23</a>
          </p><div style="margin-left: 24px">
            <p>
              vs. type declaration <span style="margin-left: 5mm"></span> <a href="#auto-362">24</a>
            </p>
          </div><p>
            type pattern <span style="margin-left: 5mm"></span> <a href="#auto-357">23</a>
          </p><p>
            undefined form <span style="margin-left: 5mm"></span> <a href="#auto-292">19</a>
          </p><p>
            underscore
          </p><div style="margin-left: 24px">
            <p>
              as digit separator <span style="margin-left: 5mm"></span> <a href="#auto-67">5</a>, <a href="#auto-72">5</a>
            </p>
          </div><p>
            UTF-8 <span style="margin-left: 5mm"></span> <a href="#auto-77">6</a>
          </p><p>
            value (of text literals) <span style="margin-left: 5mm"></span> <a href="#auto-88">6</a>
          </p><p>
            variable <span style="margin-left: 5mm"></span> <a href="#auto-196">13</a>
          </p><p>
            when infix operator <span style="margin-left: 5mm"></span> <a href="#auto-247">16</a>
          </p><p>
            XL0 (abstract syntax tree for XLR) <span style="margin-left: 5mm"></span> <a href="#auto-48">4</a>
          </p><p>
            XLR (eXtensible Language and Runtime <span style="margin-left: 5mm"></span> <a href="#auto-5">1</a>
          </p><p>
            xl.syntax <span style="margin-left: 5mm"></span> <a href="#auto-49">4</a>, <a href="#auto-109">7</a>, <a
            href="#auto-123">8</a>, <a href="#auto-143">9</a>, <a href="#auto-431">27</a>
          </p><div style="margin-left: 24px">
            <p>
              connexion to C.syntax <span style="margin-left: 5mm"></span> <a href="#auto-272">18</a>
            </p>
          </div></multicol></font>
        </div>
      </div>
    </p>
    <h2 id="auto-92">List of figures</h2>
    <div style="text-indent: 0em">
      <div class="compact-block">
        <font size="-1"><p>
          <p>
            Declaration of the factorial function <span style="margin-left: 5mm"></span> <a
            href="#auto-22">2</a>
          </p>
          <p>
            Map, reduce and filter <span style="margin-left: 5mm"></span> <a href="#auto-27">2</a>
          </p>
          <p>
            Declaration of if-then-else <span style="margin-left: 5mm"></span> <a href="#auto-29">2</a>
          </p>
          <p>
            Off-side rule: Using indentation to mark program structure. <span
            style="margin-left: 5mm"></span> <a href="#auto-57">4</a>
          </p>
          <p>
            Single-line and multi-line comments <span style="margin-left: 5mm"></span> <a href="#auto-60">5</a>
          </p>
          <p>
            Valid integer constants <span style="margin-left: 5mm"></span> <a href="#auto-68">5</a>
          </p>
          <p>
            Valid real constants <span style="margin-left: 5mm"></span> <a href="#auto-74">6</a>
          </p>
          <p>
            Valid text constants <span style="margin-left: 5mm"></span> <a href="#auto-85">6</a>
          </p>
          <p>
            Long text and indentation <span style="margin-left: 5mm"></span> <a href="#auto-87">6</a>
          </p>
          <p>
            Examples of valid operator and name symbols <span style="margin-left: 5mm"></span>
            <a href="#auto-95">7</a>
          </p>
          <p>
            Default syntax configuration file <span style="margin-left: 5mm"></span> <a href="#auto-147">10</a>
          </p>
          <p>
            Use of the <tt>syntax</tt> specification in a source file <span
            style="margin-left: 5mm"></span> <a href="#auto-149">11</a>
          </p>
          <p>
            C syntax configuration file <span style="margin-left: 5mm"></span> <a href="#auto-162">12</a>
          </p>
          <p>
            Example of rewrite declaration <span style="margin-left: 5mm"></span> <a href="#auto-173">12</a>
          </p>
          <p>
            Example of data declaration <span style="margin-left: 5mm"></span> <a href="#auto-175">12</a>
          </p>
          <p>
            Example of data declarations containing type declarations <span
            style="margin-left: 5mm"></span> <a href="#auto-177">13</a>
          </p>
          <p>
            Example of guard to build the Syracuse suite <span style="margin-left: 5mm"></span>
            <a href="#auto-179">13</a>
          </p>
          <p>
            Example of assignment <span style="margin-left: 5mm"></span> <a href="#auto-182">13</a>
          </p>
          <p>
            Example of sequence <span style="margin-left: 5mm"></span> <a href="#auto-186">13</a>
          </p>
          <p>
            Examples of index operators <span style="margin-left: 5mm"></span> <a href="#auto-188">13</a>
          </p>
          <p>
            Examples of tree rewrites <span style="margin-left: 5mm"></span> <a href="#auto-193">13</a>
          </p>
          <p>
            Constants vs. Variable symbols <span style="margin-left: 5mm"></span> <a href="#auto-197">14</a>
          </p>
          <p>
            Declarations are visible to the entire sequence containing them
            <span style="margin-left: 5mm"></span> <a href="#auto-204">14</a>
          </p>
          <p>
            Declaring a comma-separated list <span style="margin-left: 5mm"></span> <a href="#auto-208">14</a>
          </p>
          <p>
            Declaring a <tt>complex</tt> data type <span style="margin-left: 5mm"></span> <a
            href="#auto-210">14</a>
          </p>
          <p>
            Simple type declarations <span style="margin-left: 5mm"></span> <a href="#auto-216">15</a>
          </p>
          <p>
            Creating a new binding<a id="creating-a-new-binding"></a> <span style="margin-left: 5mm"></span> <a href="#auto-225">15</a>
          </p>
          <p>
            Assignment to existing binding<a id="nonlocal-assignment"></a> <span style="margin-left: 5mm"></span> <a
            href="#auto-226">15</a>
          </p>
          <p>
            Assigning to new local variable <a id="assign-to-new-local"></a> <span style="margin-left: 5mm"></span>
            <a href="#auto-235">15</a>
          </p>
          <p>
            Assignment to references <span style="margin-left: 5mm"></span> <a href="#auto-237">16</a>
          </p>
          <p>
            Assigning to parameter <span style="margin-left: 5mm"></span> <a href="#auto-241">16</a>
          </p>
          <p>
            Guard limit the validity of operations <span style="margin-left: 5mm"></span> <a
            href="#auto-248">16</a>
          </p>
          <p>
            Code writing <tt>A</tt>, then <tt>B</tt>, then
            <tt>f(100)+f(200)</tt> <span style="margin-left: 5mm"></span> <a href="#auto-253">17</a>
          </p>
          <p>
            Structured data <span style="margin-left: 5mm"></span> <a href="#auto-264">17</a>
          </p>
          <p>
            Creating an interface for a C function <span style="margin-left: 5mm"></span> <a
            href="#auto-270">18</a>
          </p>
          <p>
            Generating machine code using opcode declarations <span style="margin-left: 5mm"></span>
            <a href="#auto-278">18</a>
          </p>
          <p>
            Evaluation for comparison <span style="margin-left: 5mm"></span> <a href="#auto-321">21</a>
          </p>
          <p>
            Evaluation for type comparison <span style="margin-left: 5mm"></span> <a href="#auto-322">22</a>
          </p>
          <p>
            Explicit vs. lazy evaluation <span style="margin-left: 5mm"></span> <a href="#auto-328">22</a>
          </p>
          <p>
            Simple type declaration <span style="margin-left: 5mm"></span> <a href="#auto-356">23</a>
          </p>
          <p>
            Simple type declaration <span style="margin-left: 5mm"></span> <a href="#auto-360">24</a>
          </p>
          <p>
            Using the <tt>complex</tt> type <span style="margin-left: 5mm"></span> <a href="#auto-363">24</a>
          </p>
          <p>
            Binding for a <tt>complex</tt> parameter <span style="margin-left: 5mm"></span> <a
            href="#auto-367">24</a>
          </p>
          <p>
            Making type <tt>A</tt> equivalent to type <tt>B</tt> <span style="margin-left: 5mm"></span>
            <a href="#auto-368">24</a>
          </p>
          <p>
            Named patterns for <tt>complex</tt> <span style="margin-left: 5mm"></span> <a href="#auto-373">24</a>
          </p>
          <p>
            Creating a normal form for the complex type <span style="margin-left: 5mm"></span>
            <a href="#auto-375">24</a>
          </p>
          <p>
            Properties declaration <span style="margin-left: 5mm"></span> <a href="#auto-381">25</a>
          </p>
          <p>
            Color properties <span style="margin-left: 5mm"></span> <a href="#auto-390">25</a>
          </p>
          <p>
            Setting default arguments from the current context <span style="margin-left: 5mm"></span>
            <a href="#auto-393">25</a>
          </p>
          <p>
            Additional code in properties <span style="margin-left: 5mm"></span> <a href="#auto-396">25</a>
          </p>
          <p>
            Data inheritance <span style="margin-left: 5mm"></span> <a href="#auto-400">26</a>
          </p>
          <p>
            Defining a type identifying an arbitrary AST shape <span style="margin-left: 5mm"></span>
            <a href="#auto-409">26</a>
          </p>
          <p>
            Explicit type check <span style="margin-left: 5mm"></span> <a href="#auto-411">26</a>
          </p>
          <p>
            Explicit type conversion <span style="margin-left: 5mm"></span> <a href="#auto-415">26</a>
          </p>
          <p>
            Automatic type conversion <span style="margin-left: 5mm"></span> <a href="#auto-417">26</a>
          </p>
          <p>
            Parameterized type <span style="margin-left: 5mm"></span> <a href="#auto-421">27</a>
          </p>
          <p>
            Declaring a range type using an infix form <span style="margin-left: 5mm"></span> <a
            href="#auto-422">27</a>
          </p>
          <p>
            Declaration of a rewrite type <span style="margin-left: 5mm"></span> <a href="#auto-426">27</a>
          </p>
          <p>
            Library definition of if-then-else <span style="margin-left: 5mm"></span> <a href="#auto-485">31</a>
          </p>
          <p>
            The <tt>good</tt> function <span style="margin-left: 5mm"></span> <a href="#auto-487">31</a>
          </p>
          <p>
            Infinite loop <span style="margin-left: 5mm"></span> <a href="#auto-489">31</a>
          </p>
          <p>
            While loop <span style="margin-left: 5mm"></span> <a href="#auto-491">32</a>
          </p>
          <p>
            Until loop <span style="margin-left: 5mm"></span> <a href="#auto-492">32</a>
          </p>
          <p>
            For loop on an integer range <span style="margin-left: 5mm"></span> <a href="#auto-494">32</a>
          </p>
          <p>
            For loop on a container <span style="margin-left: 5mm"></span> <a href="#auto-495">32</a>
          </p>
          <p>
            Other kinds of <tt>for</tt> loop <span style="margin-left: 5mm"></span> <a href="#auto-496">32</a>
          </p>
          <p>
            <p>
              Range and range type definition
            </p>
            
            <span style="margin-left: 5mm"></span>
            
            <a href="#auto-501">33</a>
          </p>
          <p>
            Ranges as lists <span style="margin-left: 5mm"></span> <a href="#auto-503">33</a>
          </p>
          <p>
            Union type definition <span style="margin-left: 5mm"></span> <a href="#auto-505">33</a>
          </p>
          <p>
            Using union types <span style="margin-left: 5mm"></span> <a href="#auto-506">33</a>
          </p>
          <p>
            Enumeration type definition <span style="margin-left: 5mm"></span> <a href="#auto-508">34</a>
          </p>
          <p>
            Type matching a type declaration <span style="margin-left: 5mm"></span> <a href="#auto-510">34</a>
          </p>
          <p>
            Import statements examples <span style="margin-left: 5mm"></span> <a href="#auto-516">34</a>
          </p>
          <p>
            Module definition <span style="margin-left: 5mm"></span> <a href="#auto-527">35</a>
          </p>
          <p>
            Lazy evaluation of an infinite list <span style="margin-left: 5mm"></span> <a href="#auto-550">36</a>
          </p>
          <p>
            Controlled compilation <span style="margin-left: 5mm"></span> <a href="#auto-556">37</a>
          </p>
          <p>
            Signature for rewrite code with two variables. <span style="margin-left: 5mm"></span>
            <a href="#auto-565">38</a>
          </p>
          <p>
            Signature for rewrite code with two variables. <span style="margin-left: 5mm"></span>
            <a href="#auto-568">39</a>
          </p>
        </p></font>
      </div>
    </div>
    <h2 id="auto-93">List of tables</h2>
    <div style="text-indent: 0em">
      <div class="compact-block">
        <font size="-1"><p>
          <p>
            Type correspondances in a C interface <span style="margin-left: 5mm"></span> <a
            href="#auto-274">18</a>
          </p>
          <p>
            Arithmetic operations <span style="margin-left: 5mm"></span> <a href="#auto-436">28</a>
          </p>
          <p>
            Comparisons <span style="margin-left: 5mm"></span> <a href="#auto-439">28</a>
          </p>
          <p>
            Bitwise arithmetic operations <span style="margin-left: 5mm"></span> <a href="#auto-443">28</a>
          </p>
          <p>
            Boolean operations <span style="margin-left: 5mm"></span> <a href="#auto-446">28</a>
          </p>
          <p>
            Mathematical operations <span style="margin-left: 5mm"></span> <a href="#auto-449">29</a>
          </p>
          <p>
            Text operations <span style="margin-left: 5mm"></span> <a href="#auto-452">29</a>
          </p>
          <p>
            Conversions <span style="margin-left: 5mm"></span> <a href="#auto-456">29</a>
          </p>
          <p>
            Date and time <span style="margin-left: 5mm"></span> <a href="#auto-461">30</a>
          </p>
          <p>
            Tree operations <span style="margin-left: 5mm"></span> <a href="#auto-465">30</a>
          </p>
          <p>
            List operations <span style="margin-left: 5mm"></span> <a href="#auto-476">30</a>
          </p>
          <p>
            LLVM operations <span style="margin-left: 5mm"></span> <a href="#auto-557">37</a>
          </p>
        </p></font>
      </div>
    </div>
  </body>
</html>
